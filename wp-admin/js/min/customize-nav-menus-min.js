!function(e,t,$){"use strict";function n(e){return"nav_menu_item["+e+"]"}function i(t){return t=t||"",t=$("<div>").text(t).html(),(t=$.trim(t))||e.Menus.data.l10n.unnamed}wpNavMenu.originalInit=wpNavMenu.init,wpNavMenu.options.menuItemDepthPerLevel=20,wpNavMenu.options.sortableItems="> .customize-control-nav_menu_item",wpNavMenu.options.targetTolerance=10,wpNavMenu.init=function(){this.jQueryExtensions()},e.Menus=e.Menus||{},e.Menus.data={itemTypes:[],l10n:{},settingTransport:"refresh",phpIntMax:0,defaultSettingValues:{nav_menu:{},nav_menu_item:{}},locationSlugMappedToName:{}},"undefined"!=typeof _wpCustomizeNavMenusSettings&&$.extend(e.Menus.data,_wpCustomizeNavMenusSettings),e.Menus.generatePlaceholderAutoIncrementId=function(){return-Math.ceil(e.Menus.data.phpIntMax*Math.random())},e.Menus.AvailableItemModel=Backbone.Model.extend($.extend({id:null},e.Menus.data.defaultSettingValues.nav_menu_item)),e.Menus.AvailableItemCollection=Backbone.Collection.extend({model:e.Menus.AvailableItemModel,sort_key:"order",comparator:function(e){return-e.get(this.sort_key)},sortByField:function(e){this.sort_key=e,this.sort()}}),e.Menus.availableMenuItems=new e.Menus.AvailableItemCollection(e.Menus.data.availableMenuItems),e.Menus.insertAutoDraftPost=function n(i){var a,o=$.Deferred();return a=t.ajax.post("customize-nav-menus-insert-auto-draft",{"customize-menus-nonce":e.settings.nonce["customize-menus"],wp_customize:"on",customize_changeset_uuid:e.settings.changeset.uuid,params:i}),a.done(function(t){t.post_id&&(e("nav_menus_created_posts").set(e("nav_menus_created_posts").get().concat([t.post_id])),"page"===i.post_type&&(e.section.has("static_front_page")&&e.section("static_front_page").activate(),e.control.each(function(e){var n;"dropdown-pages"===e.params.type&&(n=e.container.find('select[name^="_customize-dropdown-pages-"]'),n.append(new Option(i.post_title,t.post_id)))})),o.resolve(t))}),a.fail(function(e){var t=e||"";void 0!==e.message&&(t=e.message),console.error(t),o.rejectWith(t)}),o.promise()},e.Menus.AvailableMenuItemsPanelView=t.Backbone.View.extend({el:"#available-menu-items",events:{"input #menu-items-search":"debounceSearch","keyup #menu-items-search":"debounceSearch","focus .menu-item-tpl":"focus","click .menu-item-tpl":"_submit","click #custom-menu-item-submit":"_submitLink","keypress #custom-menu-item-name":"_submitLink","click .new-content-item .add-content":"_submitNew","keypress .create-item-input":"_submitNew",keydown:"keyboardAccessible"},selected:null,currentMenuControl:null,debounceSearch:null,$search:null,$clearResults:null,searchTerm:"",rendered:!1,pages:{},sectionContent:"",loading:!1,addingNew:!1,initialize:function(){var t=this;e.panel.has("nav_menus")&&(this.$search=$("#menu-items-search"),this.$clearResults=this.$el.find(".clear-results"),this.sectionContent=this.$el.find(".available-menu-items-list"),this.debounceSearch=_.debounce(t.search,500),_.bindAll(this,"close"),$("#customize-controls, .customize-section-back").on("click keydown",function(e){var n=$(e.target).is(".item-delete, .item-delete *"),i=$(e.target).is(".add-new-menu-item, .add-new-menu-item *");!$("body").hasClass("adding-menu-items")||n||i||t.close()}),this.$clearResults.on("click",function(){t.$search.val("").focus().trigger("keyup")}),this.$el.on("input","#custom-menu-item-name.invalid, #custom-menu-item-url.invalid",function(){$(this).removeClass("invalid")}),e.panel("nav_menus").container.bind("expanded",function(){t.rendered||(t.initList(),t.rendered=!0)}),this.sectionContent.scroll(function(){var e=t.$el.find(".accordion-section.open .available-menu-items-list").prop("scrollHeight"),n=t.$el.find(".accordion-section.open").height();if(!t.loading&&$(this).scrollTop()>.75*e-n){var i=$(this).data("type"),a=$(this).data("object");"search"===i?t.searchTerm&&t.doSearch(t.pages.search):t.loadItems([{type:i,object:a}])}}),e.previewer.bind("url",this.close),t.delegateEvents())},search:function(e){var t=$("#available-menu-items-search"),n=$("#available-menu-items .accordion-section").not(t);e&&this.searchTerm!==e.target.value&&(""===e.target.value||t.hasClass("open")?""===e.target.value&&(t.removeClass("open"),n.show(),this.$clearResults.removeClass("is-visible")):(n.fadeOut(100),t.find(".accordion-section-content").slideDown("fast"),t.addClass("open"),this.$clearResults.addClass("is-visible")),this.searchTerm=e.target.value,this.pages.search=1,this.doSearch(1))},doSearch:function(n){var i=this,a,o=$("#available-menu-items-search"),s=o.find(".accordion-section-content"),r=t.template("available-menu-item");if(i.currentRequest&&i.currentRequest.abort(),!(n<0)){if(n>1)o.addClass("loading-more"),s.attr("aria-busy","true"),t.a11y.speak(e.Menus.data.l10n.itemsLoadingMore);else if(""===i.searchTerm)return s.html(""),void t.a11y.speak("");o.addClass("loading"),i.loading=!0,a=e.previewer.query({excludeCustomizedSaved:!0}),_.extend(a,{"customize-menus-nonce":e.settings.nonce["customize-menus"],wp_customize:"on",search:i.searchTerm,page:n}),i.currentRequest=t.ajax.post("search-available-menu-items-customizer",a),i.currentRequest.done(function(a){var u;1===n&&s.empty(),o.removeClass("loading loading-more"),s.attr("aria-busy","false"),o.addClass("open"),i.loading=!1,u=new e.Menus.AvailableItemCollection(a.items),i.collection.add(u.models),u.each(function(e){s.append(r(e.attributes))}),20>u.length?i.pages.search=-1:i.pages.search=i.pages.search+1,u&&n>1?t.a11y.speak(e.Menus.data.l10n.itemsFoundMore.replace("%d",u.length)):u&&1===n&&t.a11y.speak(e.Menus.data.l10n.itemsFound.replace("%d",u.length))}),i.currentRequest.fail(function(e){e.message&&(s.empty().append($('<li class="nothing-found"></li>').text(e.message)),t.a11y.speak(e.message)),i.pages.search=-1}),i.currentRequest.always(function(){o.removeClass("loading loading-more"),s.attr("aria-busy","false"),i.loading=!1,i.currentRequest=null})}},initList:function(){var t=this;_.each(e.Menus.data.itemTypes,function(e){t.pages[e.type+":"+e.object]=0}),t.loadItems(e.Menus.data.itemTypes)},loadItems:function(n,i){var a=this,o,s=[],r,u,d,c={};d=t.template("available-menu-item"),o=_.isString(n)&&_.isString(i)?[{type:n,object:i}]:n,_.each(o,function(e){var t,n=e.type+":"+e.object;-1!==a.pages[n]&&(t=$("#available-menu-items-"+e.type+"-"+e.object),t.find(".accordion-section-title").addClass("loading"),c[n]=t,s.push({object:e.object,type:e.type,page:a.pages[n]}))}),0!==s.length&&(a.loading=!0,r=e.previewer.query({excludeCustomizedSaved:!0}),_.extend(r,{"customize-menus-nonce":e.settings.nonce["customize-menus"],wp_customize:"on",item_types:s}),u=t.ajax.post("load-available-menu-items-customizer",r),u.done(function(t){var n;_.each(t.items,function(t,i){if(0===t.length)return 0===a.pages[i]&&c[i].find(".accordion-section-title").addClass("cannot-expand").removeClass("loading").find(".accordion-section-title > button").prop("tabIndex",-1),void(a.pages[i]=-1);"post_type:page"!==i||c[i].hasClass("open")||c[i].find(".accordion-section-title > button").click(),t=new e.Menus.AvailableItemCollection(t),a.collection.add(t.models),n=c[i].find(".available-menu-items-list"),t.each(function(e){n.append(d(e.attributes))}),a.pages[i]+=1})}),u.fail(function(e){"undefined"!=typeof console&&console.error&&console.error(e)}),u.always(function(){_.each(c,function(e){e.find(".accordion-section-title").removeClass("loading")}),a.loading=!1}))},itemSectionHeight:function(){var e,t,n,i,a;n=window.innerHeight,e=this.$el.find(".accordion-section:not( #available-menu-items-search ) .accordion-section-content"),t=this.$el.find('.accordion-section:not( #available-menu-items-search ) .available-menu-items-list:not(":only-child")'),i=46*(1+e.length)+14,120<(a=n-i)&&290>a&&(e.css("max-height",a),t.css("max-height",a-60))},select:function(e){this.selected=$(e),this.selected.siblings(".menu-item-tpl").removeClass("selected"),this.selected.addClass("selected")},focus:function(e){this.select($(e.currentTarget))},_submit:function(e){"keypress"===e.type&&13!==e.which&&32!==e.which||this.submit($(e.currentTarget))},submit:function(e){var t,n;e||(e=this.selected),e&&this.currentMenuControl&&(this.select(e),t=$(this.selected).data("menu-item-id"),(n=this.collection.findWhere({id:t}))&&(this.currentMenuControl.addItemToMenu(n.attributes),$(e).find(".menu-item-handle").addClass("item-added")))},_submitLink:function(e){"keypress"===e.type&&13!==e.which||this.submitLink()},submitLink:function(){var t,n=$("#custom-menu-item-name"),i=$("#custom-menu-item-url"),a;if(this.currentMenuControl){if(a=/^((\w+:)?\/\/\w.*|\w+:(?!\/\/$)|\/|\?|#)/,""===n.val())return void n.addClass("invalid");if(!a.test(i.val()))return void i.addClass("invalid");t={title:n.val(),url:i.val(),type:"custom",type_label:e.Menus.data.l10n.custom_label,object:"custom"},this.currentMenuControl.addItemToMenu(t),i.val("http://"),n.val("")}},_submitNew:function(e){var t;"keypress"===e.type&&13!==e.which||this.addingNew||(t=$(e.target).closest(".accordion-section"),this.submitNew(t))},submitNew:function(n){var i=this,a=n.find(".create-item-input"),o=a.val(),s=n.find(".available-menu-items-list"),r=s.data("type"),u=s.data("object"),d=s.data("type_label"),c;if(this.currentMenuControl&&"post_type"===r){if(""===$.trim(a.val()))return a.addClass("invalid"),void a.focus();a.removeClass("invalid"),n.find(".accordion-section-title").addClass("loading"),i.addingNew=!0,a.attr("disabled","disabled"),c=e.Menus.insertAutoDraftPost({post_title:o,post_type:u}),c.done(function(o){var s,c,l;s=new e.Menus.AvailableItemModel({id:"post-"+o.post_id,title:a.val(),type:r,type_label:d,object:u,object_id:o.post_id,url:o.url}),i.currentMenuControl.addItemToMenu(s.attributes),e.Menus.availableMenuItemsPanel.collection.add(s),c=n.find(".available-menu-items-list"),l=$(t.template("available-menu-item")(s.attributes)),l.find(".menu-item-handle:first").addClass("item-added"),c.prepend(l),c.scrollTop(),a.val("").removeAttr("disabled"),i.addingNew=!1,n.find(".accordion-section-title").removeClass("loading")})}},open:function(t){var n=this,i;this.currentMenuControl=t,this.itemSectionHeight(),e.section.has("publish_settings")&&e.section("publish_settings").collapse(),$("body").addClass("adding-menu-items"),i=function(){n.close(),$(this).off("click",i)},$("#customize-preview").on("click",i),_(this.currentMenuControl.getMenuItemControls()).each(function(e){e.collapseForm()}),this.$el.find(".selected").removeClass("selected"),this.$search.focus()},close:function(e){e=e||{},e.returnFocus&&this.currentMenuControl&&this.currentMenuControl.container.find(".add-new-menu-item").focus(),this.currentMenuControl=null,this.selected=null,$("body").removeClass("adding-menu-items"),$("#available-menu-items .menu-item-handle.item-added").removeClass("item-added"),this.$search.val("").trigger("keyup")},keyboardAccessible:function(e){var t=13===e.which,n=27===e.which,i=9===e.which&&e.shiftKey,a=$(e.target).is(this.$search);t&&!this.$search.val()||(a&&i?(this.currentMenuControl.container.find(".add-new-menu-item").focus(),e.preventDefault()):n&&this.close({returnFocus:!0}))}}),e.Menus.MenusPanel=e.Panel.extend({attachEvents:function(){e.Panel.prototype.attachEvents.call(this);var t=this,n=t.container.find(".panel-meta"),i=n.find(".customize-help-toggle"),a=n.find(".customize-panel-description"),o=$("#screen-options-wrap"),s=n.find(".customize-screen-options-toggle");s.on("click keydown",function(t){if(!e.utils.isKeydownButNotEnterEvent(t))return t.preventDefault(),a.not(":hidden")&&(a.slideUp("fast"),i.attr("aria-expanded","false")),"true"===s.attr("aria-expanded")?(s.attr("aria-expanded","false"),n.removeClass("open"),n.removeClass("active-menu-screen-options"),o.slideUp("fast")):(s.attr("aria-expanded","true"),n.addClass("open"),n.addClass("active-menu-screen-options"),o.slideDown("fast")),!1}),i.on("click keydown",function(t){e.utils.isKeydownButNotEnterEvent(t)||(t.preventDefault(),"true"===s.attr("aria-expanded")&&(s.attr("aria-expanded","false"),i.attr("aria-expanded","true"),n.addClass("open"),n.removeClass("active-menu-screen-options"),o.slideUp("fast"),a.slideDown("fast")))})},ready:function(){var n=this;n.container.find(".hide-column-tog").click(function(){n.saveManageColumnsState()}),e.section("menu_locations",function(n){n.headContainer.prepend(t.template("nav-menu-locations-header")(e.Menus.data))})},saveManageColumnsState:_.debounce(function(){var e=this;e._updateHiddenColumnsRequest&&e._updateHiddenColumnsRequest.abort(),e._updateHiddenColumnsRequest=t.ajax.post("hidden-columns",{hidden:e.hidden(),screenoptionnonce:$("#screenoptionnonce").val(),page:"nav-menus"}),e._updateHiddenColumnsRequest.always(function(){e._updateHiddenColumnsRequest=null})},2e3),checked:function(){},unchecked:function(){},hidden:function(){return $(".hide-column-tog").not(":checked").map(function(){var e=this.id;return e.substring(0,e.length-5)}).get().join(",")}}),e.Menus.MenuSection=e.Section.extend({initialize:function(t,n){var i=this;e.Section.prototype.initialize.call(i,t,n),i.deferred.initSortables=$.Deferred()},ready:function(){var t=this,n,i;if(void 0===t.params.menu_id)throw new Error("params.menu_id was not defined");t.active.validate=function(){return!!e.has(t.id)&&!!e(t.id).get()},t.populateControls(),t.navMenuLocationSettings={},t.assignedLocations=new e.Value([]),e.each(function(e,n){var i=n.match(/^nav_menu_locations\[(.+?)]/);i&&(t.navMenuLocationSettings[i[1]]=e,e.bind(function(){t.refreshAssignedLocations()}))}),t.assignedLocations.bind(function(e){t.updateAssignedLocationsInSectionTitle(e)}),t.refreshAssignedLocations(),e.bind("pane-contents-reflowed",function(){t.contentContainer.parent().length&&(t.container.find(".menu-item .menu-item-reorder-nav button").attr({tabindex:"0","aria-hidden":"false"}),t.container.find(".menu-item.move-up-disabled .menus-move-up").attr({tabindex:"-1","aria-hidden":"true"}),t.container.find(".menu-item.move-down-disabled .menus-move-down").attr({tabindex:"-1","aria-hidden":"true"}),t.container.find(".menu-item.move-left-disabled .menus-move-left").attr({tabindex:"-1","aria-hidden":"true"}),t.container.find(".menu-item.move-right-disabled .menus-move-right").attr({tabindex:"-1","aria-hidden":"true"}))}),i=function(){var e="field-"+$(this).val()+"-active";t.contentContainer.toggleClass(e,$(this).prop("checked"))},n=e.panel("nav_menus").contentContainer.find(".metabox-prefs:first").find(".hide-column-tog"),n.each(i),n.on("click",i)},populateControls:function(){var t=this,n,i,a,o,s,r,u,d,c;n=t.id+"[name]",r=e.control(n),r||(r=new e.controlConstructor.nav_menu_name(n,{type:"nav_menu_name",label:e.Menus.data.l10n.menuNameLabel,section:t.id,priority:0,settings:{default:t.id}}),e.control.add(r),r.active.set(!0)),s=e.control(t.id),s||(s=new e.controlConstructor.nav_menu(t.id,{type:"nav_menu",section:t.id,priority:998,settings:{default:t.id},menu_id:t.params.menu_id}),e.control.add(s),s.active.set(!0)),i=t.id+"[locations]",u=e.control(i),u||(u=new e.controlConstructor.nav_menu_locations(i,{section:t.id,priority:999,settings:{default:t.id},menu_id:t.params.menu_id}),e.control.add(u.id,u),s.active.set(!0)),a=t.id+"[auto_add]",d=e.control(a),d||(d=new e.controlConstructor.nav_menu_auto_add(a,{type:"nav_menu_auto_add",label:"",section:t.id,priority:1e3,settings:{default:t.id}}),e.control.add(d),d.active.set(!0)),o=t.id+"[delete]",(c=e.control(o))||(c=new e.Control(o,{section:t.id,priority:1001,templateId:"nav-menu-delete-button"}),e.control.add(c.id,c),c.active.set(!0),c.deferred.embedded.done(function(){c.container.find("button").on("click",function(){var n=t.params.menu_id;e.Menus.getMenuControl(n).setting.set(!1)})}))},refreshAssignedLocations:function(){var e=this,t=e.params.menu_id,n=[];_.each(e.navMenuLocationSettings,function(e,i){e()===t&&n.push(i)}),e.assignedLocations.set(n)},updateAssignedLocationsInSectionTitle:function(t){var n=this,i;i=n.container.find(".accordion-section-title:first"),i.find(".menu-in-location").remove(),_.each(t,function(t){var n,a;n=$('<span class="menu-in-location"></span>'),a=e.Menus.data.locationSlugMappedToName[t],n.text(e.Menus.data.l10n.menuLocation.replace("%s",a)),i.append(n)}),n.container.toggleClass("assigned-to-menu-location",0!==t.length)},onChangeExpanded:function(t,n){var i=this,a;t&&(wpNavMenu.menuList=i.contentContainer,wpNavMenu.targetList=wpNavMenu.menuList,$("#menu-to-edit").removeAttr("id"),wpNavMenu.menuList.attr("id","menu-to-edit").addClass("menu"),_.each(e.section(i.id).controls(),function(e){"nav_menu_item"===e.params.type&&e.actuallyEmbed()}),n.completeCallback&&(a=n.completeCallback),n.completeCallback=function(){"resolved"!==i.deferred.initSortables.state()&&(wpNavMenu.initSortables(),i.deferred.initSortables.resolve(wpNavMenu.menuList),e.control("nav_menu["+String(i.params.menu_id)+"]").reflowMenuItems()),_.isFunction(a)&&a()}),e.Section.prototype.onChangeExpanded.call(i,t,n)},highlightNewItemButton:function(){e.utils.highlightButton(this.contentContainer.find(".add-new-menu-item"),{delay:2e3})}}),e.Menus.createNavMenu=function t(n){var a,o,s;return o=e.Menus.generatePlaceholderAutoIncrementId(),a="nav_menu["+String(o)+"]",s=e.create(a,a,{},{type:"nav_menu",transport:e.Menus.data.settingTransport,previewer:e.previewer}),s.set($.extend({},e.Menus.data.defaultSettingValues.nav_menu,{name:n||""})),e.section.add(new e.Menus.MenuSection(a,{panel:"nav_menus",title:i(n),customizeAction:e.Menus.data.l10n.customizingMenus,priority:10,menu_id:o}))},e.Menus.NewMenuSection=e.Section.extend({attachEvents:function(){function n(){var t=0;return e.each(function(e){d.test(e.id)&&!1!==e.get()&&(t+=1)}),t}function i(){r.find(".add-new-menu-notice").prop("hidden",n()>0)}function a(e){d.test(e.id)&&(e.bind(i),i())}function o(e){d.test(e.id)&&(e.unbind(i),i())}var s=this,r=s.container,u=s.contentContainer,d=/^nav_menu\[/;s.headContainer.find(".accordion-section-title").replaceWith(t.template("nav-menu-create-menu-section-title")),r.on("click",".customize-add-menu-button",function(){s.expand()}),u.on("keydown",".menu-name-field",function(e){13===e.which&&s.submit()}),u.on("click","#customize-new-menu-submit",function(e){s.submit(),e.stopPropagation(),e.preventDefault()}),e.each(a),e.bind("add",a),e.bind("removed",o),i(),e.Section.prototype.attachEvents.apply(s,arguments)},ready:function(){this.populateControls()},populateControls:function(){var t=this,n,i,a,o,s,r;n=t.id+"[name]",o=e.control(n),o||(o=new e.controlConstructor.nav_menu_name(n,{label:e.Menus.data.l10n.menuNameLabel,description:e.Menus.data.l10n.newMenuNameDescription,section:t.id,priority:0}),e.control.add(o.id,o),o.active.set(!0)),i=t.id+"[locations]",s=e.control(i),s||(s=new e.controlConstructor.nav_menu_locations(i,{section:t.id,priority:1,menu_id:"",isCreating:!0}),e.control.add(i,s),s.active.set(!0)),a=t.id+"[submit]",(r=e.control(a))||(r=new e.Control(a,{section:t.id,priority:1,templateId:"nav-menu-submit-new-button"}),e.control.add(a,r),r.active.set(!0))},submit:function(){var n=this,i=n.contentContainer,a=i.find(".menu-name-field").first(),o=a.val(),s;if(!o)return a.addClass("invalid"),void a.focus();s=e.Menus.createNavMenu(o),a.val(""),a.removeClass("invalid"),i.find(".assigned-menu-location input[type=checkbox]").each(function(){var t=$(this),n;t.prop("checked")&&(n=e("nav_menu_locations["+t.data("location-id")+"]"),n.set(s.params.menu_id),t.prop("checked",!1))}),t.a11y.speak(e.Menus.data.l10n.menuAdded),s.focus({completeCallback:function(){s.highlightNewItemButton()}})},selectDefaultLocation:function(t){var n=e.control(this.id+"[locations]"),i={};null!==t&&(i[t]=!0),n.setSelections(i)}}),e.Menus.MenuLocationControl=e.Control.extend({initialize:function(t,n){var i=this,a=t.match(/^nav_menu_locations\[(.+?)]/);i.themeLocation=a[1],e.Control.prototype.initialize.call(i,t,n)},ready:function(){var t=this,n=/^nav_menu\[(-?\d+)]/;t.setting.validate=function(e){return""===e?0:parseInt(e,10)},t.container.find(".create-menu").on("click",function(){var t=e.section("add_menu");t.selectDefaultLocation(this.dataset.locationId),t.focus()}),t.container.find(".edit-menu").on("click",function(){var n=t.setting();e.section("nav_menu["+n+"]").focus()}),t.setting.bind("change",function(){var e=0!==t.setting();t.container.find(".create-menu").toggleClass("hidden",e),t.container.find(".edit-menu").toggleClass("hidden",!e)}),e.bind("add",function(e){var a,o,s=e.id.match(n);s&&!1!==e()&&(o=s[1],a=new Option(i(e().name),o),t.container.find("select").append(a))}),e.bind("remove",function(e){var i,a=e.id.match(n);a&&(i=parseInt(a[1],10),t.setting()===i&&t.setting.set(""),t.container.find("option[value="+i+"]").remove())}),e.bind("change",function(e){var a,o=e.id.match(n);o&&(a=parseInt(o[1],10),!1===e()?(t.setting()===a&&t.setting.set(""),t.container.find("option[value="+a+"]").remove()):t.container.find("option[value="+a+"]").text(i(e().name)))})}}),e.Menus.MenuItemControl=e.Control.extend({initialize:function(t,n){var i=this;i.expanded=new e.Value(!1),i.expandedArgumentsQueue=[],i.expanded.bind(function(e){var t=i.expandedArgumentsQueue.shift();t=$.extend({},i.defaultExpandedArguments,t),i.onChangeExpanded(e,t)}),e.Control.prototype.initialize.call(i,t,n),i.active.validate=function(){var t,n=e.section(i.section());return t=!!n&&n.active()}},embed:function(){var t=this,n=t.section(),i;n&&((i=e.section(n))&&i.expanded()||e.settings.autofocus.control===t.id)&&t.actuallyEmbed()},actuallyEmbed:function(){var e=this;"resolved"!==e.deferred.embedded.state()&&(e.renderContent(),e.deferred.embedded.resolve())},ready:function(){if(void 0===this.params.menu_item_id)throw new Error("params.menu_item_id was not defined");this._setupControlToggle(),this._setupReorderUI(),this._setupUpdateUI(),this._setupRemoveUI(),this._setupLinksUI(),this._setupTitleUI()},_setupControlToggle:function(){var t=this;this.container.find(".menu-item-handle").on("click",function(n){n.preventDefault(),n.stopPropagation();var i=t.getMenuControl(),a=$(n.target).is(".item-delete, .item-delete *"),o=$(n.target).is(".add-new-menu-item, .add-new-menu-item *");!$("body").hasClass("adding-menu-items")||a||o||e.Menus.availableMenuItemsPanel.close(),i.isReordering||i.isSorting||t.toggleForm()})},_setupReorderUI:function(){var e=this,n,i;n=t.template("menu-item-reorder-nav"),e.container.find(".item-controls").after(n),i=e.container.find(".menu-item-reorder-nav"),i.find(".menus-move-up, .menus-move-down, .menus-move-left, .menus-move-right").on("click",function(){var t=$(this);t.focus();var n=t.is(".menus-move-up"),i=t.is(".menus-move-down"),a=t.is(".menus-move-left"),o=t.is(".menus-move-right");n?e.moveUp():i?e.moveDown():a?e.moveLeft():o&&e.moveRight(),t.focus()})},_setupUpdateUI:function(){var t=this,n=t.setting(),i;t.elements={},t.elements.url=new e.Element(t.container.find(".edit-menu-item-url")),t.elements.title=new e.Element(t.container.find(".edit-menu-item-title")),t.elements.attr_title=new e.Element(t.container.find(".edit-menu-item-attr-title")),t.elements.target=new e.Element(t.container.find(".edit-menu-item-target")),t.elements.classes=new e.Element(t.container.find(".edit-menu-item-classes")),t.elements.xfn=new e.Element(t.container.find(".edit-menu-item-xfn")),t.elements.description=new e.Element(t.container.find(".edit-menu-item-description")),_.each(t.elements,function(e,i){e.bind(function(n){e.element.is("input[type=checkbox]")&&(n=n?e.element.val():"");var a=t.setting();a&&a[i]!==n&&(a=_.clone(a),a[i]=n,t.setting.set(a))}),n&&("classes"!==i&&"xfn"!==i||!_.isArray(n[i])?e.set(n[i]):e.set(n[i].join(" ")))}),t.setting.bind(function(n,i){var a=t.params.menu_item_id,o=[],s=[],r;!1===n?(r=e.control("nav_menu["+String(i.nav_menu_term_id)+"]"),t.container.remove(),_.each(r.getMenuItemControls(),function(e){i.menu_item_parent===e.setting().menu_item_parent&&e.setting().position>i.position?o.push(e):e.setting().menu_item_parent===a&&s.push(e)}),_.each(o,function(e){var t=_.clone(e.setting());t.position+=s.length,e.setting.set(t)}),_.each(s,function(e,t){var n=_.clone(e.setting());n.position=i.position+t,n.menu_item_parent=i.menu_item_parent,e.setting.set(n)}),r.debouncedReflowMenuItems()):(_.each(n,function(e,i){t.elements[i]&&t.elements[i].set(n[i])}),t.container.find(".menu-item-data-parent-id").val(n.menu_item_parent),n.position===i.position&&n.menu_item_parent===i.menu_item_parent||t.getMenuControl().debouncedReflowMenuItems())}),i=function(){t.elements.url.element.toggleClass("invalid",t.setting.notifications.has("invalid_url"))},t.setting.notifications.bind("add",i),t.setting.notifications.bind("removed",i)},_setupRemoveUI:function(){var n=this,i;i=n.container.find(".item-delete"),i.on("click",function(){var i=!0,a,o,s;$("body").hasClass("adding-menu-items")||(i=!1),o=n.container.nextAll(".customize-control-nav_menu_item:visible").first(),s=n.container.prevAll(".customize-control-nav_menu_item:visible").first(),a=o.length?o.find(!1===i?".item-edit":".item-delete").first():s.length?s.find(!1===i?".item-edit":".item-delete").first():n.container.nextAll(".customize-control-nav_menu").find(".add-new-menu-item").first(),n.container.slideUp(function(){n.setting.set(!1),t.a11y.speak(e.Menus.data.l10n.itemDeleted),a.focus()}),n.setting.set(!1)})},_setupLinksUI:function(){var t;t=this.container.find("a.original-link"),t.on("click",function(t){t.preventDefault(),e.previewer.previewUrl(t.target.toString())})},_setupTitleUI:function(){var t=this,n;t.container.find(".edit-menu-item-title").on("blur",function(){$(this).val($.trim($(this).val()))}),n=t.container.find(".menu-item-title"),t.setting.bind(function(t){var i,a;t&&(i=$.trim(t.title),a=i||t.original_title||e.Menus.data.l10n.untitled,t._invalid&&(a=e.Menus.data.l10n.invalidTitleTpl.replace("%s",a)),i||t.original_title?n.text(a).removeClass("no-title"):n.text(a).addClass("no-title"))})},getDepth:function(){var t=this,n=t.setting(),i=0;if(!n)return 0;for(;n&&n.menu_item_parent&&(i+=1,t=e.control("nav_menu_item["+n.menu_item_parent+"]"));)n=t.setting();return i},renderContent:function(){var t=this,n=t.setting(),i;t.params.title=n.title||"",t.params.depth=t.getDepth(),t.container.data("item-depth",t.params.depth),i=["menu-item","menu-item-depth-"+String(t.params.depth),"menu-item-"+n.object,"menu-item-edit-inactive"],n._invalid?(i.push("menu-item-invalid"),t.params.title=e.Menus.data.l10n.invalidTitleTpl.replace("%s",t.params.title)):"draft"===n.status&&(i.push("pending"),t.params.title=e.Menus.data.pendingTitleTpl.replace("%s",t.params.title)),t.params.el_classes=i.join(" "),t.params.item_type_label=n.type_label,t.params.item_type=n.type,t.params.url=n.url,t.params.target=n.target,t.params.attr_title=n.attr_title,t.params.classes=_.isArray(n.classes)?n.classes.join(" "):n.classes,t.params.attr_title=n.attr_title,t.params.xfn=n.xfn,t.params.description=n.description,t.params.parent=n.menu_item_parent,t.params.original_title=n.original_title||"",t.container.addClass(t.params.el_classes),e.Control.prototype.renderContent.call(t)},getMenuControl:function(){var t=this,n=t.setting();return n&&n.nav_menu_term_id?e.control("nav_menu["+n.nav_menu_term_id+"]"):null},expandControlSection:function(){var e=this.container.closest(".accordion-section");e.hasClass("open")||e.find(".accordion-section-title:first").trigger("click")},_toggleExpanded:e.Section.prototype._toggleExpanded,expand:e.Section.prototype.expand,expandForm:function(e){this.expand(e)},collapse:e.Section.prototype.collapse,collapseForm:function(e){this.collapse(e)},toggleForm:function(e,t){void 0===e&&(e=!this.expanded()),e?this.expand(t):this.collapse(t)},onChangeExpanded:function(t,n){var i=this,a,o,s;if(a=this.container,o=a.find(".menu-item-settings:first"),void 0===t&&(t=!o.is(":visible")),o.is(":visible")===t)return void(n&&n.completeCallback&&n.completeCallback());t?(e.control.each(function(e){i.params.type===e.params.type&&i!==e&&e.collapseForm()}),s=function(){a.removeClass("menu-item-edit-inactive").addClass("menu-item-edit-active"),i.container.trigger("expanded"),n&&n.completeCallback&&n.completeCallback()},a.find(".item-edit").attr("aria-expanded","true"),o.slideDown("fast",s),i.container.trigger("expand")):(s=function(){a.addClass("menu-item-edit-inactive").removeClass("menu-item-edit-active"),i.container.trigger("collapsed"),n&&n.completeCallback&&n.completeCallback()},i.container.trigger("collapse"),a.find(".item-edit").attr("aria-expanded","false"),o.slideUp("fast",s))},focus:function(t){t=t||{};var n=this,i=t.completeCallback,a;a=function(){n.expandControlSection(),t.completeCallback=function(){var e;e=n.container.find(".menu-item-settings").find("input, select, textarea, button, object, a[href], [tabindex]").filter(":visible"),e.first().focus(),i&&i()},n.expandForm(t)},e.section.has(n.section())?e.section(n.section()).expand({completeCallback:a}):a()},moveUp:function(){this._changePosition(-1),t.a11y.speak(e.Menus.data.l10n.movedUp)},moveDown:function(){this._changePosition(1),t.a11y.speak(e.Menus.data.l10n.movedDown)},moveLeft:function(){this._changeDepth(-1),t.a11y.speak(e.Menus.data.l10n.movedLeft)},moveRight:function(){this._changeDepth(1),t.a11y.speak(e.Menus.data.l10n.movedRight)},_changePosition:function(e){var t=this,n,i=_.clone(t.setting()),a=[],o;if(1!==e&&-1!==e)throw new Error("Offset changes by 1 are only supported.");if(t.setting()){if(_(t.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===i.menu_item_parent&&a.push(e.setting)}),a.sort(function(e,t){return e().position-t().position}),-1===(o=_.indexOf(a,t.setting)))throw new Error("Expected setting to be among siblings.");0===o&&e<0||o===a.length-1&&e>0||(n=a[o+e],n&&n.set($.extend(_.clone(n()),{position:i.position})),i.position+=e,t.setting.set(i))}},_changeDepth:function(t){if(1!==t&&-1!==t)throw new Error("Offset changes by 1 are only supported.");var n=this,i=_.clone(n.setting()),a=[],o,s,r;if(_(n.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===i.menu_item_parent&&a.push(e)}),a.sort(function(e,t){return e.setting().position-t.setting().position}),-1===(o=_.indexOf(a,n)))throw new Error("Expected control to be among siblings.");if(-1===t){if(!i.menu_item_parent)return;r=e.control("nav_menu_item["+i.menu_item_parent+"]"),_(a).chain().slice(o).each(function(e,t){e.setting.set($.extend({},e.setting(),{menu_item_parent:n.params.menu_item_id,position:t}))}),_(n.getMenuControl().getMenuItemControls()).each(function(e){var t,n;(n=e.setting().menu_item_parent===r.setting().menu_item_parent&&e.setting().position>r.setting().position)&&(t=_.clone(e.setting()),e.setting.set($.extend(t,{position:t.position+1})))}),i.position=r.setting().position+1,i.menu_item_parent=r.setting().menu_item_parent,n.setting.set(i)}else if(1===t){if(0===o)return;s=a[o-1],i.menu_item_parent=s.params.menu_item_id,i.position=0,_(n.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===i.menu_item_parent&&(i.position=Math.max(i.position,e.setting().position))}),i.position+=1,n.setting.set(i)}}}),e.Menus.MenuNameControl=e.Control.extend({ready:function(){var t=this;if(t.setting){var n=t.setting();t.nameElement=new e.Element(t.container.find(".menu-name-field")),t.nameElement.bind(function(e){var n=t.setting();n&&n.name!==e&&(n=_.clone(n),n.name=e,t.setting.set(n))}),n&&t.nameElement.set(n.name),t.setting.bind(function(e){e&&t.nameElement.set(e.name)})}}}),e.Menus.MenuLocationsControl=e.Control.extend({ready:function(){var t=this;t.container.find(".assigned-menu-location").each(function(){var n=$(this),a=n.find("input[type=checkbox]"),o=new e.Element(a),s=e("nav_menu_locations["+a.data("location-id")+"]"),r=""===t.params.menu_id,u=r?_.noop:function(e){o.set(e)},d=r?_.noop:function(e){s.set(e?t.params.menu_id:0)},c=function(t){var a=e("nav_menu["+String(t)+"]");t&&a&&a()?n.find(".theme-location-set").show().find("span").text(i(a().name)):n.find(".theme-location-set").hide()};u(s.get()===t.params.menu_id),a.on("change",function(){d(this.checked)}),s.bind(function(e){u(e===t.params.menu_id),
c(e)}),c(s.get())})},setSelections:function(e){this.container.find(".menu-location").each(function(t,n){var i=n.dataset.locationId;n.checked=i in e&&e[i]})}}),e.Menus.MenuAutoAddControl=e.Control.extend({ready:function(){var t=this,n=t.setting();t.active.validate=function(){var n,i=e.section(t.section());return n=!!i&&i.active()},t.autoAddElement=new e.Element(t.container.find("input[type=checkbox].auto_add")),t.autoAddElement.bind(function(e){var n=t.setting();n&&n.name!==e&&(n=_.clone(n),n.auto_add=e,t.setting.set(n))}),n&&t.autoAddElement.set(n.auto_add),t.setting.bind(function(e){e&&t.autoAddElement.set(e.auto_add)})}}),e.Menus.MenuControl=e.Control.extend({ready:function(){var t=this,n=e.section(t.section()),a=t.params.menu_id,o=t.setting(),s,r,u;if(void 0===this.params.menu_id)throw new Error("params.menu_id was not defined");t.active.validate=function(){var e;return e=!!n&&n.active()},t.$controlSection=n.headContainer,t.$sectionContent=t.container.closest(".accordion-section-content"),this._setupModel(),e.section(t.section(),function(e){e.deferred.initSortables.done(function(e){t._setupSortable(e)})}),this._setupAddition(),this._setupTitle(),o&&(s=i(o.name),e.control.each(function(t){t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base&&(t.container.find(".nav-menu-widget-form-controls:first").show(),t.container.find(".nav-menu-widget-no-menus-message:first").hide(),u=t.container.find("select"),0===u.find("option[value="+String(a)+"]").length&&u.append(new Option(s,a)))}),r=$("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )"),r.find(".nav-menu-widget-form-controls:first").show(),r.find(".nav-menu-widget-no-menus-message:first").hide(),u=r.find(".widget-inside select:first"),0===u.find("option[value="+String(a)+"]").length&&u.append(new Option(s,a))),_.defer(function(){t.updateInvitationVisibility()})},_setupModel:function(){var t=this,n=t.params.menu_id;t.setting.bind(function(a){var o;!1===a?t._handleDeletion():(o=i(a.name),e.control.each(function(t){if(t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base){t.container.find("select").find("option[value="+String(n)+"]").text(o)}}))})},_setupSortable:function(t){var n=this;if(!t.is(n.$sectionContent))throw new Error("Unexpected menuList.");t.on("sortstart",function(){n.isSorting=!0}),t.on("sortstop",function(){setTimeout(function(){var t=n.$sectionContent.sortable("toArray"),i=[],a=0,o=10;n.isSorting=!1,n.$sectionContent.scrollLeft(0),_.each(t,function(t){var n,a,o;(o=t.match(/^customize-control-nav_menu_item-(-?\d+)$/,""))&&(n=parseInt(o[1],10),(a=e.control("nav_menu_item["+String(n)+"]"))&&i.push(a))}),_.each(i,function(e){if(!1!==e.setting()){var t=_.clone(e.setting());a+=1,o+=1,t.position=a,e.priority(o),t.menu_item_parent=parseInt(e.container.find(".menu-item-data-parent-id").val(),10),t.menu_item_parent||(t.menu_item_parent=0),e.setting.set(t)}})})}),n.isReordering=!1,this.container.find(".reorder-toggle").on("click",function(){n.toggleReordering(!n.isReordering)})},_setupAddition:function(){var t=this;this.container.find(".add-new-menu-item").on("click",function(n){t.$sectionContent.hasClass("reordering")||($("body").hasClass("adding-menu-items")?($(this).attr("aria-expanded","false"),e.Menus.availableMenuItemsPanel.close(),n.stopPropagation()):($(this).attr("aria-expanded","true"),e.Menus.availableMenuItemsPanel.open(t)))})},_handleDeletion:function(){var n=this,i,a=n.params.menu_id,o,s,r=0;i=e.section(n.section()),o=function(){i.container.remove(),e.section.remove(i.id)},i&&i.expanded()?i.collapse({completeCallback:function(){o(),t.a11y.speak(e.Menus.data.l10n.menuDeleted),e.panel("nav_menus").focus()}}):o(),e.each(function(e){/^nav_menu\[/.test(e.id)&&!1!==e()&&(r+=1)}),e.control.each(function(t){if(t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base){var n=t.container.find("select");n.val()===String(a)&&n.prop("selectedIndex",0).trigger("change"),t.container.find(".nav-menu-widget-form-controls:first").toggle(0!==r),t.container.find(".nav-menu-widget-no-menus-message:first").toggle(0===r),t.container.find("option[value="+String(a)+"]").remove()}}),s=$("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )"),s.find(".nav-menu-widget-form-controls:first").toggle(0!==r),s.find(".nav-menu-widget-no-menus-message:first").toggle(0===r),s.find("option[value="+String(a)+"]").remove()},_setupTitle:function(){var t=this;t.setting.bind(function(n){if(n){var a=e.section(t.section()),o=t.params.menu_id,s=a.headContainer.find(".accordion-section-title"),r=a.contentContainer.find(".customize-section-title h3"),u=a.headContainer.find(".menu-in-location"),d=r.find(".customize-action"),c=i(n.name);s.text(c),u.length&&u.appendTo(s),r.text(c),d.length&&d.prependTo(r),e.control.each(function(e){/^nav_menu_locations\[/.test(e.id)&&e.container.find("option[value="+o+"]").text(c)}),a.contentContainer.find(".customize-control-checkbox input").each(function(){$(this).prop("checked")&&$(".current-menu-location-name-"+$(this).data("location-id")).text(c)})}})},toggleReordering:function(n){var i=this.container.find(".add-new-menu-item"),a=this.container.find(".reorder-toggle"),o=this.$sectionContent.find(".item-title");(n=Boolean(n))!==this.$sectionContent.hasClass("reordering")&&(this.isReordering=n,this.$sectionContent.toggleClass("reordering",n),this.$sectionContent.sortable(this.isReordering?"disable":"enable"),this.isReordering?(i.attr({tabindex:"-1","aria-hidden":"true"}),a.attr("aria-label",e.Menus.data.l10n.reorderLabelOff),t.a11y.speak(e.Menus.data.l10n.reorderModeOn),o.attr("aria-hidden","false")):(i.removeAttr("tabindex aria-hidden"),a.attr("aria-label",e.Menus.data.l10n.reorderLabelOn),t.a11y.speak(e.Menus.data.l10n.reorderModeOff),o.attr("aria-hidden","true")),n&&_(this.getMenuItemControls()).each(function(e){e.collapseForm()}))},getMenuItemControls:function(){var t=this,n=[],i=t.params.menu_id;return e.control.each(function(e){"nav_menu_item"===e.params.type&&e.setting()&&i===e.setting().nav_menu_term_id&&n.push(e)}),n},reflowMenuItems:function(){var e=this,t=e.getMenuItemControls(),n;n=function(e){var t=[],i=e.currentParent;_.each(e.menuItemControls,function(e){i===e.setting().menu_item_parent&&t.push(e)}),t.sort(function(e,t){return e.setting().position-t.setting().position}),_.each(t,function(t){e.currentAbsolutePosition+=1,t.priority.set(e.currentAbsolutePosition),t.container.hasClass("menu-item-depth-"+String(e.currentDepth))||(_.each(t.container.prop("className").match(/menu-item-depth-\d+/g),function(e){t.container.removeClass(e)}),t.container.addClass("menu-item-depth-"+String(e.currentDepth))),t.container.data("item-depth",e.currentDepth),e.currentDepth+=1,e.currentParent=t.params.menu_item_id,n(e),e.currentDepth-=1,e.currentParent=i}),t.length&&(_(t).each(function(t){t.container.removeClass("move-up-disabled move-down-disabled move-left-disabled move-right-disabled"),0===e.currentDepth?t.container.addClass("move-left-disabled"):10===e.currentDepth&&t.container.addClass("move-right-disabled")}),t[0].container.addClass("move-up-disabled").addClass("move-right-disabled").toggleClass("move-down-disabled",1===t.length),t[t.length-1].container.addClass("move-down-disabled").toggleClass("move-up-disabled",1===t.length))},n({menuItemControls:t,currentParent:0,currentDepth:0,currentAbsolutePosition:0}),e.updateInvitationVisibility(t),e.container.find(".reorder-toggle").toggle(t.length>1)},debouncedReflowMenuItems:_.debounce(function(){this.reflowMenuItems.apply(this,arguments)},0),addItemToMenu:function(n){var i=this,a,o,s,r,u,d=0,c=10;return _.each(i.getMenuItemControls(),function(e){!1!==e.setting()&&(c=Math.max(c,e.priority()),0===e.setting().menu_item_parent&&(d=Math.max(d,e.setting().position)))}),d+=1,c+=1,n=$.extend({},e.Menus.data.defaultSettingValues.nav_menu_item,n,{nav_menu_term_id:i.params.menu_id,original_title:n.title,position:d}),delete n.id,u=e.Menus.generatePlaceholderAutoIncrementId(),a="nav_menu_item["+String(u)+"]",o={type:"nav_menu_item",transport:e.Menus.data.settingTransport,previewer:e.previewer},s=e.create(a,a,{},o),s.set(n),r=new e.controlConstructor.nav_menu_item(a,{type:"nav_menu_item",section:i.id,priority:c,settings:{default:a},menu_item_id:u}),e.control.add(r),s.preview(),i.debouncedReflowMenuItems(),t.a11y.speak(e.Menus.data.l10n.itemAdded),r},updateInvitationVisibility:function(e){var t=e||this.getMenuItemControls();this.container.find(".new-menu-item-invitation").toggle(0===t.length)}}),e.Menus.NewMenuControl=e.Control.extend({initialize:function(){"undefined"!=typeof console&&console.warn&&console.warn("[DEPRECATED] wp.customize.NewMenuControl will be removed. Please use wp.customize.Menus.createNavMenu() instead."),e.Control.prototype.initialize.apply(this,arguments)},ready:function(){this._bindHandlers()},_bindHandlers:function(){var e=this,t=$("#customize-control-new_menu_name input"),n=$("#create-new-menu-submit");t.on("keydown",function(t){13===t.which&&e.submit()}),n.on("click",function(t){e.submit(),t.stopPropagation(),t.preventDefault()})},submit:function(){var n=this,i=n.container.closest(".accordion-section-new-menu"),a=i.find(".menu-name-field").first(),o=a.val(),s;if(!o)return a.addClass("invalid"),void a.focus();s=e.Menus.createNavMenu(o),a.val(""),a.removeClass("invalid"),t.a11y.speak(e.Menus.data.l10n.menuAdded),s.focus()}}),$.extend(e.controlConstructor,{nav_menu_location:e.Menus.MenuLocationControl,nav_menu_item:e.Menus.MenuItemControl,nav_menu:e.Menus.MenuControl,nav_menu_name:e.Menus.MenuNameControl,new_menu:e.Menus.NewMenuControl,nav_menu_locations:e.Menus.MenuLocationsControl,nav_menu_auto_add:e.Menus.MenuAutoAddControl}),$.extend(e.panelConstructor,{nav_menus:e.Menus.MenusPanel}),$.extend(e.sectionConstructor,{nav_menu:e.Menus.MenuSection,new_menu:e.Menus.NewMenuSection}),e.bind("ready",function(){e.Menus.availableMenuItemsPanel=new e.Menus.AvailableMenuItemsPanelView({collection:e.Menus.availableMenuItems}),e.bind("saved",function(t){(t.nav_menu_updates||t.nav_menu_item_updates)&&e.Menus.applySavedData(t)}),e.state("changesetStatus").bind(function(t){"publish"===t&&(e("nav_menus_created_posts")._value=[])}),e.previewer.bind("focus-nav-menu-item-control",e.Menus.focusMenuItemControl)}),e.Menus.applySavedData=function(n){var i={},a={};_(n.nav_menu_updates).each(function(n){var a,o,s,r,u,d,c,l,m,p,f,v,h;if("inserted"===n.status){if(!n.previous_term_id)throw new Error("Expected previous_term_id");if(!n.term_id)throw new Error("Expected term_id");if(a="nav_menu["+String(n.previous_term_id)+"]",!e.has(a))throw new Error("Expected setting to exist: "+a);if(r=e(a),!e.section.has(a))throw new Error("Expected control to exist: "+a);if(l=e.section(a),!(c=r.get()))throw new Error("Did not expect setting to be empty (deleted).");c=$.extend(_.clone(c),n.saved_value),i[n.previous_term_id]=n.term_id,o="nav_menu["+String(n.term_id)+"]",u=e.create(o,o,c,{type:"nav_menu",transport:e.Menus.data.settingTransport,previewer:e.previewer}),h=l.expanded(),h&&l.collapse(),m=new e.Menus.MenuSection(o,{panel:"nav_menus",title:c.name,customizeAction:e.Menus.data.l10n.customizingMenus,type:"nav_menu",priority:l.priority.get(),menu_id:n.term_id}),e.section.add(m),e.control.each(function(t){if(t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base){var i,a,o;i=t.container.find("select"),a=i.find("option[value="+String(n.previous_term_id)+"]"),o=i.find("option[value="+String(n.term_id)+"]"),o.prop("selected",a.prop("selected")),a.remove()}}),r.callbacks.disable(),r.set(!1),r.preview(),u.preview(),r._dirty=!1,l.container.remove(),e.section.remove(a),v=0,e.each(function(e){/^nav_menu\[/.test(e.id)&&!1!==e()&&(v+=1)}),f=$("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )"),f.find(".nav-menu-widget-form-controls:first").toggle(0!==v),f.find(".nav-menu-widget-no-menus-message:first").toggle(0===v),f.find("option[value="+String(n.previous_term_id)+"]").remove(),t.customize.control.each(function(e){/^nav_menu_locations\[/.test(e.id)&&e.container.find("option[value="+String(n.previous_term_id)+"]").remove()}),e.each(function(t){var i=e.state("saved").get();/^nav_menu_locations\[/.test(t.id)&&t.get()===n.previous_term_id&&(t.set(n.term_id),t._dirty=!1,e.state("saved").set(i),t.preview())}),h&&m.expand()}else if("updated"===n.status){if(s="nav_menu["+String(n.term_id)+"]",!e.has(s))throw new Error("Expected setting to exist: "+s);d=e(s),_.isEqual(n.saved_value,d.get())||(p=e.state("saved").get(),d.set(n.saved_value),d._dirty=!1,e.state("saved").set(p))}}),_(n.nav_menu_item_updates).each(function(e){e.previous_post_id&&(a[e.previous_post_id]=e.post_id)}),_(n.nav_menu_item_updates).each(function(t){var n,o,s,r,u,d,c;if("inserted"===t.status){if(!t.previous_post_id)throw new Error("Expected previous_post_id");if(!t.post_id)throw new Error("Expected post_id");if(n="nav_menu_item["+String(t.previous_post_id)+"]",!e.has(n))throw new Error("Expected setting to exist: "+n);if(s=e(n),!e.control.has(n))throw new Error("Expected control to exist: "+n);if(d=e.control(n),!(u=s.get()))throw new Error("Did not expect setting to be empty (deleted).");if(u=_.clone(u),u.menu_item_parent<0){if(!a[u.menu_item_parent])throw new Error("inserted ID for menu_item_parent not available");u.menu_item_parent=a[u.menu_item_parent]}i[u.nav_menu_term_id]&&(u.nav_menu_term_id=i[u.nav_menu_term_id]),o="nav_menu_item["+String(t.post_id)+"]",r=e.create(o,o,u,{type:"nav_menu_item",transport:e.Menus.data.settingTransport,previewer:e.previewer}),c=new e.controlConstructor.nav_menu_item(o,{type:"nav_menu_item",menu_id:t.post_id,section:"nav_menu["+String(u.nav_menu_term_id)+"]",priority:d.priority.get(),settings:{default:o},menu_item_id:t.post_id}),d.container.remove(),e.control.remove(n),e.control.add(c),s.callbacks.disable(),s.set(!1),s.preview(),r.preview(),s._dirty=!1,c.container.toggleClass("menu-item-edit-inactive",d.container.hasClass("menu-item-edit-inactive"))}}),_.each(n.widget_nav_menu_updates,function(t,n){var i=e(n);i&&(i._value=t,i.preview())})},e.Menus.focusMenuItemControl=function(t){var n=e.Menus.getMenuItemControl(t);n&&n.focus()},e.Menus.getMenuControl=function(t){return e.control("nav_menu["+t+"]")},e.Menus.getMenuItemControl=function(t){return e.control(n(t))}}(wp.customize,wp,jQuery);
//# sourceMappingURL=./customize-nav-menus-min.js.map