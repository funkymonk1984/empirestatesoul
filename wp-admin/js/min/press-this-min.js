!function($,e){var t=function(){function t(t){return t&&e.pressThisL10n?e.pressThisL10n[t]||t:t||""}function s(e){return e=e||"",e.replace(/<!--[\s\S]*?(-->|$)/g,"").replace(/<(script|style)[^>]*>[\s\S]*?(<\/\1>|$)/gi,"").replace(/<\/?[a-z][\s\S]*?(>|$)/gi,"")}function n(e){var t=s(e);try{q.innerHTML=t,t=s(q.value)}catch(n){}return t}function a(e){return e=$.trim(e||""),/^(?:https?:)?\/\//.test(e)?(e=s(e),e.replace(/["\\]+/g,"")):""}function i(){$(".spinner").addClass("is-active"),$(".post-actions button").attr("disabled","disabled")}function o(){$(".spinner").removeClass("is-active"),$(".post-actions button").removeAttr("disabled")}function r(t){var s,n;(!S||S.isHidden())&&(t="reset"===t||ee&&ee>J.value.length,n=J.style.height,t?(s=e.pageYOffset,J.style.height="auto",J.style.height=Math.max(J.scrollHeight,Z)+"px",e.scrollTo(e.pageXOffset,s)):parseInt(J.style.height,10)<J.scrollHeight&&(J.style.height=J.scrollHeight+"px"),ee=J.value.length)}function c(){if(!S)return!1;var e=S.selection.getNode(),t,s,n;if(S.wp&&S.wp.getView&&(s=S.wp.getView(e)))n=s.getBoundingClientRect();else{t=S.selection.getRng();try{n=t.getClientRects()[0]}catch(a){}n||(n=e.getBoundingClientRect())}return n.height?n:!1}function l(t){var s=e.tinymce.util.VK,n=t.keyCode;47>=n&&n!==s.SPACEBAR&&n!==s.ENTER&&n!==s.DELETE&&n!==s.BACKSPACE&&n!==s.UP&&n!==s.LEFT&&n!==s.DOWN&&n!==s.UP||n>=91&&93>=n||n>=112&&123>=n||144===n||145===n||d(n)}function d(t){var s,n,a,i=c(),o=50,r=65,l=e.tinymce.util.VK;i&&(s=i.top+S.iframeElement.getBoundingClientRect().top,n=s+i.height,s-=o,n+=r,a=H.height(),a<i.height||(0>s&&(t===l.UP||t===l.LEFT||t===l.BACKSPACE)?e.scrollTo(e.pageXOffset,s+e.pageYOffset):n>a&&e.scrollTo(e.pageXOffset,n+e.pageYOffset-a)))}function p(){var e=$("#title-container");return e.find("img.emoji").each(function(){var e=$(this);e.replaceWith($("<span>").text(e.attr("alt")))}),n(e.text())}function u(){var t=$("#pressthis-form"),s=$('<input type="hidden" name="post_category[]" value="">');S&&S.save(),$("#post_title").val(p()),e.tagBox&&$("div.tagsdiv").each(function(){e.tagBox.flushTags(this,!1,1)}),$(".categories-select .category").each(function(e,n){var a=$(n);a.hasClass("selected")&&t.append(s.clone().val(a.attr("data-term-id")||""))})}function f(s){var n;I=!1,i(),"publish"===s&&$("#post_status").val("publish"),u(),n=$("#pressthis-form").serialize(),$.ajax({type:"post",url:e.ajaxurl,data:n}).always(function(){o(),b(),$(".publish-button").removeClass("is-saving")}).done(function(t){if(t.success){if(t.data.redirect)if(e.opener&&(F.redirInParent||t.data.force))try{e.opener.location.href=t.data.redirect,e.setTimeout(function(){e.self.close()},200)}catch(s){e.location.href=t.data.redirect}else e.location.href=t.data.redirect}else C(t.data.errorMessage)}).fail(function(){C(t("serverError"))})}function h(t){var s,n,i="";s=a(t.attr("data-wp-src")||""),n=a(K.u),t.hasClass("is-image")?(n||(n=s),i='<a href="'+n+'"><img class="alignnone size-full" src="'+s+'" alt="" /></a>'):i="[embed]"+s+"[/embed]",S&&!S.isHidden()?V?S.execCommand("mceInsertContent",!1,i):S.setContent("<p>"+i+"</p>"+S.getContent()):e.QTags&&e.QTags.insertContent(i)}function g(){var t,s=$("#new-category").val();s&&(t={action:"press-this-add-category",post_id:$("#post_ID").val()||0,name:s,new_cat_nonce:$("#_ajax_nonce-add-category").val()||"",parent:$("#new-category-parent").val()||0},$.post(e.ajaxurl,t,function(e){if(e.success){var t,s,n=$("ul.categories-select");$.each(e.data,function(e,a){var i=$("<li>").append($('<div class="category selected" tabindex="0" role="checkbox" aria-checked="true">').attr("data-term-id",a.term_id).text(a.name));a.parent?(s&&s.length||(t=n.find('div[data-term-id="'+a.parent+'"]').parent(),s=t.find("ul.children:first"),s.length||(s=$('<ul class="children">').appendTo(t))),s.prepend(i)):n.prepend(i),i.focus()}),R()}else C(e.data.errorMessage)}))}function m(){K.hasData&&$("#scanbar").hide()}function v(e,t){var s=$(".editor-wrapper div.alerts"),n=t?"is-error":"is-notice";s.append($('<p class="alert '+n+'">').text(e))}function C(e){v(e,!0)}function b(){$("div.alerts").empty()}function x(){K.errors&&$.each(K.errors,function(e,t){C(t)})}function y(e,s,n){var a=L.clone().addClass("is-image");a.attr("data-wp-src",e).css("background-image","url("+s+")").find("span").text(t("suggestedImgAlt").replace("%d",n+1)),j.append(a)}function w(){var e=0;j=$("ul.media-list"),L=$('<li class="suggested-media-thumbnail" tabindex="0"><span class="screen-reader-text"></span></li>'),K._embeds&&$.each(K._embeds,function(s,n){var i="",o="",r=L.clone().addClass("is-embed");n=a(n),n.indexOf("youtube.com/")>-1?(i="https://i.ytimg.com/vi/"+n.replace(/.+v=([^&]+).*/,"$1")+"/hqdefault.jpg",o+=" is-video"):n.indexOf("youtu.be/")>-1?(i="https://i.ytimg.com/vi/"+n.replace(/\/([^\/])$/,"$1")+"/hqdefault.jpg",o+=" is-video"):n.indexOf("dailymotion.com")>-1?(i=n.replace("/video/","/thumbnail/video/"),o+=" is-video"):o+=n.indexOf("soundcloud.com")>-1?" is-audio":n.indexOf("twitter.com")>-1?" is-tweet":" is-video",r.attr("data-wp-src",n).find("span").text(t("suggestedEmbedAlt").replace("%d",s+1)),i&&r.css("background-image","url("+i+")"),j.append(r),e++}),K._images&&$.each(K._images,function(t,s){var n,i=new Image;s=a(s),n=s.replace(/^(http[^\?]+)(\?.*)?$/,"$1"),n=s.indexOf("files.wordpress.com/")>-1?n.replace(/\?.*$/,"")+"?w="+M:s.indexOf("gravatar.com/")>-1?n.replace(/\?.*$/,"")+"?s="+M:s,i.onload=function(){i.width&&i.width<256||i.height&&i.height<128||y(s,n,t)},i.src=s,e++}),e&&$(".media-list-container").addClass("has-media")}function k(){var e=$(".post-options"),t=$(".post-option"),s=$(".setting-modal"),n=$(".modal-close");t.on("click",function(){var t=$(this).index(),n=s.eq(t);e.addClass(Q).one(te,function(){$(this).addClass(U)}),n.removeClass(W).one(te,function(){$(this).find(".modal-close").focus()})}),n.on("click",function(){var s=$(this).parent(),n=s.index();e.removeClass(W),s.addClass(Q),te?s.one(te,function(){$(this).addClass(U),t.eq(n-1).focus()}):setTimeout(function(){s.addClass(U),t.eq(n-1).focus()},350)})}function T(){z=!0,$(".options").removeClass("closed").addClass("open"),$(".press-this-actions, #scanbar").addClass(U),$(".options-panel-back").removeClass(U),$(".options-panel").removeClass(W).one(te,function(){$(".post-option:first").focus()})}function E(){z=!1,$(".options").removeClass("open").addClass("closed"),$(".options-panel-back").addClass(U),$(".press-this-actions, #scanbar").removeClass(U),$(".options-panel").addClass(Q).one(te,function(){$(this).addClass(U),$(".post-options").removeClass(W),$(".setting-modal").addClass(W)})}function O(){var t=$("#title-container"),s=$(".post-title-placeholder");t.on("focus",function(){s.addClass("is-hidden")}).on("blur",function(){t.text()||t.html()||s.removeClass("is-hidden")}).on("keyup",function(){I=!0}).on("paste",function(s){var n,a,i=s.originalEvent.clipboardData||e.clipboardData;if(i){try{n=i.getData("Text")||i.getData("text/plain"),n&&(n=$.trim(n.replace(/\s+/g," ")),e.getSelection?(a=e.getSelection().getRangeAt(0),a&&(a.collapsed||a.deleteContents(),a.insertNode(document.createTextNode(n)))):document.selection&&(a=document.selection.createRange(),a&&(a.text=n)))}catch(o){}s.preventDefault()}I=!0,setTimeout(function(){t.text(p())},50)}),(t.text()||t.html())&&s.addClass("is-hidden")}function _(e){e.hasClass("selected")?e.removeClass("selected").attr("aria-checked","false"):e.addClass("selected").attr("aria-checked","true")}function A(){$(".categories-select").on("click.press-this keydown.press-this",function(e){var t=$(e.target);if(t.is("div.category")){if("keydown"===e.type&&32!==e.keyCode)return;_(t),e.preventDefault()}})}function D(){$(".split-button").removeClass("is-open"),$(".split-button-toggle").attr("aria-expanded","false")}function P(){m(),w(),x(),e.tagBox&&e.tagBox.init(),X&&$(document.body).css("cursor","pointer")}function B(){var s=$(".split-button");return N.on("tinymce-editor-init",function(e,t){S=t,S.on("nodechange",function(){V=!0}),S.on("focus",function(){D()}),S.on("show",function(){setTimeout(function(){S.execCommand("wpAutoResize")},300)}),S.on("hide",function(){setTimeout(function(){r("reset")},100)}),S.on("keyup",l),S.on("undo redo",d)}).on("click.press-this keypress.press-this",".suggested-media-thumbnail",function(e){("click"===e.type||13===e.keyCode)&&h($(this))}).on("click.press-this",function(e){$(e.target).closest("button").hasClass("split-button-toggle")||D()}),$(".post-actions").on("click.press-this",function(t){var n,a=$(t.target),i=a.closest("button");i.length&&(i.hasClass("draft-button")?($(".publish-button").addClass("is-saving"),f("draft")):i.hasClass("publish-button")?(i.addClass("is-saving"),e.history.replaceState&&(n=e.location.href,n+=-1!==n.indexOf("?")?"&":"?",n+="wp-press-this-reload=true",e.history.replaceState(null,null,n)),f("publish")):i.hasClass("preview-button")?(u(),e.opener&&e.opener.focus(),$("#wp-preview").val("dopreview"),$("#pressthis-form").attr("target","_blank").submit().attr("target",""),$("#wp-preview").val("")):i.hasClass("standard-editor-button")?($(".publish-button").addClass("is-saving"),$("#pt-force-redirect").val("true"),f("draft")):i.hasClass("split-button-toggle")&&(s.hasClass("is-open")?(s.removeClass("is-open"),i.attr("aria-expanded","false")):(s.addClass("is-open"),i.attr("aria-expanded","true"))))}),k(),O(),A(),$(".options").on("click.press-this",function(){$(this).hasClass("open")?E():T()}),$(".options-panel, .options-panel-back").on("focusout.press-this",function(){setTimeout(function(){var e=document.activeElement,t=$(e);!z||!e||t.hasClass("options-panel-back")||"BODY"!==e.nodeName&&(t.closest(".options-panel").length||t.closest(".options").length)||E()},50)}),$("#post-formats-select input").on("change",function(){var e=$(this);e.is(":checked")&&$("#post-option-post-format").text($('label[for="'+e.attr("id")+'"]').text()||"")}),H.on("beforeunload.press-this",function(){return I||S&&S.isDirty()?t("saveAlert"):void 0}).on("resize.press-this",function(){(!S||S.isHidden())&&r("reset")}),$("button.add-cat-toggle").on("click.press-this",function(){var e=$(this);e.toggleClass("is-toggled"),e.attr("aria-expanded","false"===e.attr("aria-expanded")?"true":"false"),$(".setting-modal .add-category, .categories-search-wrapper").toggleClass("is-hidden")}),$("button.add-cat-submit").on("click.press-this",g),$(".categories-search").on("keyup.press-this",function(){var e=$(this).val().toLowerCase()||"";/[\x20-\xFF]+/.test(e)&&e.length<2||($.each(Y,function(e,t){t.node.removeClass("is-hidden searched-parent")}),e&&$.each(Y,function(t,s){-1===s.text.indexOf(e)?s.node.addClass("is-hidden"):s.parents.addClass("searched-parent")}))}),G.on("focus.press-this input.press-this propertychange.press-this",r),!0}function R(){$(".categories-select").find("li").each(function(){var e=$(this);Y.push({node:e,parents:e.parents("li"),text:e.children(".category").text().toLowerCase()})})}var S,j,L,H=$(e),N=$(document),I=!1,q=document.createElement("textarea"),z=!1,F=e.wpPressThisConfig||{},K=e.wpPressThisData||{},M=128,V=!1,Y=[],Q="is-off-screen",U="is-hidden",W=Q+" "+U,X=/iPad|iPod|iPhone/.test(e.navigator.userAgent),G=$("#pressthis"),J=G[0],Z=600,ee=0,te=function(){var e=document.documentElement.style;return"undefined"!=typeof e.transition?"transitionend":"undefined"!=typeof e.WebkitTransition?"webkitTransitionEnd":!1}();return N.ready(function(){P(),B(),R()}),{renderNotice:v,renderError:C}};e.wp=e.wp||{},e.wp.pressThis=new t}(jQuery,window);