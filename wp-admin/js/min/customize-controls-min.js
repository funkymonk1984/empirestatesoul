!function(e,$){var t,n,i,a=wp.customize;a.OverlayNotification=a.Notification.extend({loading:!1,initialize:function(e,t){var n=this;a.Notification.prototype.initialize.call(n,e,t),n.containerClasses+=" notification-overlay",n.loading&&(n.containerClasses+=" notification-loading")},render:function(){var e=a.Notification.prototype.render.call(this);return e.on("keydown",_.bind(this.handleEscape,this)),e},handleEscape:function(e){var t=this;27===e.which&&(e.stopPropagation(),t.dismissible&&t.parent&&t.parent.remove(t.code))}}),a.Notifications=a.Values.extend({alt:!1,defaultConstructor:a.Notification,initialize:function(e){var t=this;a.Values.prototype.initialize.call(t,e),_.bindAll(t,"constrainFocus"),t._addedIncrement=0,t._addedOrder={},t.bind("add",function(e){t.trigger("change",e)}),t.bind("removed",function(e){t.trigger("change",e)})},count:function(){return _.size(this._value)},add:function(e,t){var n=this,i,o;return"string"==typeof e?(i=e,o=t):(i=e.code,o=e),n.has(i)||(n._addedIncrement+=1,n._addedOrder[i]=n._addedIncrement),a.Values.prototype.add.call(n,i,o)},remove:function(e){return delete this._addedOrder[e],a.Values.prototype.remove.call(this,e)},get:function(e){var t=this,n,i,a;return n=_.values(t._value),a=_.extend({sort:!1},e),a.sort&&(i={error:4,warning:3,success:2,info:1},n.sort(function(e,n){var a=0,o=0;return _.isUndefined(i[e.type])||(a=i[e.type]),_.isUndefined(i[n.type])||(o=i[n.type]),a!==o?o-a:t._addedOrder[n.code]-t._addedOrder[e.code]})),n},render:function(){var e=this,t,n=!1,i,o=[],s={},r,c;e.container&&e.container.length&&(t=e.get({sort:!0}),e.container.toggle(0!==t.length),e.container.is(e.previousContainer)&&_.isEqual(t,e.previousNotifications)||(r=e.container.children("ul").first(),r.length||(r=$("<ul></ul>"),e.container.append(r)),r.find("> [data-code]").remove(),_.each(e.previousNotifications,function(e){s[e.code]=e}),_.each(t,function(e){var t;!wp.a11y||s[e.code]&&_.isEqual(e.message,s[e.code].message)||wp.a11y.speak(e.message,"assertive"),t=$(e.render()),e.container=t,r.append(t),e.extended(a.OverlayNotification)&&o.push(e)}),i=Boolean(o.length),e.previousNotifications&&(n=Boolean(_.find(e.previousNotifications,function(e){return e.extended(a.OverlayNotification)}))),i!==n&&($(document.body).toggleClass("customize-loading",i),e.container.toggleClass("has-overlay-notifications",i),i?(e.previousActiveElement=document.activeElement,$(document).on("keydown",e.constrainFocus)):$(document).off("keydown",e.constrainFocus)),i?(e.focusContainer=o[o.length-1].container,e.focusContainer.prop("tabIndex",-1),c=e.focusContainer.find(":focusable"),c.length?c.first().focus():e.focusContainer.focus()):e.previousActiveElement&&($(e.previousActiveElement).focus(),e.previousActiveElement=null),e.previousNotifications=t,e.previousContainer=e.container,e.trigger("rendered")))},constrainFocus:function e(t){var n=this,i;t.stopPropagation(),9===t.which&&(i=n.focusContainer.find(":focusable"),0===i.length&&(i=n.focusContainer),$.contains(n.focusContainer[0],t.target)&&$.contains(n.focusContainer[0],document.activeElement)?i.last().is(t.target)&&!t.shiftKey?(t.preventDefault(),i.first().focus()):i.first().is(t.target)&&t.shiftKey&&(t.preventDefault(),i.last().focus()):(t.preventDefault(),i.first().focus()))}}),a.Setting=a.Value.extend({defaults:{transport:"refresh",dirty:!1},initialize:function(e,t,n){var i=this,o;o=_.extend({previewer:a.previewer},i.defaults,n||{}),a.Value.prototype.initialize.call(i,t,o),i.id=e,i._dirty=o.dirty,i.notifications=new a.Notifications,i.bind(i.preview)},preview:function(){var e=this,t;t=e.transport,"postMessage"!==t||a.state("previewerAlive").get()||(t="refresh"),"postMessage"===t?e.previewer.send("setting",[e.id,e()]):"refresh"===t&&e.previewer.refresh()},findControls:function(){var e=this,t=[];return a.control.each(function(n){_.each(n.settings,function(i){i.id===e.id&&t.push(n)})}),t}}),a._latestRevision=0,a._lastSavedRevision=0,a._latestSettingRevisions={},a.bind("change",function e(t){a._latestRevision+=1,a._latestSettingRevisions[t.id]=a._latestRevision}),a.bind("ready",function(){a.bind("add",function e(t){t._dirty&&(a._latestRevision+=1,a._latestSettingRevisions[t.id]=a._latestRevision)})}),a.dirtyValues=function e(t){var n={};return a.each(function(e){var i;e._dirty&&(i=a._latestSettingRevisions[e.id],a.state("changesetStatus").get()&&t&&t.unsaved&&(_.isUndefined(i)||i<=a._lastSavedRevision)||(n[e.id]=e.get()))}),n},a.requestChangesetUpdate=function e(t,n){var i,o,s={},r,c;return i=new $.Deferred,0!==a.state("processing").get()?(i.reject("already_processing"),i.promise()):(c=_.extend({title:null,date:null,autosave:!1,force:!1},n),t&&_.extend(s,t),_.each(a.dirtyValues({unsaved:!0}),function(e,n){t&&null===t[n]||(s[n]=_.extend({},s[n]||{},{value:e}))}),a.trigger("changeset-save",s,c),!c.force&&_.isEmpty(s)&&null===c.title&&null===c.date?(i.resolve({}),i.promise()):c.status?i.reject({code:"illegal_status_in_changeset_update"}).promise():c.date&&c.autosave?i.reject({code:"illegal_autosave_with_date_gmt"}).promise():(a.state("processing").set(a.state("processing").get()+1),i.always(function(){a.state("processing").set(a.state("processing").get()-1)}),r=a.previewer.query({excludeCustomizedSaved:!0}),delete r.customized,_.extend(r,{nonce:a.settings.nonce.save,customize_theme:a.settings.theme.stylesheet,customize_changeset_data:JSON.stringify(s)}),null!==c.title&&(r.customize_changeset_title=c.title),null!==c.date&&(r.customize_changeset_date=c.date),!1!==c.autosave&&(r.customize_changeset_autosave="true"),a.trigger("save-request-params",r),o=wp.ajax.post("customize_save",r),o.done(function e(t){var n={};a._lastSavedRevision=Math.max(a._latestRevision,a._lastSavedRevision),a.state("changesetStatus").set(t.changeset_status),t.changeset_date&&a.state("changesetDate").set(t.changeset_date),i.resolve(t),a.trigger("changeset-saved",t),t.setting_validities&&_.each(t.setting_validities,function(e,t){!0===e&&_.isObject(s[t])&&!_.isUndefined(s[t].value)&&(n[t]=s[t].value)}),a.previewer.send("changeset-saved",_.extend({},t,{saved_changeset_values:n}))}),o.fail(function e(t){i.reject(t),a.trigger("changeset-error",t)}),o.always(function(e){e.setting_validities&&a._handleSettingValidities({settingValidities:e.setting_validities})}),i.promise()))},a.utils.bubbleChildValueChanges=function(e,t){$.each(t,function(t,n){e[n].bind(function(t,n){e.parent&&t!==n&&e.parent.trigger("change",e)})})},n=function(e){var t,n,i,o;t=this,e=e||{},i=function(){var e;e=(t.extended(a.Panel)||t.extended(a.Section))&&t.expanded&&t.expanded()?t.contentContainer:t.container,o=e.find(".control-focus:first"),0===o.length&&(o=e.find("input, select, textarea, button, object, a[href], [tabindex]").filter(":visible").first()),o.focus()},e.completeCallback?(n=e.completeCallback,e.completeCallback=function(){i(),n()}):e.completeCallback=i,a.state("paneVisible").set(!0),t.expand?t.expand(e):e.completeCallback()},a.utils.prioritySort=function(e,t){return e.priority()===t.priority()&&"number"==typeof e.params.instanceNumber&&"number"==typeof t.params.instanceNumber?e.params.instanceNumber-t.params.instanceNumber:e.priority()-t.priority()},a.utils.isKeydownButNotEnterEvent=function(e){return"keydown"===e.type&&13!==e.which},a.utils.areElementListsEqual=function(e,t){return e.length===t.length&&-1===_.indexOf(_.map(_.zip(e,t),function(e){return $(e[0]).is(e[1])}),!1)},a.utils.highlightButton=function e(t,n){function i(){o=!0}var a="button-see-me",o=!1,s;return s=_.extend({delay:0,focusTarget:t},n),s.focusTarget.on("focusin",i),setTimeout(function(){s.focusTarget.off("focusin",i),o||(t.addClass(a),t.one("animationend",function(){t.removeClass(a)}))},s.delay),i},a.utils.getCurrentTimestamp=function e(){var t,n,i;return n=_.now(),t=new Date(a.settings.initialServerDate.replace(/-/g,"/")),i=n-a.settings.initialClientTimestamp,i+=a.settings.initialClientTimestamp-a.settings.initialServerTimestamp,t.setTime(t.getTime()+i),t.getTime()},a.utils.getRemainingTime=function e(t){var n=1e3,i,o;return o=t instanceof Date?t.getTime():"string"==typeof t?new Date(t.replace(/-/g,"/")).getTime():t,i=o-a.utils.getCurrentTimestamp(),i=Math.ceil(i/1e3)},i=function(){var e,t,n;return e=document.createElement("div"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},n=_.find(_.keys(t),function(t){return!_.isUndefined(e.style[t])}),n?t[n]:null}(),t=a.Class.extend({defaultActiveArguments:{duration:"fast",completeCallback:$.noop},defaultExpandedArguments:{duration:"fast",completeCallback:$.noop},containerType:"container",defaults:{title:"",description:"",priority:100,type:"default",content:null,active:!0,instanceNumber:null},initialize:function(e,n){var i=this;i.id=e,t.instanceCounter||(t.instanceCounter=0),t.instanceCounter++,$.extend(i,{params:_.defaults(n.params||n,i.defaults)}),i.params.instanceNumber||(i.params.instanceNumber=t.instanceCounter),i.notifications=new a.Notifications,i.templateSelector=i.params.templateId||"customize-"+i.containerType+"-"+i.params.type,i.container=$(i.params.content),0===i.container.length&&(i.container=$(i.getContainer())),i.headContainer=i.container,i.contentContainer=i.getContent(),i.container=i.container.add(i.contentContainer),i.deferred={embedded:new $.Deferred},i.priority=new a.Value,i.active=new a.Value,i.activeArgumentsQueue=[],i.expanded=new a.Value,i.expandedArgumentsQueue=[],i.active.bind(function(e){var t=i.activeArgumentsQueue.shift();t=$.extend({},i.defaultActiveArguments,t),e=e&&i.isContextuallyActive(),i.onChangeActive(e,t)}),i.expanded.bind(function(e){var t=i.expandedArgumentsQueue.shift();t=$.extend({},i.defaultExpandedArguments,t),i.onChangeExpanded(e,t)}),i.deferred.embedded.done(function(){i.setupNotifications(),i.attachEvents()}),a.utils.bubbleChildValueChanges(i,["priority","active"]),i.priority.set(i.params.priority),i.active.set(i.params.active),i.expanded.set(!1)},getNotificationsContainerElement:function(){return this.contentContainer.find(".customize-control-notifications-container:first")},setupNotifications:function(){var e=this,t;e.notifications.container=e.getNotificationsContainerElement(),t=function(){e.expanded.get()&&e.notifications.render()},e.expanded.bind(t),t(),e.notifications.bind("change",_.debounce(t))},ready:function(){},_children:function(e,t){var n=this,i=[];return a[t].each(function(t){t[e].get()===n.id&&i.push(t)}),i.sort(a.utils.prioritySort),i},isContextuallyActive:function(){throw new Error("Container.isContextuallyActive() must be overridden in a subclass.")},onChangeActive:function(e,t){var n=this,i=n.headContainer,o,s;if(t.unchanged)return void(t.completeCallback&&t.completeCallback());o="resolved"===a.previewer.deferred.active.state()?t.duration:0,n.extended(a.Panel)&&(a.panel.each(function(e){e!==n&&e.expanded()&&(s=e,o=0)}),e||_.each(n.sections(),function(e){e.collapse({duration:0})})),$.contains(document,i.get(0))?e?i.slideDown(o,t.completeCallback):n.expanded()?n.collapse({duration:o,completeCallback:function(){i.slideUp(o,t.completeCallback)}}):i.slideUp(o,t.completeCallback):(i.toggle(e),t.completeCallback&&t.completeCallback())},_toggleActive:function(e,t){var n=this;return t=t||{},e&&this.active.get()||!e&&!this.active.get()?(t.unchanged=!0,n.onChangeActive(n.active.get(),t),!1):(t.unchanged=!1,this.activeArgumentsQueue.push(t),this.active.set(e),!0)},activate:function(e){return this._toggleActive(!0,e)},deactivate:function(e){return this._toggleActive(!1,e)},onChangeExpanded:function(){throw new Error("Must override with subclass.")},_toggleExpanded:function(e,t){var n=this,i;return t=t||{},i=t.completeCallback,!(e&&!n.active())&&(a.state("paneVisible").set(!0),t.completeCallback=function(){i&&i.apply(n,arguments),e?n.container.trigger("expanded"):n.container.trigger("collapsed")},e&&n.expanded.get()||!e&&!n.expanded.get()?(t.unchanged=!0,n.onChangeExpanded(n.expanded.get(),t),!1):(t.unchanged=!1,n.expandedArgumentsQueue.push(t),n.expanded.set(e),!0))},expand:function(e){return this._toggleExpanded(!0,e)},collapse:function(e){return this._toggleExpanded(!1,e)},_animateChangeExpanded:function(e){if(!i)return void(e&&e());var t=this,n=t.contentContainer,o=n.closest(".wp-full-overlay"),s,r,c;s=o.add(n),c=!t.panel||""===t.panel()||!!a.panel(t.panel()).contentContainer.hasClass("skip-transition"),c&&(s=s.add("#customize-info, .customize-pane-parent")),r=function(t){2===t.eventPhase&&$(t.target).is(n)&&(n.off(i,r),s.removeClass("busy"),e&&e())},n.on(i,r),s.addClass("busy"),_.defer(function(){var e=n.closest(".wp-full-overlay-sidebar-content"),i=e.scrollTop(),a=n.data("previous-scrollTop")||0,o=t.expanded();o&&0<i?(n.css("top",i+"px"),n.data("previous-scrollTop",i)):!o&&0<i+a&&(n.css("top",a-i+"px"),e.scrollTop(a))})},focus:n,getContainer:function(){var e,t=this;return e=0!==$("#tmpl-"+t.templateSelector).length?wp.template(t.templateSelector):wp.template("customize-"+t.containerType+"-default"),e&&t.container?$.trim(e(_.extend({id:t.id},t.params))):"<li></li>"},getContent:function(){var e=this,t=e.container,n=t.find(".accordion-section-content, .control-panel-content").first(),i="sub-"+t.attr("id"),a=i,o=t.attr("aria-owns");return o&&(a=a+" "+o),t.attr("aria-owns",a),n.detach().attr({id:i,class:"customize-pane-child "+n.attr("class")+" "+t.attr("class")})}}),a.Section=t.extend({containerType:"section",containerParent:"#customize-theme-controls",containerPaneParent:".customize-pane-parent",defaults:{title:"",description:"",priority:100,type:"default",content:null,active:!0,instanceNumber:null,panel:null,customizeAction:""},initialize:function(e,n){var i=this,o;o=n.params||n,o.type||_.find(a.sectionConstructor,function(e,t){return e===i.constructor&&(o.type=t,!0)}),t.prototype.initialize.call(i,e,o),i.id=e,i.panel=new a.Value,i.panel.bind(function(e){$(i.headContainer).toggleClass("control-subsection",!!e)}),i.panel.set(i.params.panel||""),a.utils.bubbleChildValueChanges(i,["panel"]),i.embed(),i.deferred.embedded.done(function(){i.ready()})},embed:function(){var e,t=this;t.containerParent=a.ensure(t.containerParent),e=function(e){var n;e?a.panel(e,function(e){e.deferred.embedded.done(function(){n=e.contentContainer,t.headContainer.parent().is(n)||n.append(t.headContainer),t.contentContainer.parent().is(t.headContainer)||t.containerParent.append(t.contentContainer),t.deferred.embedded.resolve()})}):(n=a.ensure(t.containerPaneParent),t.headContainer.parent().is(n)||n.append(t.headContainer),t.contentContainer.parent().is(t.headContainer)||t.containerParent.append(t.contentContainer),t.deferred.embedded.resolve())},t.panel.bind(e),e(t.panel.get())},attachEvents:function(){var e,t,n=this;n.container.hasClass("cannot-expand")||(n.container.find(".accordion-section-title, .customize-section-back").on("click keydown",function(e){a.utils.isKeydownButNotEnterEvent(e)||(e.preventDefault(),n.expanded()?n.collapse():n.expand())}),n.container.find(".customize-section-title .customize-help-toggle").on("click",function(){e=n.container.find(".section-meta"),e.hasClass("cannot-expand")||(t=e.find(".customize-section-description:first"),t.toggleClass("open"),t.slideToggle(n.defaultExpandedArguments.duration,function(){t.trigger("toggled")}),$(this).attr("aria-expanded",function(e,t){return"true"===t?"false":"true"}))}))},isContextuallyActive:function(){var e=this,t=e.controls(),n=0;return _(t).each(function(e){e.active()&&(n+=1)}),0!==n},controls:function(){return this._children("section","control")},onChangeExpanded:function(e,t){var n=this,i=n.headContainer.closest(".wp-full-overlay-sidebar-content"),o=n.contentContainer,s=n.headContainer.closest(".wp-full-overlay"),r=o.find(".customize-section-back"),c=n.headContainer.find(".accordion-section-title").first(),l,d;e&&!o.hasClass("open")?(l=t.unchanged?t.completeCallback:$.proxy(function(){n._animateChangeExpanded(function(){c.attr("tabindex","-1"),r.attr("tabindex","0"),r.focus(),o.css("top",""),i.scrollTop(0),t.completeCallback&&t.completeCallback()}),o.addClass("open"),s.addClass("section-open"),a.state("expandedSection").set(n)},this),t.allowMultiple||a.section.each(function(e){e!==n&&e.collapse({duration:t.duration})}),n.panel()?a.panel(n.panel()).expand({duration:t.duration,completeCallback:l}):(t.allowMultiple||a.panel.each(function(e){e.collapse()}),l())):!e&&o.hasClass("open")?(n.panel()&&(d=a.panel(n.panel()),d.contentContainer.hasClass("skip-transition")&&d.collapse()),n._animateChangeExpanded(function(){r.attr("tabindex","-1"),c.attr("tabindex","0"),c.focus(),o.css("top",""),t.completeCallback&&t.completeCallback()}),o.removeClass("open"),s.removeClass("section-open"),n===a.state("expandedSection").get()&&a.state("expandedSection").set(!1)):t.completeCallback&&t.completeCallback()}}),a.ThemesSection=a.Section.extend({currentTheme:"",overlay:"",template:"",screenshotQueue:null,$window:null,$body:null,loaded:0,loading:!1,fullyLoaded:!1,term:"",tags:"",nextTerm:"",nextTags:"",filtersHeight:0,headerContainer:null,updateCountDebounced:null,initialize:function(e,t){var n=this;n.headerContainer=$(),n.$window=$(window),n.$body=$(document.body),a.Section.prototype.initialize.call(n,e,t),n.updateCountDebounced=_.debounce(n.updateCount,500)},embed:function(){var e,t=this;e=function(e){var n;a.panel(e,function(e){e.deferred.embedded.done(function(){n=e.contentContainer,t.headContainer.parent().is(n)||n.find(".customize-themes-full-container-container").before(t.headContainer),t.contentContainer.parent().is(t.headContainer)||t.containerParent.append(t.contentContainer),t.deferred.embedded.resolve()})})},t.panel.bind(e),e(t.panel.get())},ready:function(){var e=this;e.overlay=e.container.find(".theme-overlay"),e.template=wp.template("customize-themes-details-view"),e.container.on("keydown",function(t){e.overlay.find(".theme-wrap").is(":visible")&&(39===t.keyCode&&e.nextTheme(),37===t.keyCode&&e.previousTheme(),27===t.keyCode&&(e.$body.hasClass("modal-open")?e.closeDetails():e.headerContainer.find(".customize-themes-section-title").focus(),t.stopPropagation()))}),e.renderScreenshots=_.throttle(e.renderScreenshots,100),_.bindAll(e,"renderScreenshots","loadMore","checkTerm","filtersChecked")},isContextuallyActive:function(){return this.active()},attachEvents:function(){function e(){var e=t.headerContainer.find(".customize-themes-section-title");e.toggleClass("selected",t.expanded()),e.attr("aria-expanded",t.expanded()?"true":"false"),t.expanded()||e.removeClass("details-open")}var t=this,n;t.container.find(".customize-section-back").on("click keydown",function(e){a.utils.isKeydownButNotEnterEvent(e)||(e.preventDefault(),t.collapse())}),t.headerContainer=$("#accordion-section-"+t.id),t.headerContainer.on("click",".customize-themes-section-title",function(){t.headerContainer.find(".filter-details").length&&(t.headerContainer.find(".customize-themes-section-title").toggleClass("details-open").attr("aria-expanded",function(e,t){return"true"===t?"false":"true"}),t.headerContainer.find(".filter-details").slideToggle(180)),t.expanded()||t.expand()}),t.container.on("click",".theme-actions .preview-theme",function(){a.panel("themes").loadThemePreview($(this).data("slug"))}),t.container.on("click",".left",function(){t.previousTheme()}),t.container.on("click",".right",function(){t.nextTheme()}),t.container.on("click",".theme-backdrop, .close",function(){t.closeDetails()}),"local"===t.params.filter_type?t.container.on("input",".wp-filter-search-themes",function(e){t.filterSearch(e.currentTarget.value)}):"remote"===t.params.filter_type&&(n=_.debounce(t.checkTerm,500),t.contentContainer.on("input",".wp-filter-search",function(){a.panel("themes").expanded()&&(n(t),t.expanded()||t.expand())}),t.contentContainer.on("click",".filter-group input",function(){t.filtersChecked(),t.checkTerm(t)})),t.contentContainer.on("click",".feature-filter-toggle",function(e){var n=$(".customize-themes-full-container"),i=$(e.currentTarget);if(t.filtersHeight=i.parent().next(".filter-drawer").height(),!(0<n.scrollTop()&&(n.animate({scrollTop:0},400),i.hasClass("open"))))if(i.toggleClass("open").attr("aria-expanded",function(e,t){return"true"===t?"false":"true"}).parent().next(".filter-drawer").slideToggle(180,"linear"),i.hasClass("open")){var a=1018<window.innerWidth?50:76;t.contentContainer.find(".themes").css("margin-top",t.filtersHeight+a)}else t.contentContainer.find(".themes").css("margin-top",0)}),t.contentContainer.on("click",".no-themes-local .search-dotorg-themes",function(){a.section("wporg_themes").focus()}),t.expanded.bind(e),e(),a.bind("ready",function(){t.contentContainer=t.container.find(".customize-themes-section"),t.contentContainer.appendTo($(".customize-themes-full-container")),t.container.add(t.headerContainer)})},onChangeExpanded:function(e,t){function n(){0===i.loaded&&i.loadThemes(),a.section.each(function(e){var n;e!==i&&"themes"===e.params.type&&(n=e.contentContainer.find(".wp-filter-search").val(),i.contentContainer.find(".wp-filter-search").val(n),""===n&&""!==i.term&&"local"!==i.params.filter_type?(i.term="",i.initializeNewQuery(i.term,i.tags)):"remote"===i.params.filter_type?i.checkTerm(i):"local"===i.params.filter_type&&i.filterSearch(n),e.collapse({duration:t.duration}))}),i.contentContainer.addClass("current-section"),o.scrollTop(),o.on("scroll",_.throttle(i.renderScreenshots,300)),o.on("scroll",_.throttle(i.loadMore,300)),t.completeCallback&&t.completeCallback(),i.updateCount()}var i=this,o=i.contentContainer.closest(".customize-themes-full-container");if(t.unchanged)return void(t.completeCallback&&t.completeCallback());e?i.panel()&&a.panel.has(i.panel())?a.panel(i.panel()).expand({duration:t.duration,completeCallback:n}):n():(i.contentContainer.removeClass("current-section"),i.headerContainer.find(".filter-details").slideUp(180),o.off("scroll"),t.completeCallback&&t.completeCallback())},getContent:function(){return this.container.find(".control-section-content")},loadThemes:function(){var e=this,t,n,i;e.loading||(n=Math.ceil(e.loaded/100)+1,t={nonce:a.settings.nonce.switch_themes,wp_customize:"on",theme_action:e.params.action,customized_theme:a.settings.theme.stylesheet,page:n},"remote"===e.params.filter_type&&(t.search=e.term,t.tags=e.tags),e.headContainer.closest(".wp-full-overlay").addClass("loading"),e.loading=!0,e.container.find(".no-themes").hide(),i=wp.ajax.post("customize_load_themes",t),i.done(function(t){var i=t.themes;if(""!==e.nextTerm||""!==e.nextTags)return e.nextTerm&&(e.term=e.nextTerm),e.nextTags&&(e.tags=e.nextTags),e.nextTerm="",e.nextTags="",e.loading=!1,void e.loadThemes();0!==i.length?(e.loadControls(i,n),1===n&&(_.each(e.controls().slice(0,3),function(e){var t,n=e.params.theme.screenshot[0];n&&(t=new Image,t.src=n)}),"local"!==e.params.filter_type&&wp.a11y.speak(a.settings.l10n.themeSearchResults.replace("%d",t.info.results))),_.delay(e.renderScreenshots,100),("local"===e.params.filter_type||100>i.length)&&(e.fullyLoaded=!0)):0===e.loaded?(e.container.find(".no-themes").show(),wp.a11y.speak(e.container.find(".no-themes").text())):e.fullyLoaded=!0,"local"===e.params.filter_type?e.updateCount():e.updateCount(t.info.results),e.container.find(".unexpected-error").hide(),e.headContainer.closest(".wp-full-overlay").removeClass("loading"),e.loading=!1}),i.fail(function(t){void 0===t?(e.container.find(".unexpected-error").show(),wp.a11y.speak(e.container.find(".unexpected-error").text())):"undefined"!=typeof console&&console.error&&console.error(t),e.headContainer.closest(".wp-full-overlay").removeClass("loading"),e.loading=!1}))},loadControls:function(e,t){var n=[],i=this;_.each(e,function(e){var t=new a.controlConstructor.theme(i.params.action+"_theme_"+e.id,{type:"theme",section:i.params.id,theme:e,priority:i.loaded+1});a.control.add(t),n.push(t),i.loaded=i.loaded+1}),1!==t&&Array.prototype.push.apply(i.screenshotQueue,n)},loadMore:function(){var e=this,t,n,i;e.fullyLoaded||e.loading||(t=e.container.closest(".customize-themes-full-container"),n=t.scrollTop()+t.height(),i=t.prop("scrollHeight")-3e3,n>i&&e.loadThemes())},filterSearch:function(e){var t=0,n=!1,i=this,o=a.section.has("wporg_themes")&&"remote"!==i.params.filter_type?".no-themes-local":".no-themes",s=i.controls(),r;i.loading||(r=e.toLowerCase().trim().replace(/-/g," ").split(" "),_.each(s,function(e){(n=e.filter(r))&&(t+=1)}),0===t?(i.container.find(o).show(),wp.a11y.speak(i.container.find(o).text())):i.container.find(o).hide(),i.renderScreenshots(),a.reflowPaneContents(),i.updateCountDebounced(t))},checkTerm:function(e){var t;"remote"===e.params.filter_type&&(t=e.contentContainer.find(".wp-filter-search").val(),e.term!==t.trim()&&e.initializeNewQuery(t,e.tags))},filtersChecked:function(){var e=this,t=e.container.find(".filter-group").find(":checkbox"),n=[];_.each(t.filter(":checked"),function(e){n.push($(e).prop("value"))}),0===n.length?(n="",e.contentContainer.find(".feature-filter-toggle .filter-count-0").show(),e.contentContainer.find(".feature-filter-toggle .filter-count-filters").hide()):(e.contentContainer.find(".feature-filter-toggle .theme-filter-count").text(n.length),e.contentContainer.find(".feature-filter-toggle .filter-count-0").hide(),e.contentContainer.find(".feature-filter-toggle .filter-count-filters").show()),_.isEqual(e.tags,n)||(e.loading?e.nextTags=n:"remote"===e.params.filter_type?e.initializeNewQuery(e.term,n):"local"===e.params.filter_type&&e.filterSearch(n.join(" ")))},initializeNewQuery:function(e,t){var n=this;_.each(n.controls(),function(e){e.container.remove(),a.control.remove(e.id)}),n.loaded=0,n.fullyLoaded=!1,n.screenshotQueue=null,n.loading?(n.nextTerm=e,n.nextTags=t):(n.term=e,n.tags=t,n.loadThemes()),n.expanded()||n.expand()},renderScreenshots:function(){var e=this;null!==e.screenshotQueue&&0!==e.screenshotQueue.length||(e.screenshotQueue=_.filter(e.controls(),function(e){return!e.screenshotRendered})),e.screenshotQueue.length&&(e.screenshotQueue=_.filter(e.screenshotQueue,function(t){var n=t.container.find(".theme-screenshot"),i=n.find("img");if(!i.length)return!1;if(i.is(":hidden"))return!0;var a=e.$window.scrollTop(),o=a+e.$window.height(),s=i.offset().top,r=n.height(),c=s+r,l=3*r,d=c>=a-l&&s<=o+l;return d&&t.container.trigger("render-screenshot"),!d}))},getVisibleCount:function(){return this.contentContainer.find("li.customize-control:visible").length},updateCount:function(e){var t=this,n,i;e||0===e||(e=t.getVisibleCount()),i=t.contentContainer.find(".themes-displayed"),n=t.contentContainer.find(".theme-count"),0===e?n.text("0"):(i.fadeOut(180,function(){n.text(e),i.fadeIn(180)}),wp.a11y.speak(a.settings.l10n.announceThemeCount.replace("%d",e)))},nextTheme:function(){var e=this;e.getNextTheme()&&e.showDetails(e.getNextTheme(),function(){e.overlay.find(".right").focus()})},getNextTheme:function(){var e=this,t,n,i,o;return t=a.control(e.params.action+"_theme_"+e.currentTheme),i=e.controls(),-1!==(o=_.indexOf(i,t))&&(!!(n=i[o+1])&&n.params.theme)},previousTheme:function(){var e=this;e.getPreviousTheme()&&e.showDetails(e.getPreviousTheme(),function(){e.overlay.find(".left").focus()})},getPreviousTheme:function(){var e=this,t,n,i,o;return t=a.control(e.params.action+"_theme_"+e.currentTheme),i=e.controls(),-1!==(o=_.indexOf(i,t))&&(!!(n=i[o-1])&&n.params.theme)},updateLimits:function(){this.getNextTheme()||this.overlay.find(".right").addClass("disabled"),this.getPreviousTheme()||this.overlay.find(".left").addClass("disabled")},loadThemePreview:function(e){return a.ThemesPanel.prototype.loadThemePreview.call(this,e)},showDetails:function(e,t){function n(){return!s.canSwitchTheme(e.id)}function i(){return n()||!1===a.settings.theme._canInstall||!0===a.settings.theme._filesystemCredentialsNeeded}var o=this,s=a.panel("themes");o.currentTheme=e.id,o.overlay.html(o.template(e)).fadeIn("fast").focus(),o.overlay.find("button.preview, button.preview-theme").toggleClass("disabled",n()),o.overlay.find("button.theme-install").toggleClass("disabled",i()),o.$body.addClass("modal-open"),o.containFocus(o.overlay),o.updateLimits(),wp.a11y.speak(a.settings.l10n.announceThemeDetails.replace("%s",e.name)),t&&t()},closeDetails:function(){var e=this;e.$body.removeClass("modal-open"),e.overlay.fadeOut("fast"),a.control(e.params.action+"_theme_"+e.currentTheme).container.find(".theme").focus()},containFocus:function(e){var t;e.on("keydown",function(n){if(9===n.keyCode)return t=$(":tabbable",e),t.last()[0]!==n.target||n.shiftKey?t.first()[0]===n.target&&n.shiftKey?(t.last().focus(),!1):void 0:(t.first().focus(),!1)})}}),a.OuterSection=a.Section.extend({initialize:function(){var e=this;e.containerParent="#customize-outer-theme-controls",e.containerPaneParent=".customize-outer-pane-parent",a.Section.prototype.initialize.apply(e,arguments)},onChangeExpanded:function(e,t){var n=this,i=n.headContainer.closest(".wp-full-overlay-sidebar-content"),o=n.contentContainer,s=o.find(".customize-section-back"),r=n.headContainer.find(".accordion-section-title").first(),c=$(document.body),l,d;c.toggleClass("outer-section-open",e),n.container.toggleClass("open",e),n.container.removeClass("busy"),a.section.each(function(e){"outer"===e.params.type&&e.id!==n.id&&e.container.removeClass("open")}),e&&!o.hasClass("open")?(l=t.unchanged?t.completeCallback:$.proxy(function(){n._animateChangeExpanded(function(){r.attr("tabindex","-1"),s.attr("tabindex","0"),s.focus(),o.css("top",""),i.scrollTop(0),t.completeCallback&&t.completeCallback()}),o.addClass("open")},this),n.panel()?a.panel(n.panel()).expand({duration:t.duration,completeCallback:l}):l()):!e&&o.hasClass("open")?(n.panel()&&(d=a.panel(n.panel()),d.contentContainer.hasClass("skip-transition")&&d.collapse()),n._animateChangeExpanded(function(){s.attr("tabindex","-1"),r.attr("tabindex","0"),r.focus(),o.css("top",""),t.completeCallback&&t.completeCallback()}),o.removeClass("open")):t.completeCallback&&t.completeCallback()}}),a.Panel=t.extend({containerType:"panel",initialize:function(e,n){var i=this,o;o=n.params||n,o.type||_.find(a.panelConstructor,function(e,t){return e===i.constructor&&(o.type=t,!0)}),t.prototype.initialize.call(i,e,o),i.embed(),i.deferred.embedded.done(function(){i.ready()})},embed:function(){var e=this,t=$("#customize-theme-controls"),n=$(".customize-pane-parent");e.headContainer.parent().is(n)||n.append(e.headContainer),e.contentContainer.parent().is(e.headContainer)||t.append(e.contentContainer),e.renderContent(),e.deferred.embedded.resolve()},attachEvents:function(){var e,t=this;t.headContainer.find(".accordion-section-title").on("click keydown",function(e){a.utils.isKeydownButNotEnterEvent(e)||(e.preventDefault(),t.expanded()||t.expand())}),t.container.find(".customize-panel-back").on("click keydown",function(e){a.utils.isKeydownButNotEnterEvent(e)||(e.preventDefault(),t.expanded()&&t.collapse())}),e=t.container.find(".panel-meta:first"),e.find("> .accordion-section-title .customize-help-toggle").on("click",function(){if(!e.hasClass("cannot-expand")){var n=e.find(".customize-panel-description:first");e.hasClass("open")?(e.toggleClass("open"),n.slideUp(t.defaultExpandedArguments.duration,function(){n.trigger("toggled")}),$(this).attr("aria-expanded",!1)):(n.slideDown(t.defaultExpandedArguments.duration,function(){n.trigger("toggled")}),e.toggleClass("open"),$(this).attr("aria-expanded",!0))}})},sections:function(){return this._children("panel","section")},isContextuallyActive:function(){var e=this,t=e.sections(),n=0;return _(t).each(function(e){e.active()&&e.isContextuallyActive()&&(n+=1)}),0!==n},onChangeExpanded:function(e,t){if(t.unchanged)return void(t.completeCallback&&t.completeCallback());var n=this,i=n.contentContainer,o=i.closest(".wp-full-overlay"),s=i.closest(".wp-full-overlay-sidebar-content"),r=n.headContainer.find(".accordion-section-title"),c=i.find(".customize-panel-back"),l=n.sections(),d;e&&!i.hasClass("current-panel")?(a.section.each(function(e){n.id!==e.panel()&&e.collapse({duration:0})}),a.panel.each(function(e){n!==e&&e.collapse({duration:0})}),
n.params.autoExpandSoleSection&&1===l.length&&l[0].active.get()?(i.addClass("current-panel skip-transition"),o.addClass("in-sub-panel"),l[0].expand({completeCallback:t.completeCallback})):(n._animateChangeExpanded(function(){r.attr("tabindex","-1"),c.attr("tabindex","0"),c.focus(),i.css("top",""),s.scrollTop(0),t.completeCallback&&t.completeCallback()}),i.addClass("current-panel"),o.addClass("in-sub-panel")),a.state("expandedPanel").set(n)):!e&&i.hasClass("current-panel")&&(d=i.hasClass("skip-transition"),d?i.removeClass("skip-transition"):n._animateChangeExpanded(function(){r.attr("tabindex","0"),c.attr("tabindex","-1"),r.focus(),i.css("top",""),t.completeCallback&&t.completeCallback()}),o.removeClass("in-sub-panel"),i.removeClass("current-panel"),n===a.state("expandedPanel").get()&&a.state("expandedPanel").set(!1))},renderContent:function(){var e,t=this;(e=0!==$("#tmpl-"+t.templateSelector+"-content").length?wp.template(t.templateSelector+"-content"):wp.template("customize-panel-default-content"))&&t.headContainer&&t.contentContainer.html(e(_.extend({id:t.id},t.params)))}}),a.ThemesPanel=a.Panel.extend({initialize:function(e,t){var n=this;n.installingThemes=[],a.Panel.prototype.initialize.call(n,e,t)},canSwitchTheme:function e(t){return!(!t||t!==a.settings.theme.stylesheet)||"publish"===a.state("selectedChangesetStatus").get()&&(""===a.state("changesetStatus").get()||"auto-draft"===a.state("changesetStatus").get())},attachEvents:function(){function e(){t.canSwitchTheme()?t.notifications.remove("theme_switch_unavailable"):t.notifications.add(new a.Notification("theme_switch_unavailable",{message:a.l10n.themePreviewUnavailable,type:"warning"}))}var t=this;a.Panel.prototype.attachEvents.apply(t),a.settings.theme._canInstall&&a.settings.theme._filesystemCredentialsNeeded&&t.notifications.add(new a.Notification("theme_install_unavailable",{message:a.l10n.themeInstallUnavailable,type:"info",dismissible:!0})),e(),a.state("selectedChangesetStatus").bind(e),a.state("changesetStatus").bind(e),t.contentContainer.on("click",".customize-theme",function(){t.collapse()}),t.contentContainer.on("click",".customize-themes-section-title, .customize-themes-mobile-back",function(){$(".wp-full-overlay").toggleClass("showing-themes")}),t.contentContainer.on("click",".theme-install",function(e){t.installTheme(e)}),t.contentContainer.on("click",".update-theme, #update-theme",function(e){e.preventDefault(),e.stopPropagation(),t.updateTheme(e)}),t.contentContainer.on("click",".delete-theme",function(e){t.deleteTheme(e)}),_.bindAll(t,"installTheme","updateTheme")},onChangeExpanded:function(e,t){var n=this,i,o,s=!1;if(a.Panel.prototype.onChangeExpanded.apply(this,[e,t]),t.unchanged)return void(t.completeCallback&&t.completeCallback());i=n.headContainer.closest(".wp-full-overlay"),e?(i.addClass("in-themes-panel").delay(200).find(".customize-themes-full-container").addClass("animate"),_.delay(function(){i.addClass("themes-panel-expanded")},200),600<window.innerWidth&&(o=n.sections(),_.each(o,function(e){e.expanded()&&(s=!0)}),!s&&o.length>0&&o[0].expand())):i.removeClass("in-themes-panel themes-panel-expanded").find(".customize-themes-full-container").removeClass("animate")},installTheme:function(e){var t=this,n,i,o=$(e.target).data("slug"),s=$.Deferred(),r;return n=$(e.target).hasClass("preview"),a.settings.theme._filesystemCredentialsNeeded?(s.reject({errorCode:"theme_install_unavailable"}),s.promise()):t.canSwitchTheme(o)?_.contains(t.installingThemes,o)?(s.reject({errorCode:"theme_already_installing"}),s.promise()):(wp.updates.maybeRequestFilesystemCredentials(e),i=function(e){var i=!1,r;if(n)a.notifications.remove("theme_installing"),t.loadThemePreview(o);else{if(a.control.each(function(t){"theme"===t.params.type&&t.params.theme.id===e.slug&&(i=t.params.theme,t.rerenderAsInstalled(!0))}),!i||a.control.has("installed_theme_"+i.id))return void s.resolve(e);i.type="installed",r=new a.controlConstructor.theme("installed_theme_"+i.id,{type:"theme",section:"installed_themes",theme:i,priority:0}),a.control.add(r),a.control(r.id).container.trigger("render-screenshot"),a.section.each(function(e){"themes"===e.params.type&&i.id===e.currentTheme&&e.closeDetails()})}s.resolve(e)},t.installingThemes.push(o),r=wp.updates.installTheme({slug:o}),n&&a.notifications.add(new a.OverlayNotification("theme_installing",{message:a.l10n.themeDownloading,type:"info",loading:!0})),r.done(i),r.fail(function(){a.notifications.remove("theme_installing")}),s.promise()):(s.reject({errorCode:"theme_switch_unavailable"}),s.promise())},loadThemePreview:function(e){var t=this,n=$.Deferred(),i,o,s;return t.canSwitchTheme(e)?(o=document.createElement("a"),o.href=location.href,s=_.extend(a.utils.parseQueryString(o.search.substr(1)),{theme:e,changeset_uuid:a.settings.changeset.uuid,return:a.settings.url.return}),a.state("saved").get()||(s.customize_autosaved="on"),o.search=$.param(s),a.notifications.add(new a.OverlayNotification("theme_previewing",{message:a.l10n.themePreviewWait,type:"info",loading:!0})),i=function(){var e;a.state("processing").get()>0||(a.state("processing").unbind(i),e=a.requestChangesetUpdate({},{autosave:!0}),e.done(function(){n.resolve(),$(window).off("beforeunload.customize-confirm"),location.replace(o.href)}),e.fail(function(){a.notifications.remove("theme_previewing"),n.reject()}))},0===a.state("processing").get()?i():a.state("processing").bind(i),n.promise()):(n.reject({errorCode:"theme_switch_unavailable"}),n.promise())},updateTheme:function(e){wp.updates.maybeRequestFilesystemCredentials(e),$(document).one("wp-theme-update-success",function(e,t){a.control.each(function(e){"theme"===e.params.type&&e.params.theme.id===t.slug&&(e.params.theme.hasUpdate=!1,e.params.theme.version=t.newVersion,setTimeout(function(){e.rerenderAsInstalled(!0)},2e3))})}),wp.updates.updateTheme({slug:$(e.target).closest(".notice").data("slug")})},deleteTheme:function(e){var t,n;t=$(e.target).data("slug"),n=a.section("installed_themes"),e.preventDefault(),a.settings.theme._filesystemCredentialsNeeded||window.confirm(a.settings.l10n.confirmDeleteTheme)&&(wp.updates.maybeRequestFilesystemCredentials(e),$(document).one("wp-theme-delete-success",function(){var e=a.control("installed_theme_"+t);e.container.remove(),a.control.remove(e.id),n.loaded=n.loaded-1,n.updateCount(),a.control.each(function(e){"theme"===e.params.type&&e.params.theme.id===t&&e.rerenderAsInstalled(!1)})}),wp.updates.deleteTheme({slug:t}),n.closeDetails(),n.focus())}}),a.Control=a.Class.extend({defaultActiveArguments:{duration:"fast",completeCallback:$.noop},defaults:{label:"",description:"",active:!0,priority:10},initialize:function(e,t){var n=this,i=[],o,s;n.params=_.extend({},n.defaults,n.params||{},t.params||t||{}),a.Control.instanceCounter||(a.Control.instanceCounter=0),a.Control.instanceCounter++,n.params.instanceNumber||(n.params.instanceNumber=a.Control.instanceCounter),n.params.type||_.find(a.controlConstructor,function(e,t){return e===n.constructor&&(n.params.type=t,!0)}),n.params.content||(n.params.content=$("<li></li>",{id:"customize-control-"+e.replace(/]/g,"").replace(/\[/g,"-"),class:"customize-control customize-control-"+n.params.type})),n.id=e,n.selector="#customize-control-"+e.replace(/\]/g,"").replace(/\[/g,"-"),n.params.content?n.container=$(n.params.content):n.container=$(n.selector),n.params.templateId?n.templateSelector=n.params.templateId:n.templateSelector="customize-control-"+n.params.type+"-content",n.deferred=_.extend(n.deferred||{},{embedded:new $.Deferred}),n.section=new a.Value,n.priority=new a.Value,n.active=new a.Value,n.activeArgumentsQueue=[],n.notifications=new a.Notifications({alt:n.altNotice}),n.elements=[],n.active.bind(function(e){var t=n.activeArgumentsQueue.shift();t=$.extend({},n.defaultActiveArguments,t),n.onChangeActive(e,t)}),n.section.set(n.params.section),n.priority.set(isNaN(n.params.priority)?10:n.params.priority),n.active.set(n.params.active),a.utils.bubbleChildValueChanges(n,["section","priority","active"]),n.settings={},o={},n.params.setting&&(o.default=n.params.setting),_.extend(o,n.params.settings),_.each(o,function(e,t){var o;_.isObject(e)&&_.isFunction(e.extended)&&e.extended(a.Value)?n.settings[t]=e:_.isString(e)&&(o=a(e),o?n.settings[t]=o:i.push(e))}),s=function(){_.each(o,function(e,t){!n.settings[t]&&_.isString(e)&&(n.settings[t]=a(e))}),n.settings[0]&&!n.settings.default&&(n.settings.default=n.settings[0]),n.setting=n.settings.default||null,n.linkElements(),n.embed()},0===i.length?s():a.apply(a,i.concat(s)),n.deferred.embedded.done(function(){n.linkElements(),n.setupNotifications(),n.ready()})},linkElements:function(){var e=this,t,n,i;t=e.container.find("[data-customize-setting-link], [data-customize-setting-key-link]"),n={},t.each(function(){var o=$(this),s,r;if(!o.data("customizeSettingLinked")){if(o.data("customizeSettingLinked",!0),o.is(":radio")){if(s=o.prop("name"),n[s])return;n[s]=!0,o=t.filter('[name="'+s+'"]')}o.data("customizeSettingLink")?r=a(o.data("customizeSettingLink")):o.data("customizeSettingKeyLink")&&(r=e.settings[o.data("customizeSettingKeyLink")]),r&&(i=new a.Element(o),e.elements.push(i),i.sync(r),i.set(r()))}})},embed:function(){var e=this,t;t=function(t){var n;t&&a.section(t,function(t){t.deferred.embedded.done(function(){n=t.contentContainer.is("ul")?t.contentContainer:t.contentContainer.find("ul:first"),e.container.parent().is(n)||(n.append(e.container),e.renderContent()),e.deferred.embedded.resolve()})})},e.section.bind(t),t(e.section.get())},ready:function(){var e=this,t;"dropdown-pages"===e.params.type&&e.params.allow_addition&&(t=e.container.find(".new-content-item"),t.hide(),e.container.on("click",".add-new-toggle",function(e){$(e.currentTarget).slideUp(180),t.slideDown(180),t.find(".create-item-input").focus()}),e.container.on("click",".add-content",function(){e.addNewPage()}),e.container.on("keydown",".create-item-input",function(t){13===t.which&&e.addNewPage()}))},getNotificationsContainerElement:function(){var e=this,t,n;return n=e.container.find(".customize-control-notifications-container:first"),n.length?n:(n=$('<div class="customize-control-notifications-container"></div>'),e.container.hasClass("customize-control-nav_menu_item")?e.container.find(".menu-item-settings:first").prepend(n):e.container.hasClass("customize-control-widget_form")?e.container.find(".widget-inside:first").prepend(n):(t=e.container.find(".customize-control-title"),t.length?t.after(n):e.container.prepend(n)),n)},setupNotifications:function(){var e=this,t,n;_.each(e.settings,function(t){t.notifications&&(t.notifications.bind("add",function(n){var i=_.extend({},n,{setting:t.id});e.notifications.add(new a.Notification(t.id+":"+n.code,i))}),t.notifications.bind("remove",function(n){e.notifications.remove(t.id+":"+n.code)}))}),t=function(){var t=e.section();(!t||a.section.has(t)&&a.section(t).expanded())&&e.notifications.render()},e.notifications.bind("rendered",function(){var t=e.notifications.get();e.container.toggleClass("has-notifications",0!==t.length),e.container.toggleClass("has-error",0!==_.where(t,{type:"error"}).length)}),n=function(e,n){n&&a.section.has(n)&&a.section(n).expanded.unbind(t),e&&a.section(e,function(e){e.expanded.bind(t),t()})},e.section.bind(n),n(e.section.get()),e.notifications.bind("change",_.debounce(t))},renderNotifications:function(){var e=this,t,n,i=!1;"undefined"!=typeof console&&console.warn&&console.warn("[DEPRECATED] wp.customize.Control.prototype.renderNotifications() is deprecated in favor of instantating a wp.customize.Notifications and calling its render() method."),(t=e.getNotificationsContainerElement())&&t.length&&(n=[],e.notifications.each(function(e){n.push(e),"error"===e.type&&(i=!0)}),0===n.length?t.stop().slideUp("fast"):t.stop().slideDown("fast",null,function(){$(this).css("height","auto")}),e.notificationsTemplate||(e.notificationsTemplate=wp.template("customize-control-notifications")),e.container.toggleClass("has-notifications",0!==n.length),e.container.toggleClass("has-error",i),t.empty().append($.trim(e.notificationsTemplate({notifications:n,altNotice:Boolean(e.altNotice)}))))},expand:function(e){a.section(this.section()).expand(e)},focus:n,onChangeActive:function(e,t){if(t.unchanged)return void(t.completeCallback&&t.completeCallback());$.contains(document,this.container[0])?e?this.container.slideDown(t.duration,t.completeCallback):this.container.slideUp(t.duration,t.completeCallback):(this.container.toggle(e),t.completeCallback&&t.completeCallback())},toggle:function(e){return this.onChangeActive(e,this.defaultActiveArguments)},activate:t.prototype.activate,deactivate:t.prototype.deactivate,_toggleActive:t.prototype._toggleActive,dropdownInit:function(){var e=this,t=this.container.find(".dropdown-status"),n=this.params,i=!1,o=function(e){"string"==typeof e&&n.statuses&&n.statuses[e]?t.html(n.statuses[e]).show():t.hide()};this.container.on("click keydown",".dropdown",function(t){a.utils.isKeydownButNotEnterEvent(t)||(t.preventDefault(),i||e.container.toggleClass("open"),e.container.hasClass("open")&&e.container.parent().parent().find("li.library-selected").focus(),i=!0,setTimeout(function(){i=!1},400))}),this.setting.bind(o),o(this.setting())},renderContent:function(){var e=this,t,n,i,o;n=["button","checkbox","date","datetime-local","email","month","number","password","radio","range","search","select","tel","time","text","textarea","week","url"],i=e.templateSelector,i==="customize-control-"+e.params.type+"-content"&&_.contains(n,e.params.type)&&!document.getElementById("tmpl-"+i)&&0===e.container.children().length&&(i="customize-control-default-content"),document.getElementById("tmpl-"+i)&&(t=wp.template(i))&&e.container&&e.container.html(t(e.params)),e.notifications.container=e.getNotificationsContainerElement(),(!(o=e.section())||a.section.has(o)&&a.section(o).expanded())&&e.notifications.render()},addNewPage:function(){var e=this,t,n,i,o,s,r;if("dropdown-pages"===e.params.type&&e.params.allow_addition&&a.Menus){if(n=e.container.find(".add-new-toggle"),i=e.container.find(".new-content-item"),o=e.container.find(".create-item-input"),s=o.val(),r=e.container.find("select"),!s)return void o.addClass("invalid");o.removeClass("invalid"),o.attr("disabled","disabled"),t=a.Menus.insertAutoDraftPost({post_title:s,post_type:"page"}),t.done(function(t){var o,c,l;o=new a.Menus.AvailableItemModel({id:"post-"+t.post_id,title:s,type:"post_type",type_label:a.Menus.data.l10n.page_label,object:"page",object_id:t.post_id,url:t.url}),a.Menus.availableMenuItemsPanel.collection.add(o),c=$("#available-menu-items-post_type-page").find(".available-menu-items-list"),l=wp.template("available-menu-item"),c.prepend(l(o.attributes)),r.focus(),e.setting.set(String(t.post_id)),i.slideUp(180),n.slideDown(180)}),t.always(function(){o.val("").removeAttr("disabled")})}}}),a.ColorControl=a.Control.extend({ready:function(){var e=this,t="hue"===this.params.mode,n=!1,i;t?(i=this.container.find(".color-picker-hue"),i.val(e.setting()).wpColorPicker({change:function(t,i){n=!0,e.setting(i.color.h()),n=!1}})):(i=this.container.find(".color-picker-hex"),i.val(e.setting()).wpColorPicker({change:function(){n=!0,e.setting.set(i.wpColorPicker("color")),n=!1},clear:function(){n=!0,e.setting.set(""),n=!1}})),e.setting.bind(function(e){n||(i.val(e),i.wpColorPicker("color",e))}),e.container.on("keydown",function(t){var n;27===t.which&&(n=e.container.find(".wp-picker-container"),n.hasClass("wp-picker-active")&&(i.wpColorPicker("close"),e.container.find(".wp-color-result").focus(),t.stopPropagation()))})}}),a.MediaControl=a.Control.extend({ready:function(){function e(e){var n=$.Deferred();t.extended(a.UploadControl)?n.resolve():(e=parseInt(e,10),_.isNaN(e)||e<=0?(delete t.params.attachment,n.resolve()):t.params.attachment&&t.params.attachment.id===e&&n.resolve()),"pending"===n.state()&&wp.media.attachment(e).fetch().done(function(){t.params.attachment=this.attributes,n.resolve(),wp.customize.previewer.send(t.setting.id+"-attachment-data",this.attributes)}),n.done(function(){t.renderContent()})}var t=this;_.bindAll(t,"restoreDefault","removeFile","openFrame","select","pausePlayer"),t.container.on("click keydown",".upload-button",t.openFrame),t.container.on("click keydown",".upload-button",t.pausePlayer),t.container.on("click keydown",".thumbnail-image img",t.openFrame),t.container.on("click keydown",".default-button",t.restoreDefault),t.container.on("click keydown",".remove-button",t.pausePlayer),t.container.on("click keydown",".remove-button",t.removeFile),t.container.on("click keydown",".remove-button",t.cleanupPlayer),a.section(t.section()).container.on("expanded",function(){t.player&&t.player.setControlsSize()}).on("collapsed",function(){t.pausePlayer()}),e(t.setting()),t.setting.bind(e)},pausePlayer:function(){this.player&&this.player.pause()},cleanupPlayer:function(){this.player&&wp.media.mixin.removePlayer(this.player)},openFrame:function(e){a.utils.isKeydownButNotEnterEvent(e)||(e.preventDefault(),this.frame||this.initFrame(),this.frame.open())},initFrame:function(){this.frame=wp.media({button:{text:this.params.button_labels.frame_button},states:[new wp.media.controller.Library({title:this.params.button_labels.frame_title,library:wp.media.query({type:this.params.mime_type}),multiple:!1,date:!1})]}),this.frame.on("select",this.select)},select:function(){var e,t=this.frame.state().get("selection").first().toJSON(),n=window._wpmejsSettings||{};this.params.attachment=t,this.setting(t.id),e=this.container.find("audio, video").get(0),e?this.player=new MediaElementPlayer(e,n):this.cleanupPlayer()},restoreDefault:function(e){a.utils.isKeydownButNotEnterEvent(e)||(e.preventDefault(),this.params.attachment=this.params.defaultAttachment,this.setting(this.params.defaultAttachment.url))},removeFile:function(e){a.utils.isKeydownButNotEnterEvent(e)||(e.preventDefault(),this.params.attachment={},this.setting(""),this.renderContent())}}),a.UploadControl=a.MediaControl.extend({select:function(){var e,t=this.frame.state().get("selection").first().toJSON(),n=window._wpmejsSettings||{};this.params.attachment=t,this.setting(t.url),e=this.container.find("audio, video").get(0),e?this.player=new MediaElementPlayer(e,n):this.cleanupPlayer()},success:function(){},removerVisibility:function(){}}),a.ImageControl=a.UploadControl.extend({thumbnailSrc:function(){}}),a.BackgroundControl=a.UploadControl.extend({ready:function(){a.UploadControl.prototype.ready.apply(this,arguments)},select:function(){a.UploadControl.prototype.select.apply(this,arguments),wp.ajax.post("custom-background-add",{nonce:_wpCustomizeBackground.nonces.add,wp_customize:"on",customize_theme:a.settings.theme.stylesheet,attachment_id:this.params.attachment.id})}}),a.BackgroundPositionControl=a.Control.extend({ready:function(){var e=this,t;e.container.on("change",'input[name="background-position"]',function(){var t=$(this).val().split(" ");e.settings.x(t[0]),e.settings.y(t[1])}),t=_.debounce(function(){var t,n,i,a;t=e.settings.x.get(),n=e.settings.y.get(),a=String(t)+" "+String(n),i=e.container.find('input[name="background-position"][value="'+a+'"]'),i.click()}),e.settings.x.bind(t),e.settings.y.bind(t),t()}}),a.CroppedImageControl=a.MediaControl.extend({openFrame:function(e){a.utils.isKeydownButNotEnterEvent(e)||(this.initFrame(),this.frame.setState("library").open())},initFrame:function(){var e=_wpMediaViewsL10n;this.frame=wp.media({button:{text:e.select,close:!1},states:[new wp.media.controller.Library({title:this.params.button_labels.frame_title,library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:this.params.width,suggestedHeight:this.params.height}),new wp.media.controller.CustomizeImageCropper({imgSelectOptions:this.calculateImageSelectOptions,control:this})]}),this.frame.on("select",this.onSelect,this),this.frame.on("cropped",this.onCropped,this),this.frame.on("skippedcrop",this.onSkippedCrop,this)},onSelect:function(){var e=this.frame.state().get("selection").first().toJSON();this.params.width!==e.width||this.params.height!==e.height||this.params.flex_width||this.params.flex_height?this.frame.setState("cropper"):(this.setImageFromAttachment(e),this.frame.close())},onCropped:function(e){this.setImageFromAttachment(e)},calculateImageSelectOptions:function(e,t){var n=t.get("control"),i=!!parseInt(n.params.flex_width,10),a=!!parseInt(n.params.flex_height,10),o=e.get("width"),s=e.get("height"),r=parseInt(n.params.width,10),c=parseInt(n.params.height,10),l=r/c,d=r,u=c,p,h,f;return t.set("canSkipCrop",!n.mustBeCropped(i,a,r,c,o,s)),o/s>l?(c=s,r=c*l):(r=o,c=r/l),p=(o-r)/2,h=(s-c)/2,f={handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:o,imageHeight:s,minWidth:d>r?r:d,minHeight:u>c?c:u,x1:p,y1:h,x2:r+p,y2:c+h},!1===a&&!1===i&&(f.aspectRatio=r+":"+c),!0===a&&(delete f.minHeight,f.maxWidth=o),!0===i&&(delete f.minWidth,f.maxHeight=s),f},mustBeCropped:function(e,t,n,i,a,o){return(!0!==e||!0!==t)&&((!0!==e||i!==o)&&((!0!==t||n!==a)&&((n!==a||i!==o)&&!(a<=n))))},onSkippedCrop:function(){var e=this.frame.state().get("selection").first().toJSON();this.setImageFromAttachment(e)},setImageFromAttachment:function(e){this.params.attachment=e,this.setting(e.id)}}),a.SiteIconControl=a.CroppedImageControl.extend({initFrame:function(){var e=_wpMediaViewsL10n;this.frame=wp.media({button:{text:e.select,close:!1},states:[new wp.media.controller.Library({title:this.params.button_labels.frame_title,library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:this.params.width,suggestedHeight:this.params.height}),new wp.media.controller.SiteIconCropper({imgSelectOptions:this.calculateImageSelectOptions,control:this})]}),this.frame.on("select",this.onSelect,this),this.frame.on("cropped",this.onCropped,this),this.frame.on("skippedcrop",this.onSkippedCrop,this)},onSelect:function(){var e=this.frame.state().get("selection").first().toJSON(),t=this;this.params.width!==e.width||this.params.height!==e.height||this.params.flex_width||this.params.flex_height?this.frame.setState("cropper"):wp.ajax.post("crop-image",{nonce:e.nonces.edit,id:e.id,context:"site-icon",cropDetails:{x1:0,y1:0,width:this.params.width,height:this.params.height,dst_width:this.params.width,dst_height:this.params.height}}).done(function(e){t.setImageFromAttachment(e),t.frame.close()}).fail(function(){t.frame.trigger("content:error:crop")})},setImageFromAttachment:function(e){var t=["site_icon-32","thumbnail","full"],n,i;_.each(t,function(t){i||_.isUndefined(e.sizes[t])||(i=e.sizes[t])}),this.params.attachment=e,this.setting(e.id),i&&(n=$('link[rel="icon"][sizes="32x32"]'),n.attr("href",i.url))},removeFile:function(e){a.utils.isKeydownButNotEnterEvent(e)||(e.preventDefault(),this.params.attachment={},this.setting(""),this.renderContent(),$('link[rel="icon"][sizes="32x32"]').attr("href","/favicon.ico"))}}),a.HeaderControl=a.Control.extend({ready:function(){this.btnRemove=$("#customize-control-header_image .actions .remove"),this.btnNew=$("#customize-control-header_image .actions .new"),_.bindAll(this,"openMedia","removeImage"),this.btnNew.on("click",this.openMedia),this.btnRemove.on("click",this.removeImage),a.HeaderTool.currentHeader=this.getInitialHeaderImage(),new a.HeaderTool.CurrentView({model:a.HeaderTool.currentHeader,el:"#customize-control-header_image .current .container"}),new a.HeaderTool.ChoiceListView({collection:a.HeaderTool.UploadsList=new a.HeaderTool.ChoiceList,el:"#customize-control-header_image .choices .uploaded .list"}),new a.HeaderTool.ChoiceListView({collection:a.HeaderTool.DefaultsList=new a.HeaderTool.DefaultsList,el:"#customize-control-header_image .choices .default .list"}),a.HeaderTool.combinedList=a.HeaderTool.CombinedList=new a.HeaderTool.CombinedList([a.HeaderTool.UploadsList,a.HeaderTool.DefaultsList]),wp.media.controller.Cropper.prototype.defaults.doCropArgs.wp_customize="on",wp.media.controller.Cropper.prototype.defaults.doCropArgs.customize_theme=a.settings.theme.stylesheet},getInitialHeaderImage:function(){if(!a.get().header_image||!a.get().header_image_data||_.contains(["remove-header","random-default-image","random-uploaded-image"],a.get().header_image))return new a.HeaderTool.ImageModel;var e=_.find(_wpCustomizeHeader.uploads,function(e){return e.attachment_id===a.get().header_image_data.attachment_id});return e||(e={url:a.get().header_image,thumbnail_url:a.get().header_image,attachment_id:a.get().header_image_data.attachment_id}),new a.HeaderTool.ImageModel({header:e,choice:e.url.split("/").pop()})},calculateImageSelectOptions:function(e,t){var n=parseInt(_wpCustomizeHeader.data.width,10),i=parseInt(_wpCustomizeHeader.data.height,10),o=!!parseInt(_wpCustomizeHeader.data["flex-width"],10),s=!!parseInt(_wpCustomizeHeader.data["flex-height"],10),r,c,l,d,u,p;return u=e.get("width"),d=e.get("height"),this.headerImage=new a.HeaderTool.ImageModel,this.headerImage.set({themeWidth:n,themeHeight:i,themeFlexWidth:o,themeFlexHeight:s,imageWidth:u,imageHeight:d}),t.set("canSkipCrop",!this.headerImage.shouldBeCropped()),r=n/i,c=u,l=d,c/l>r?(i=l,n=i*r):(n=c,i=n/r),p={handles:!0,keys:!0,instance:!0,persistent:!0,imageWidth:u,imageHeight:d,x1:0,y1:0,x2:n,y2:i},!1===s&&!1===o&&(p.aspectRatio=n+":"+i),!1===s&&(p.maxHeight=i),!1===o&&(p.maxWidth=n),p},openMedia:function(e){var t=_wpMediaViewsL10n;e.preventDefault(),this.frame=wp.media({button:{text:t.selectAndCrop,close:!1},states:[new wp.media.controller.Library({title:t.chooseImage,library:wp.media.query({type:"image"}),multiple:!1,date:!1,priority:20,suggestedWidth:_wpCustomizeHeader.data.width,suggestedHeight:_wpCustomizeHeader.data.height}),new wp.media.controller.Cropper({imgSelectOptions:this.calculateImageSelectOptions})]}),this.frame.on("select",this.onSelect,this),this.frame.on("cropped",this.onCropped,this),this.frame.on("skippedcrop",this.onSkippedCrop,this),this.frame.open()},onSelect:function(){this.frame.setState("cropper")},onCropped:function(e){var t=e.url,n=e.attachment_id,i=e.width,a=e.height;this.setImageFromURL(t,n,i,a)},onSkippedCrop:function(e){var t=e.get("url"),n=e.get("width"),i=e.get("height");this.setImageFromURL(t,e.id,n,i)},setImageFromURL:function(e,t,n,i){var o,s={};s.url=e,s.thumbnail_url=e,s.timestamp=_.now(),t&&(s.attachment_id=t),n&&(s.width=n),i&&(s.height=i),o=new a.HeaderTool.ImageModel({header:s,choice:e.split("/").pop()}),a.HeaderTool.UploadsList.add(o),a.HeaderTool.currentHeader.set(o.toJSON()),o.save(),o.importImage()},removeImage:function(){a.HeaderTool.currentHeader.trigger("hide"),a.HeaderTool.CombinedList.trigger("control:removeImage")}}),a.ThemeControl=a.Control.extend({touchDrag:!1,screenshotRendered:!1,ready:function(){function e(){return!o.canSwitchTheme(i.params.theme.id)}function t(){return e()||!1===a.settings.theme._canInstall||!0===a.settings.theme._filesystemCredentialsNeeded}function n(){i.container.find("button.preview, button.preview-theme").toggleClass("disabled",e()),i.container.find("button.theme-install").toggleClass("disabled",t())}var i=this,o=a.panel("themes");a.state("selectedChangesetStatus").bind(n),a.state("changesetStatus").bind(n),n(),i.container.on("touchmove",".theme",function(){i.touchDrag=!0}),i.container.on("click keydown touchend",".theme",function(e){var t;if(!a.utils.isKeydownButNotEnterEvent(e))return!0===i.touchDrag?i.touchDrag=!1:void($(e.target).is(".theme-actions .button, .update-theme")||(e.preventDefault(),t=a.section(i.section()),t.showDetails(i.params.theme,function(){a.settings.theme._filesystemCredentialsNeeded&&t.overlay.find(".theme-actions .delete-theme").remove()})))}),i.container.on("render-screenshot",function(){var e=$(this).find("img"),t=e.data("src");t&&e.attr("src",t),i.screenshotRendered=!0})},filter:function(e){var t=this,n=0,i=t.params.theme.name+" "+t.params.theme.description+" "+t.params.theme.tags+" "+t.params.theme.author+" ";return i=i.toLowerCase().replace("-"," "),_.isArray(e)||(e=[e]),t.params.theme.name.toLowerCase()===e.join(" ")?n=100:(n+=10*(i.split(e.join(" ")).length-1),_.each(e,function(e){n+=2*(i.split(e+" ").length-1),n=n+i.split(e).length-1}),n>99&&(n=99)),0!==n?(t.activate(),t.params.priority=101-n,!0):(t.deactivate(),t.params.priority=101,!1)},rerenderAsInstalled:function(e){var t=this,n;e?t.params.theme.type="installed":(n=a.section(t.params.section),t.params.theme.type=n.params.action),t.renderContent(),t.container.trigger("render-screenshot")}}),a.CodeEditorControl=a.Control.extend({initialize:function(e,t){var n=this;n.deferred=_.extend(n.deferred||{},{codemirror:$.Deferred()}),a.Control.prototype.initialize.call(n,e,t),n.notifications.bind("add",function(e){e.code===n.setting.id+":csslint_error"&&(e.templateId="customize-code-editor-lint-error-notification",e.render=function(e){return function(){var t=e.call(this);return t.find("input[type=checkbox]").on("click",function(){n.setting.notifications.remove("csslint_error")}),t}}(e.render))})},ready:function(){var e=this;if(!e.section())return void e.initEditor();a.section(e.section(),function(t){t.deferred.embedded.done(function(){var n;t.expanded()?e.initEditor():(n=function(i){i&&(e.initEditor(),t.expanded.unbind(n))},t.expanded.bind(n))})})},initEditor:function(){var e=this,t,n=!1;wp.codeEditor&&(_.isUndefined(e.params.editor_settings)||!1!==e.params.editor_settings)&&(n=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{},n.codemirror=_.extend({},n.codemirror,{indentUnit:2,tabSize:2}),_.isObject(e.params.editor_settings)&&_.each(e.params.editor_settings,function(e,t){_.isObject(e)&&(n[t]=_.extend({},n[t],e))})),t=new a.Element(e.container.find("textarea")),e.elements.push(t),t.sync(e.setting),t.set(e.setting()),n?e.initSyntaxHighlightingEditor(n):e.initPlainTextareaEditor()},focus:function(e){var t=this,n=_.extend({},e),i;i=n.completeCallback,n.completeCallback=function(){i&&i(),t.editor&&t.editor.codemirror.focus()},a.Control.prototype.focus.call(t,n)},initSyntaxHighlightingEditor:function(e){var t=this,n=t.container.find("textarea"),i,a=!1;i=_.extend({},e,{onTabNext:_.bind(t.onTabNext,t),onTabPrevious:_.bind(t.onTabPrevious,t),onUpdateErrorNotice:_.bind(t.onUpdateErrorNotice,t)}),t.editor=wp.codeEditor.initialize(n,i),$(t.editor.codemirror.display.lineDiv).attr({role:"textbox","aria-multiline":"true","aria-label":t.params.label,"aria-describedby":"editor-keyboard-trap-help-1 editor-keyboard-trap-help-2 editor-keyboard-trap-help-3 editor-keyboard-trap-help-4"}),t.container.find("label").on("click",function(){t.editor.codemirror.focus()}),t.editor.codemirror.on("change",function(e){a=!0,n.val(e.getValue()).trigger("change"),a=!1}),t.setting.bind(function(e){a||t.editor.codemirror.setValue(e)}),t.editor.codemirror.on("keydown",function e(t,n){var i=27;27===n.keyCode&&n.stopPropagation()}),t.deferred.codemirror.resolveWith(t,[t.editor.codemirror])},onTabNext:function e(){var t=this,n,i,o;o=a.section(t.section()),n=o.controls(),i=n.indexOf(t),n.length===i+1?$("#customize-footer-actions .collapse-sidebar").focus():n[i+1].container.find(":focusable:first").focus()},onTabPrevious:function e(){var t=this,n,i,o;o=a.section(t.section()),n=o.controls(),i=n.indexOf(t),0===i?o.contentContainer.find(".customize-section-title .customize-help-toggle, .customize-section-title .customize-section-description.open .section-description-close").last().focus():n[i-1].contentContainer.find(":focusable:first").focus()},onUpdateErrorNotice:function e(t){var n=this,i;n.setting.notifications.remove("csslint_error"),0!==t.length&&(i=1===t.length?a.l10n.customCssError.singular.replace("%d","1"):a.l10n.customCssError.plural.replace("%d",String(t.length)),n.setting.notifications.add(new a.Notification("csslint_error",{message:i,type:"error"})))},initPlainTextareaEditor:function(){var e=this,t=e.container.find("textarea"),n=t[0];t.on("blur",function e(){t.data("next-tab-blurs",!1)}),t.on("keydown",function e(i){var a,o,s,r=9,c=27;if(27===i.keyCode)return void(t.data("next-tab-blurs")||(t.data("next-tab-blurs",!0),i.stopPropagation()))
;9!==i.keyCode||i.ctrlKey||i.altKey||i.shiftKey||t.data("next-tab-blurs")||(a=n.selectionStart,o=n.selectionEnd,s=n.value,a>=0&&(n.value=s.substring(0,a).concat("\t",s.substring(o)),t.selectionStart=n.selectionEnd=a+1),i.stopPropagation(),i.preventDefault())}),e.deferred.codemirror.rejectWith(e)}}),a.DateTimeControl=a.Control.extend({ready:function e(){var t=this;if(t.inputElements={},t.invalidDate=!1,_.bindAll(t,"populateSetting","updateDaysForMonth","populateDateInputs"),!t.setting)throw new Error("Missing setting");t.container.find(".date-input").each(function(){var e=$(this),n,i;n=e.data("component"),i=new a.Element(e),t.inputElements[n]=i,t.elements.push(i),e.on("change",function(){t.invalidDate&&t.notifications.add(new a.Notification("invalid_date",{message:a.l10n.invalidDate}))}),e.on("input",_.debounce(function(){t.invalidDate||t.notifications.remove("invalid_date")})),e.on("blur",_.debounce(function(){t.invalidDate||t.populateDateInputs()}))}),t.inputElements.month.bind(t.updateDaysForMonth),t.inputElements.year.bind(t.updateDaysForMonth),t.populateDateInputs(),t.setting.bind(t.populateDateInputs),_.each(t.inputElements,function(e){e.bind(t.populateSetting)})},parseDateTime:function e(t){var n=this,i,a,o=12;return t&&(i=t.match(/^(\d\d\d\d)-(\d\d)-(\d\d)(?: (\d\d):(\d\d)(?::(\d\d))?)?$/)),i?(i.shift(),a={year:i.shift(),month:i.shift(),day:i.shift(),hour:i.shift()||"00",minute:i.shift()||"00",second:i.shift()||"00"},n.params.includeTime&&n.params.twelveHourFormat&&(a.hour=parseInt(a.hour,10),a.meridian=a.hour>=12?"pm":"am",a.hour=a.hour%12?String(a.hour%12):String(12),delete a.second),a):null},validateInputs:function e(){var t=this,n,i;return t.invalidDate=!1,n=["year","day"],t.params.includeTime&&n.push("hour","minute"),_.find(n,function(e){var n,a,o,s;return n=t.inputElements[e],i=n.element.get(0),a=parseInt(n.element.attr("max"),10),o=parseInt(n.element.attr("min"),10),s=parseInt(n(),10),t.invalidDate=isNaN(s)||s>a||s<o,t.invalidDate||i.setCustomValidity(""),t.invalidDate}),t.inputElements.meridian&&!t.invalidDate&&(i=t.inputElements.meridian.element.get(0),"am"!==t.inputElements.meridian.get()&&"pm"!==t.inputElements.meridian.get()?t.invalidDate=!0:i.setCustomValidity("")),t.invalidDate?i.setCustomValidity(a.l10n.invalidValue):i.setCustomValidity(""),(!t.section()||a.section.has(t.section())&&a.section(t.section()).expanded())&&_.result(i,"reportValidity"),t.invalidDate},updateDaysForMonth:function e(){var t=this,n,i,a,o;a=parseInt(t.inputElements.month(),10),i=parseInt(t.inputElements.year(),10),o=parseInt(t.inputElements.day(),10),a&&i&&(n=new Date(i,a,0).getDate(),t.inputElements.day.element.attr("max",n),o>n&&t.inputElements.day(String(n)))},populateSetting:function e(){var t=this,n;return!(t.validateInputs()||!t.params.allowPastDate&&!t.isFutureDate())&&(n=t.convertInputDateToString(),t.setting.set(n),!0)},convertInputDateToString:function e(){var t=this,n="",i,a,o,s;return s=function(e,t){var n;return String(e).length<t&&(n=t-String(e).length,e=Math.pow(10,n).toString().substr(1)+String(e)),e},o=function(e){var n=parseInt(t.inputElements[e].get(),10);return _.contains(["month","day","hour","minute"],e)?n=s(n,2):"year"===e&&(n=s(n,4)),n},i=["year","-","month","-","day"],t.params.includeTime&&(a=t.inputElements.meridian?t.convertHourToTwentyFourHourFormat(t.inputElements.hour(),t.inputElements.meridian()):t.inputElements.hour(),i=i.concat([" ",s(a,2),":","minute",":","00"])),_.each(i,function(e){n+=t.inputElements[e]?o(e):e}),n},isFutureDate:function e(){var t=this;return 0<a.utils.getRemainingTime(t.convertInputDateToString())},convertHourToTwentyFourHourFormat:function e(t,n){var i,a,o=12;return a=parseInt(t,10),isNaN(a)?"":(i="pm"===n&&a<12?a+12:"am"===n&&12===a?a-12:a,String(i))},populateDateInputs:function e(){var t=this,n;return!!(n=t.parseDateTime(t.setting.get()))&&(_.each(t.inputElements,function(e,t){var i=n[t];"month"===t||"meridian"===t?(i=i.replace(/^0/,""),e.set(i)):(i=parseInt(i,10),e.element.is(document.activeElement)?i!==parseInt(e(),10)&&e.set(String(i)):e.set(n[t]))}),!0)},toggleFutureDateNotification:function e(t){var n=this,i,o;return i="not_future_date",t?(o=new a.Notification(i,{type:"error",message:a.l10n.futureDateError}),n.notifications.add(o)):n.notifications.remove(i),n}}),a.PreviewLinkControl=a.Control.extend({defaults:_.extend({},a.Control.prototype.defaults,{templateId:"customize-preview-link-control"}),ready:function e(){var t=this,n,i,o,s,r,c;_.bindAll(t,"updatePreviewLink"),t.setting||(t.setting=new a.Value),t.previewElements={},t.container.find(".preview-control-element").each(function(){o=$(this),i=o.data("component"),n=new a.Element(o),t.previewElements[i]=n,t.elements.push(n)}),s=t.previewElements.url,r=t.previewElements.input,c=t.previewElements.button,r.link(t.setting),s.link(t.setting),s.bind(function(e){s.element.parent().attr({href:e,target:a.settings.changeset.uuid})}),a.bind("ready",t.updatePreviewLink),a.state("saved").bind(t.updatePreviewLink),a.state("changesetStatus").bind(t.updatePreviewLink),a.state("activated").bind(t.updatePreviewLink),a.previewer.previewUrl.bind(t.updatePreviewLink),c.element.on("click",function(e){e.preventDefault(),t.setting()&&(r.element.select(),document.execCommand("copy"),c(c.element.data("copied-text")))}),s.element.parent().on("click",function(e){$(this).hasClass("disabled")&&e.preventDefault()}),c.element.on("mouseenter",function(){t.setting()&&c(c.element.data("copy-text"))})},updatePreviewLink:function e(){var t=this,n;n=!a.state("saved").get()||""===a.state("changesetStatus").get()||"auto-draft"===a.state("changesetStatus").get(),t.toggleSaveNotification(n),t.previewElements.url.element.parent().toggleClass("disabled",n),t.previewElements.button.element.prop("disabled",n),t.setting.set(a.previewer.getFrontendPreviewUrl())},toggleSaveNotification:function e(t){var n=this,i,o;i="changes_not_saved",t?(o=new a.Notification(i,{type:"info",message:a.l10n.saveBeforeShare}),n.notifications.add(o)):n.notifications.remove(i)}}),a.defaultConstructor=a.Setting,a.control=new a.Values({defaultConstructor:a.Control}),a.section=new a.Values({defaultConstructor:a.Section}),a.panel=new a.Values({defaultConstructor:a.Panel}),a.notifications=new a.Notifications,a.PreviewFrame=a.Messenger.extend({sensitivity:null,initialize:function(e,t){var n=$.Deferred();n.promise(this),this.container=e.container,$.extend(e,{channel:a.PreviewFrame.uuid()}),a.Messenger.prototype.initialize.call(this,e,t),this.add("previewUrl",e.previewUrl),this.query=$.extend(e.query||{},{customize_messenger_channel:this.channel()}),this.run(n)},run:function(e){var t=this,n=!1,i=!1,o=null,s="{}"!==t.query.customized,r,c,l;t._ready&&t.unbind("ready",t._ready),t._ready=function(a){i=!0,o=a,t.container.addClass("iframe-ready"),a&&n&&e.resolveWith(t,[a])},t.bind("ready",t._ready),r=document.createElement("a"),r.href=t.previewUrl(),c=_.extend(a.utils.parseQueryString(r.search.substr(1)),{customize_changeset_uuid:t.query.customize_changeset_uuid,customize_theme:t.query.customize_theme,customize_messenger_channel:t.query.customize_messenger_channel}),!a.settings.changeset.autosaved&&a.state("saved").get()||(c.customize_autosaved="on"),r.search=$.param(c),t.iframe=$("<iframe />",{title:a.l10n.previewIframeTitle,name:"customize-"+t.channel()}),t.iframe.attr("onmousewheel",""),s?t.iframe.attr("data-src",r.href):t.iframe.attr("src",r.href),t.iframe.appendTo(t.container),t.targetWindow(t.iframe[0].contentWindow),s&&(l=$("<form>",{action:r.href,target:t.iframe.attr("name"),method:"post",hidden:"hidden"}),l.append($("<input>",{type:"hidden",name:"_method",value:"GET"})),_.each(t.query,function(e,t){l.append($("<input>",{type:"hidden",name:t,value:e}))}),t.container.append(l),l.submit(),l.remove()),t.bind("iframe-loading-error",function(n){return t.iframe.remove(),0===n?void t.login(e):-1===n?void e.rejectWith(t,["cheatin"]):void e.rejectWith(t,["request failure"])}),t.iframe.one("load",function(){n=!0,i?e.resolveWith(t,[o]):setTimeout(function(){e.rejectWith(t,["ready timeout"])},t.sensitivity)})},login:function(e){var t=this,n;if(n=function(){e.rejectWith(t,["logged out"])},this.triedLogin)return n();$.get(a.settings.url.ajax,{action:"logged-in"}).fail(n).done(function(i){var o;"1"!==i&&n(),o=$("<iframe />",{src:t.previewUrl(),title:a.l10n.previewIframeTitle}).hide(),o.appendTo(t.container),o.on("load",function(){t.triedLogin=!0,o.remove(),t.run(e)})})},destroy:function(){a.Messenger.prototype.destroy.call(this),this.iframe&&this.iframe.remove(),delete this.iframe,delete this.targetWindow}}),function(){var e=0;a.PreviewFrame.uuid=function(){return"preview-"+String(e++)}}(),a.setDocumentTitle=function(e){var t,n;t=a.settings.documentTitleTmpl,n=t.replace("%s",e),document.title=n,a.trigger("title",n)},a.Previewer=a.Messenger.extend({refreshBuffer:null,initialize:function(e,t){var n=this,i=document.createElement("a");$.extend(n,t||{}),n.deferred={active:$.Deferred()},n.refresh=_.debounce(function(e){return function(){var t,i;t=function(){return 0===a.state("processing").get()},t()?e.call(n):(i=function(){t()&&(e.call(n),a.state("processing").unbind(i))},a.state("processing").bind(i))}}(n.refresh),n.refreshBuffer),n.container=a.ensure(e.container),n.allowedUrls=e.allowedUrls,e.url=window.location.href,a.Messenger.prototype.initialize.call(n,e),i.href=n.origin(),n.add("scheme",i.protocol.replace(/:$/,"")),n.add("previewUrl",e.previewUrl).setter(function(e){var t=null,i,o,s,r=[];return i=document.createElement("a"),i.href=e,/\/wp-(admin|includes|content)(\/|$)/.test(i.pathname)?null:(i.search.length>1&&(o=a.utils.parseQueryString(i.search.substr(1)),delete o.customize_changeset_uuid,delete o.customize_theme,delete o.customize_messenger_channel,delete o.customize_autosaved,_.isEmpty(o)?i.search="":i.search=$.param(o)),r.push(i),n.scheme.get()+":"!==i.protocol&&(i=document.createElement("a"),i.href=r[0].href,i.protocol=n.scheme.get()+":",r.unshift(i)),s=document.createElement("a"),_.find(r,function(e){return!_.isUndefined(_.find(n.allowedUrls,function(n){if(s.href=n,i.protocol===s.protocol&&i.host===s.host&&0===i.pathname.indexOf(s.pathname.replace(/\/$/,"")))return t=e.href,!0}))}),t)}),n.bind("ready",n.ready),n.deferred.active.done(_.bind(n.keepPreviewAlive,n)),n.bind("synced",function(){n.send("active")}),n.previewUrl.bind(n.refresh),n.scroll=0,n.bind("scroll",function(e){n.scroll=e}),n.bind("url",function(e){var t,i=!1;n.scroll=0,t=function(){i=!0},n.previewUrl.bind(t),n.previewUrl.set(e),n.previewUrl.unbind(t),i||n.refresh()}),n.bind("documentTitle",function(e){a.setDocumentTitle(e)})},ready:function(e){var t=this,n={},i;n.settings=a.get(),n["settings-modified-while-loading"]=t.settingsModifiedWhileLoading,("resolved"!==t.deferred.active.state()||t.loading)&&(n.scroll=t.scroll),n["edit-shortcut-visibility"]=a.state("editShortcutVisibility").get(),t.send("sync",n),e.currentUrl&&(t.previewUrl.unbind(t.refresh),t.previewUrl.set(e.currentUrl),t.previewUrl.bind(t.refresh)),i={panel:e.activePanels,section:e.activeSections,control:e.activeControls},_(i).each(function(e,t){a[t].each(function(n,i){_.isUndefined(a.settings[t+"s"][i])&&_.isUndefined(e[i])||(e[i]?n.activate():n.deactivate())})}),e.settingValidities&&a._handleSettingValidities({settingValidities:e.settingValidities,focusInvalidControl:!1})},keepPreviewAlive:function e(){var t=this,n,i,o,s;s=function(){i=setTimeout(o,a.settings.timeouts.keepAliveCheck)},n=function(){a.state("previewerAlive").set(!0),clearTimeout(i),s()},o=function(){a.state("previewerAlive").set(!1)},s(),t.bind("ready",n),t.bind("keep-alive",n)},query:function(){},abort:function(){this.loading&&(this.loading.destroy(),delete this.loading)},refresh:function(){var e=this,t;e.send("loading-initiated"),e.abort(),e.loading=new a.PreviewFrame({url:e.url(),previewUrl:e.previewUrl(),query:e.query({excludeCustomizedSaved:!0})||{},container:e.container}),e.settingsModifiedWhileLoading={},t=function(t){e.settingsModifiedWhileLoading[t.id]=!0},a.bind("change",t),e.loading.always(function(){a.unbind("change",t)}),e.loading.done(function(t){var n=this,i;e.preview=n,e.targetWindow(n.targetWindow()),e.channel(n.channel()),i=function(){n.unbind("synced",i),e._previousPreview&&e._previousPreview.destroy(),e._previousPreview=e.preview,e.deferred.active.resolve(),delete e.loading},n.bind("synced",i),e.trigger("ready",t)}),e.loading.fail(function(t){e.send("loading-failed"),"logged out"===t&&(e.preview&&(e.preview.destroy(),delete e.preview),e.login().done(e.refresh)),"cheatin"===t&&e.cheatin()})},login:function(){var e=this,t,n,i;return this._login?this._login:(t=$.Deferred(),this._login=t.promise(),n=new a.Messenger({channel:"login",url:a.settings.url.login}),i=$("<iframe />",{src:a.settings.url.login,title:a.l10n.loginIframeTitle}).appendTo(this.container),n.targetWindow(i[0].contentWindow),n.bind("login",function(){var a=e.refreshNonces();a.always(function(){i.remove(),n.destroy(),delete e._login}),a.done(function(){t.resolve()}),a.fail(function(){e.cheatin(),t.reject()})}),this._login)},cheatin:function(){$(document.body).empty().addClass("cheatin").append("<h1>"+a.l10n.notAllowedHeading+"</h1><p>"+a.l10n.notAllowed+"</p>")},refreshNonces:function(){var e,t=$.Deferred();return t.promise(),e=wp.ajax.post("customize_refresh_nonces",{wp_customize:"on",customize_theme:a.settings.theme.stylesheet}),e.done(function(e){a.trigger("nonce-refresh",e),t.resolve()}),e.fail(function(){t.reject()}),t}}),a.settingConstructor={},a.controlConstructor={color:a.ColorControl,media:a.MediaControl,upload:a.UploadControl,image:a.ImageControl,cropped_image:a.CroppedImageControl,site_icon:a.SiteIconControl,header:a.HeaderControl,background:a.BackgroundControl,background_position:a.BackgroundPositionControl,theme:a.ThemeControl,date_time:a.DateTimeControl,code_editor:a.CodeEditorControl},a.panelConstructor={themes:a.ThemesPanel},a.sectionConstructor={themes:a.ThemesSection,outer:a.OuterSection},a._handleSettingValidities=function e(t){var n,i=[],o=!1;_.each(t.settingValidities,function(e,t){var n=a(t);n&&(_.isObject(e)&&_.each(e,function(e,t){var o,s,r=!1;o=new a.Notification(t,_.extend({fromServer:!0},e)),s=n.notifications(o.code),s&&(r=o.type!==s.type||o.message!==s.message||!_.isEqual(o.data,s.data)),r&&n.notifications.remove(t),n.notifications.has(o.code)||n.notifications.add(o),i.push(n.id)}),n.notifications.each(function(t){!t.fromServer||"error"!==t.type||!0!==e&&e[t.code]||n.notifications.remove(t.code)}))}),t.focusInvalidControl&&(n=a.findControlsForSettings(i),_(_.values(n)).find(function(e){return _(e).find(function(e){var t=e.section()&&a.section.has(e.section())&&a.section(e.section()).expanded();return t&&e.expanded&&(t=e.expanded()),t&&(e.focus(),o=!0),o})}),o||_.isEmpty(n)||_.values(n)[0][0].focus())},a.findControlsForSettings=function e(t){var n={},i;return _.each(_.unique(t),function(e){var t=a(e);t&&(i=t.findControls())&&i.length>0&&(n[e]=i)}),n},a.reflowPaneContents=_.bind(function(){var e,t,n,i=[],o=!1;document.activeElement&&(t=$(document.activeElement)),a.panel.each(function(t){if("themes"!==t.id){var n=t.sections(),s=_.pluck(n,"headContainer");i.push(t),e=t.contentContainer.is("ul")?t.contentContainer:t.contentContainer.find("ul:first"),a.utils.areElementListsEqual(s,e.children("[id]"))||(_(n).each(function(t){e.append(t.headContainer)}),o=!0)}}),a.section.each(function(t){var n=t.controls(),s=_.pluck(n,"container");t.panel()||i.push(t),e=t.contentContainer.is("ul")?t.contentContainer:t.contentContainer.find("ul:first"),a.utils.areElementListsEqual(s,e.children("[id]"))||(_(n).each(function(t){e.append(t.container)}),o=!0)}),i.sort(a.utils.prioritySort),n=_.pluck(i,"headContainer"),e=$("#customize-theme-controls .customize-pane-parent"),a.utils.areElementListsEqual(n,e.children())||(_(i).each(function(t){e.append(t.headContainer)}),o=!0),a.panel.each(function(e){var t=e.active();e.active.callbacks.fireWith(e.active,[t,t])}),a.section.each(function(e){var t=e.active();e.active.callbacks.fireWith(e.active,[t,t])}),o&&t&&t.focus(),a.trigger("pane-contents-reflowed")},a),a.state=new a.Values,_.each(["saved","saving","trashing","activated","processing","paneVisible","expandedPanel","expandedSection","changesetDate","selectedChangesetDate","changesetStatus","selectedChangesetStatus","remainingTimeToPublish","previewerAlive","editShortcutVisibility","changesetLocked","previewedDevice"],function(e){a.state.create(e)}),$(function(){function e(){function t(e){e||a.settings.changeset.autosaved||(a.settings.changeset.autosaved=!0,a.previewer.send("autosaving"))}var n,i,o,s=!1;a.unbind("change",e),a.state("saved").bind(t),t(a.state("saved").get()),i=function(){s||(s=!0,a.requestChangesetUpdate({},{autosave:!0}).always(function(){s=!1})),o()},o=function(){clearTimeout(n),n=setTimeout(function(){i()},a.settings.timeouts.changesetAutoSave)},o(),$(document).on("visibilitychange.wp-customize-changeset-update",function(){document.hidden&&i()}),$(window).on("beforeunload.wp-customize-changeset-update",function(){i()})}if(a.settings=window._wpCustomizeSettings,a.l10n=window._wpCustomizeControlsL10n,a.settings&&$.support.postMessage&&($.support.cors||!a.settings.isCrossDomain)){null===a.PreviewFrame.prototype.sensitivity&&(a.PreviewFrame.prototype.sensitivity=a.settings.timeouts.previewFrameSensitivity),null===a.Previewer.prototype.refreshBuffer&&(a.Previewer.prototype.refreshBuffer=a.settings.timeouts.windowRefresh);var t,n=$(document.body),i=n.children(".wp-full-overlay"),o=$("#customize-info .panel-title.site-title"),s=$(".customize-controls-close"),r=$("#save"),c=$("#customize-save-button-wrapper"),l=$("#publish-settings"),d=$("#customize-footer-actions");a.bind("ready",function(){a.section.add(new a.OuterSection("publish_settings",{title:a.l10n.publishSettings,priority:0,active:a.settings.theme.active}))}),a.section("publish_settings",function(e){function t(){v||(v=a.utils.highlightButton(c,{delay:1e3,focusTarget:r}))}function n(){v&&(v(),v=null)}var i,o,s,d,u,p,h,f,m,g,v,_=1e3;o=new a.Control("trash_changeset",{type:"button",section:e.id,priority:30,input_attrs:{class:"button-link button-link-delete",value:a.l10n.discardChanges}}),a.control.add(o),o.deferred.embedded.done(function(){o.container.find(".button-link").on("click",function(){confirm(a.l10n.trashConfirm)&&wp.customize.previewer.trash()})}),a.control.add(new a.PreviewLinkControl("changeset_preview_link",{section:e.id,priority:100})),d=function(){return!!a.state("activated").get()&&(!a.state("trashing").get()&&"trash"!==a.state("changesetStatus").get()&&(""!==a.state("changesetStatus").get()||!a.state("saved").get()))},e.active.validate=d,s=function(){e.active.set(d())},a.state("activated").bind(s),a.state("trashing").bind(s),a.state("saved").bind(s),a.state("changesetStatus").bind(s),s(),i=function(){l.toggle(e.active.get()),r.toggleClass("has-next-sibling",e.active.get())},i(),e.active.bind(i),a.state("selectedChangesetStatus").bind(n),e.contentContainer.find(".customize-action").text(a.l10n.updating),e.contentContainer.find(".customize-section-back").removeAttr("tabindex"),l.prop("disabled",!1),l.on("click",function(t){t.preventDefault(),e.expanded.set(!e.expanded.get())}),e.expanded.bind(function(e){var i;if(l.attr("aria-expanded",String(e)),l.toggleClass("active",e),e)return void n();i=a.state("changesetStatus").get(),""!==i&&"auto-draft"!==i||(i="publish"),a.state("selectedChangesetStatus").get()!==i?t():"future"===a.state("selectedChangesetStatus").get()&&a.state("selectedChangesetDate").get()!==a.state("changesetDate").get()&&t()}),u=new a.Control("changeset_status",{priority:10,type:"radio",section:"publish_settings",setting:a.state("selectedChangesetStatus"),templateId:"customize-selected-changeset-status-control",label:a.l10n.action,choices:a.settings.changeset.statusChoices}),a.control.add(u),p=new a.DateTimeControl("changeset_scheduled_date",{priority:20,section:"publish_settings",setting:a.state("selectedChangesetDate"),minYear:(new Date).getFullYear(),allowPastDate:!1,includeTime:!0,twelveHourFormat:/a/i.test(a.settings.timeFormat),description:a.l10n.scheduleDescription}),p.notifications.alt=!0,a.control.add(p),f=function(){a.state("selectedChangesetStatus").set("publish"),a.previewer.save()},g=function(){var e="future"===a.state("changesetStatus").get()&&"future"===a.state("selectedChangesetStatus").get()&&a.state("changesetDate").get()&&a.state("selectedChangesetDate").get()===a.state("changesetDate").get()&&a.utils.getRemainingTime(a.state("changesetDate").get())>=0;e&&!m?m=setInterval(function(){var e=a.utils.getRemainingTime(a.state("changesetDate").get());a.state("remainingTimeToPublish").set(e),e<=0&&(clearInterval(m),m=0,f())},1e3):!e&&m&&(clearInterval(m),m=0)},a.state("changesetDate").bind(g),a.state("selectedChangesetDate").bind(g),a.state("changesetStatus").bind(g),a.state("selectedChangesetStatus").bind(g),g(),p.active.validate=function(){return"future"===a.state("selectedChangesetStatus").get()},h=function(e){p.active.set("future"===e)},h(a.state("selectedChangesetStatus").get()),a.state("selectedChangesetStatus").bind(h),a.state("saving").bind(function(e){e&&"future"===a.state("selectedChangesetStatus").get()&&p.toggleFutureDateNotification(!p.isFutureDate())})}),$("#customize-controls").on("keydown",function(e){var t=13===e.which,n=$(e.target);t&&(n.is("input:not([type=button])")||n.is("select"))&&e.preventDefault()}),$(".customize-info").find("> .accordion-section-title .customize-help-toggle").on("click",function(){var e=$(this).closest(".accordion-section"),t=e.find(".customize-panel-description:first");e.hasClass("cannot-expand")||(e.hasClass("open")?(e.toggleClass("open"),t.slideUp(a.Panel.prototype.defaultExpandedArguments.duration,function(){t.trigger("toggled")}),$(this).attr("aria-expanded",!1)):(t.slideDown(a.Panel.prototype.defaultExpandedArguments.duration,function(){t.trigger("toggled")}),e.toggleClass("open"),$(this).attr("aria-expanded",!0)))}),a.previewer=new a.Previewer({container:"#customize-preview",form:"#customize-controls",previewUrl:a.settings.url.preview,allowedUrls:a.settings.url.allowed},{nonce:a.settings.nonce,query:function(e){var t={wp_customize:"on",customize_theme:a.settings.theme.stylesheet,nonce:this.nonce.preview,customize_changeset_uuid:a.settings.changeset.uuid};return!a.settings.changeset.autosaved&&a.state("saved").get()||(t.customize_autosaved="on"),t.customized=JSON.stringify(a.dirtyValues({unsaved:e&&e.excludeCustomizedSaved})),t},save:function(e){function n(e){u[e.id]=!0}var i=this,o=$.Deferred(),s=a.state("selectedChangesetStatus").get(),r=a.state("selectedChangesetDate").get(),c=a.state("processing"),l,d,u={},p=[],h=[],f=[];return e&&e.status&&(s=e.status),a.state("saving").get()&&(o.reject("already_saving"),o.promise()),a.state("saving").set(!0),d=function(){var c,l,d={},m=a._latestRevision,g="client_side_error";if(a.bind("change",n),a.notifications.remove(g),a.each(function(e){e.notifications.each(function(t){"error"!==t.type||t.fromServer||(p.push(e.id),d[e.id]||(d[e.id]={}),d[e.id][t.code]=t)})}),a.control.each(function(e){(!e.setting||!e.setting.id&&e.active.get())&&e.notifications.each(function(t){"error"===t.type&&f.push([e])})}),h=_.union(f,_.values(a.findControlsForSettings(p))),!_.isEmpty(h))return h[0][0].focus(),a.unbind("change",n),p.length&&a.notifications.add(new a.Notification(g,{message:(1===p.length?a.l10n.saveBlockedError.singular:a.l10n.saveBlockedError.plural).replace(/%s/g,String(p.length)),type:"error",dismissible:!0,saveFailure:!0})),o.rejectWith(i,[{setting_invalidities:d}]),a.state("saving").set(!1),o.promise();l=$.extend(i.query({excludeCustomizedSaved:!1}),{nonce:i.nonce.save,customize_changeset_status:s}),e&&e.date?l.customize_changeset_date=e.date:"future"===s&&r&&(l.customize_changeset_date=r),e&&e.title&&(l.customize_changeset_title=e.title),a.trigger("save-request-params",l),c=wp.ajax.post("customize_save",l),a.state("processing").set(a.state("processing").get()+1),a.trigger("save",c),c.always(function(){a.state("processing").set(a.state("processing").get()-1),a.state("saving").set(!1),a.unbind("change",n)}),a.notifications.each(function(e){e.saveFailure&&a.notifications.remove(e.code)}),c.fail(function(e){var n,s;s={type:"error",dismissible:!0,fromServer:!0,saveFailure:!0},"0"===e?e="not_logged_in":"-1"===e&&(e="invalid_nonce"),"invalid_nonce"===e?i.cheatin():"not_logged_in"===e?(i.preview.iframe.hide(),i.login().done(function(){i.save(),i.preview.iframe.show()})):e.code?"not_future_date"===e.code&&a.section.has("publish_settings")&&a.section("publish_settings").active.get()&&a.control.has("changeset_scheduled_date")?a.control("changeset_scheduled_date").toggleFutureDateNotification(!0).focus():"changeset_locked"!==e.code&&(n=new a.Notification(e.code,_.extend(s,{message:e.message}))):n=new a.Notification("unknown_error",_.extend(s,{message:a.l10n.unknownRequestFail})),n&&a.notifications.add(n),e.setting_validities&&a._handleSettingValidities({settingValidities:e.setting_validities,focusInvalidControl:!0}),o.rejectWith(i,[e]),a.trigger("error",e),"changeset_already_published"===e.code&&e.next_changeset_uuid&&(a.settings.changeset.uuid=e.next_changeset_uuid,a.state("changesetStatus").set(""),a.settings.changeset.branching&&t.send("changeset-uuid",a.settings.changeset.uuid),a.previewer.send("changeset-uuid",a.settings.changeset.uuid))}),c.done(function(e){i.send("saved",e),a.state("changesetStatus").set(e.changeset_status),e.changeset_date&&a.state("changesetDate").set(e.changeset_date),"publish"===e.changeset_status&&(a.each(function(e){e._dirty&&(_.isUndefined(a._latestSettingRevisions[e.id])||a._latestSettingRevisions[e.id]<=m)&&(e._dirty=!1)}),a.state("changesetStatus").set(""),a.settings.changeset.uuid=e.next_changeset_uuid,a.settings.changeset.branching&&t.send("changeset-uuid",a.settings.changeset.uuid)),a._lastSavedRevision=Math.max(m,a._lastSavedRevision),e.setting_validities&&a._handleSettingValidities({settingValidities:e.setting_validities,focusInvalidControl:!0}),o.resolveWith(i,[e]),a.trigger("saved",e),_.isEmpty(u)||a.state("saved").set(!1)})},0===c()?d():(l=function(){0===c()&&(a.state.unbind("change",l),d())},a.state.bind("change",l)),o.promise()},trash:function e(){var t,n,i;a.state("trashing").set(!0),a.state("processing").set(a.state("processing").get()+1),t=wp.ajax.post("customize_trash",{customize_changeset_uuid:a.settings.changeset.uuid,nonce:a.settings.nonce.trash}),a.notifications.add(new a.OverlayNotification("changeset_trashing",{type:"info",message:a.l10n.revertingChanges,loading:!0})),n=function(){var e=document.createElement("a"),t;a.state("changesetStatus").set("trash"),a.each(function(e){e._dirty=!1}),a.state("saved").set(!0),e.href=location.href,t=a.utils.parseQueryString(e.search.substr(1)),delete t.changeset_uuid,t.return=a.settings.url.return,e.search=$.param(t),location.replace(e.href)},i=function(e,t){var n=e||"unknown_error";a.state("processing").set(a.state("processing").get()-1),a.state("trashing").set(!1),a.notifications.remove("changeset_trashing"),a.notifications.add(new a.Notification(n,{message:t||a.l10n.unknownError,dismissible:!0,type:"error"}))},t.done(function(e){n(e.message)}),t.fail(function(e){var t=e.code||"trashing_failed";e.success||"non_existent_changeset"===t||"changeset_already_trashed"===t?n(e.message):i(t,e.message)})},getFrontendPreviewUrl:function(){var e=this,t,n;return n=document.createElement("a"),n.href=e.previewUrl.get(),t=a.utils.parseQueryString(n.search.substr(1)),a.state("changesetStatus").get()&&"publish"!==a.state("changesetStatus").get()&&(t.customize_changeset_uuid=a.settings.changeset.uuid),a.state("activated").get()||(t.customize_theme=a.settings.theme.stylesheet),n.search=$.param(t),n.href}}),$.ajaxPrefilter(function e(t){/wp_customize=on/.test(t.data)&&(t.data+="&"+$.param({customize_preview_nonce:a.settings.nonce.preview}))}),a.previewer.bind("nonce",function(e){$.extend(this.nonce,e)}),a.bind("nonce-refresh",function(e){$.extend(a.settings.nonce,e),$.extend(a.previewer.nonce,e),a.previewer.send("nonce-refresh",e)}),$.each(a.settings.settings,function(e,t){var n=a.settingConstructor[t.type]||a.Setting;a.add(new n(e,t.value,{transport:t.transport,previewer:a.previewer,dirty:!!t.dirty}))}),$.each(a.settings.panels,function(e,t){var n=a.panelConstructor[t.type]||a.Panel,i;i=_.extend({params:t},t),a.panel.add(new n(e,i))}),$.each(a.settings.sections,function(e,t){var n=a.sectionConstructor[t.type]||a.Section,i;i=_.extend({params:t},t),a.section.add(new n(e,i))}),$.each(a.settings.controls,function(e,t){var n=a.controlConstructor[t.type]||a.Control,i;i=_.extend({params:t},t),a.control.add(new n(e,i))}),_.each(["panel","section","control"],function(e){var t=a.settings.autofocus[e];t&&a[e](t,function(e){e.deferred.embedded.done(function(){a.previewer.deferred.active.done(function(){e.focus()})})})}),a.bind("ready",a.reflowPaneContents),$([a.panel,a.section,a.control]).each(function(e,t){var n=_.debounce(a.reflowPaneContents,a.settings.timeouts.reflowPaneContents);t.bind("add",n),t.bind("change",n),t.bind("remove",n)}),a.bind("ready",function e(){var t,n,i;a.notifications.container=$("#customize-notifications-area"),a.notifications.bind("change",_.debounce(function(){a.notifications.render()})),t=$(".wp-full-overlay-sidebar-content"),a.notifications.bind("rendered",function e(){t.css("top",""),0!==a.notifications.count()&&(n=a.notifications.container.outerHeight()+1,i=parseInt(t.css("top"),10),t.css("top",i+n+"px")),a.notifications.trigger("sidebarTopUpdated")}),a.notifications.render()}),function(e){var t=e.instance("saved"),i=e.instance("saving"),o=e.instance("trashing"),c=e.instance("activated"),l=e.instance("processing"),d=e.instance("paneVisible"),u=e.instance("expandedPanel"),p=e.instance("expandedSection"),h=e.instance("changesetStatus"),f=e.instance("selectedChangesetStatus"),m=e.instance("changesetDate"),g=e.instance("selectedChangesetDate"),v=e.instance("previewerAlive"),_=e.instance("editShortcutVisibility"),w=e.instance("changesetLocked"),b,C;e.bind("change",function(){var e;c()?""===h.get()&&t()?(a.settings.changeset.currentUserCanPublish?r.val(a.l10n.published):r.val(a.l10n.saved),s.find(".screen-reader-text").text(a.l10n.close)):("draft"===f()?t()&&f()===h()?r.val(a.l10n.draftSaved):r.val(a.l10n.saveDraft):"future"===f()?t()&&f()===h()?m.get()!==g.get()?r.val(a.l10n.schedule):r.val(a.l10n.scheduled):r.val(a.l10n.schedule):a.settings.changeset.currentUserCanPublish&&r.val(a.l10n.publish),s.find(".screen-reader-text").text(a.l10n.cancel)):(r.val(a.l10n.activate),s.find(".screen-reader-text").text(a.l10n.cancel)),e=!i()&&!o()&&!w()&&(!c()||!t()||h()!==f()&&""!==h()||"future"===f()&&m.get()!==g.get()),r.prop("disabled",!e)}),f.validate=function(e){return""===e||"auto-draft"===e?null:e},C=a.settings.changeset.currentUserCanPublish?"publish":"draft",h(a.settings.changeset.status),w(Boolean(a.settings.changeset.lockUser)),m(a.settings.changeset.publishDate),g(a.settings.changeset.publishDate),f(""===a.settings.changeset.status||"auto-draft"===a.settings.changeset.status?C:a.settings.changeset.status),f.link(h),t(!0),""===h()&&a.each(function(e){e._dirty&&t(!1)}),i(!1),c(a.settings.theme.active),l(0),d(!0),u(!1),p(!1),v(!0),_("visible"),a.bind("change",function(){e("saved").get()&&e("saved").set(!1)}),a.settings.changeset.branching&&t.bind(function(e){e||b(!0)}),i.bind(function(e){n.toggleClass("saving",e)}),o.bind(function(e){n.toggleClass("trashing",e)}),a.bind("saved",function(t){e("saved").set(!0),"publish"===t.changeset_status&&e("activated").set(!0)}),c.bind(function(e){e&&a.trigger("activated")}),b=function(e){var t,n;if(history.replaceState){if(t=document.createElement("a"),t.href=location.href,n=a.utils.parseQueryString(t.search.substr(1)),e){if(n.changeset_uuid===a.settings.changeset.uuid)return;n.changeset_uuid=a.settings.changeset.uuid}else{if(!n.changeset_uuid)return;delete n.changeset_uuid}
t.search=$.param(n),history.replaceState({},document.title,t.href)}},a.settings.changeset.branching&&h.bind(function(e){b(""!==e&&"publish"!==e&&"trash"!==e)})}(a.state),function e(){function t(e){e&&e.lockUser&&(a.settings.changeset.lockUser=e.lockUser),a.state("changesetLocked").set(!0),a.notifications.add(new n("changeset_locked",{lockUser:a.settings.changeset.lockUser,allowOverride:Boolean(e&&e.allowOverride)}))}var n=a.OverlayNotification.extend({templateId:"customize-changeset-locked-notification",lockUser:null,initialize:function(e,t){var n=this,i,o;i=e||"changeset_locked",o=_.extend({type:"warning",containerClasses:"",lockUser:{}},t),o.containerClasses+=" notification-changeset-locked",a.OverlayNotification.prototype.initialize.call(n,i,o)},render:function(){var e=this,t,n,i,o;return n=_.extend({allowOverride:!1,returnUrl:a.settings.url.return,previewUrl:a.previewer.previewUrl.get(),frontendPreviewUrl:a.previewer.getFrontendPreviewUrl()},this),t=a.OverlayNotification.prototype.render.call(n),a.requestChangesetUpdate({},{autosave:!0}).fail(function(e){e.autosaved||t.find(".notice-error").prop("hidden",!1).text(e.message||a.l10n.unknownRequestFail)}),i=t.find(".customize-notice-take-over-button"),i.on("click",function(n){n.preventDefault(),o||(i.addClass("disabled"),o=wp.ajax.post("customize_override_changeset_lock",{wp_customize:"on",customize_theme:a.settings.theme.stylesheet,customize_changeset_uuid:a.settings.changeset.uuid,nonce:a.settings.nonce.override_lock}),o.done(function(){a.notifications.remove(e.code),a.state("changesetLocked").set(!1)}),o.fail(function(e){var n=e.message||a.l10n.unknownRequestFail;t.find(".notice-error").prop("hidden",!1).text(n),o.always(function(){i.removeClass("disabled")})}),o.always(function(){o=null}))}),t}});a.settings.changeset.lockUser&&t({allowOverride:!0}),$(document).on("heartbeat-send.update_lock_notice",function(e,t){t.check_changeset_lock=!0,t.changeset_uuid=a.settings.changeset.uuid}),$(document).on("heartbeat-tick.update_lock_notice",function(e,n){var i,o="changeset_locked";n.customize_changeset_lock_user&&(i=a.notifications(o),i&&i.lockUser.id!==a.settings.changeset.lockUser.id&&a.notifications.remove(o),t({lockUser:n.customize_changeset_lock_user}))}),a.bind("error",function(e){"changeset_locked"===e.code&&e.lock_user&&t({lockUser:e.lock_user})})}(),function(){function e(){var e,t;return e=document.createElement("a"),e.href=location.href,t=a.utils.parseQueryString(e.search.substr(1)),a.settings.changeset.latestAutoDraftUuid?t.changeset_uuid=a.settings.changeset.latestAutoDraftUuid:t.customize_autosaved="on",t.return=a.settings.url.return,e.search=$.param(t),e.href}function t(e){var t=document.createElement("a"),n,i=0;t.href=location.href,n=a.utils.parseQueryString(t.search.substr(1)),_.each(e,function(e){void 0!==n[e]&&(i+=1,delete n[e])}),0!==i&&(t.search=$.param(n),history.replaceState({},document.title,t.href))}function n(){s||(wp.ajax.post("customize_dismiss_autosave_or_lock",{wp_customize:"on",customize_theme:a.settings.theme.stylesheet,customize_changeset_uuid:a.settings.changeset.uuid,nonce:a.settings.nonce.dismiss_autosave_or_lock,dismiss_autosave:!0}),s=!0)}function i(){var t="autosave_available",i;a.notifications.add(new a.Notification(t,{message:a.l10n.autosaveNotice,type:"warning",dismissible:!0,render:function(){var t=a.Notification.prototype.render.call(this),i;return i=t.find("a"),i.prop("href",e()),i.on("click",function(t){t.preventDefault(),location.replace(e())}),t.find(".notice-dismiss").on("click",n),t}})),i=function(){n(),a.notifications.remove(t),a.unbind("change",i),a.state("changesetStatus").unbind(i)},a.bind("change",i),a.state("changesetStatus").bind(i)}var o=[],s=!1;a.settings.changeset.autosaved&&(a.state("saved").set(!1),o.push("customize_autosaved")),a.settings.changeset.branching||a.settings.changeset.status&&"auto-draft"!==a.settings.changeset.status||o.push("changeset_uuid"),o.length>0&&t(o),(a.settings.changeset.latestAutoDraftUuid||a.settings.changeset.hasAutosaveRevision)&&i()}(),a.previewer.previewUrl()?a.previewer.refresh():a.previewer.previewUrl(a.settings.url.home),r.click(function(e){a.previewer.save(),e.preventDefault()}).keydown(function(e){9!==e.which&&(13===e.which&&a.previewer.save(),e.preventDefault())}),s.keydown(function(e){9!==e.which&&(13===e.which&&this.click(),e.preventDefault())}),$(".collapse-sidebar").on("click",function(){a.state("paneVisible").set(!a.state("paneVisible").get())}),a.state("paneVisible").bind(function(e){i.toggleClass("preview-only",!e),i.toggleClass("expanded",e),i.toggleClass("collapsed",!e),e?$(".collapse-sidebar").attr({"aria-expanded":"true","aria-label":a.l10n.collapseSidebar}):$(".collapse-sidebar").attr({"aria-expanded":"false","aria-label":a.l10n.expandSidebar})}),n.on("keydown",function(e){var t,i=[],o=[],s=[];if(27===e.which&&($(e.target).is("body")||$.contains($("#customize-controls")[0],e.target))&&(a.control.each(function(e){e.expanded&&e.expanded()&&_.isFunction(e.collapse)&&i.push(e)}),a.section.each(function(e){e.expanded()&&o.push(e)}),a.panel.each(function(e){e.expanded()&&s.push(e)}),i.length>0&&0===o.length&&(i.length=0),t=i[0]||o[0]||s[0])){if("themes"===t.params.type)return void(n.hasClass("modal-open")?t.closeDetails():a.panel.has("themes")&&a.panel("themes").collapse());t.collapse(),e.preventDefault()}}),$(".customize-controls-preview-toggle").on("click",function(){a.state("paneVisible").set(!a.state("paneVisible").get())}),function e(){var t=$(".wp-full-overlay-sidebar-content"),n,i,o,s,r,c,l;n=function(e){var t=e,n=a.state("expandedSection").get(),r=a.state("expandedPanel").get(),l;if(c&&c.element&&(o(c.element),c.element.find(".description").off("toggled",i)),!t)if(!n&&r&&r.contentContainer)t=r;else{if(r||!n||!n.contentContainer)return void(c=!1);t=n}l=t.contentContainer.find(".customize-section-title, .panel-meta").first(),l.length?(c={instance:t,element:l,parent:l.closest(".customize-pane-child"),height:l.outerHeight()},c.element.find(".description").on("toggled",i),n&&s(c.element,c.parent)):c=!1},a.state("expandedSection").bind(n),a.state("expandedPanel").bind(n),t.on("scroll",_.throttle(function(){if(c){var e=t.scrollTop(),n;n=l?e===l?0:e>l?1:-1:1,l=e,0!==n&&r(c,e,n)}},8)),a.notifications.bind("sidebarTopUpdated",function(){c&&c.element.hasClass("is-sticky")&&c.element.css("top",t.css("top"))}),o=function(e){e.hasClass("is-sticky")&&e.removeClass("is-sticky").addClass("maybe-sticky is-in-view").css("top",t.scrollTop()+"px")},s=function(e,t){e.hasClass("is-in-view")&&(e.removeClass("maybe-sticky is-in-view").css({width:"",top:""}),t.css("padding-top",""))},i=function(){c.height=c.element.outerHeight()},r=function(e,n,i){var a=e.element,o=e.parent,s=e.height,r=parseInt(a.css("top"),10),c=a.hasClass("maybe-sticky"),l=a.hasClass("is-sticky"),d=a.hasClass("is-in-view");if(-1!==i)return l&&(r=n,a.removeClass("is-sticky").css({top:r+"px",width:""})),void(d&&n>r+s&&(a.removeClass("is-in-view"),o.css("padding-top","")));if(!c&&n>=s)c=!0,a.addClass("maybe-sticky");else if(0===n)return a.removeClass("maybe-sticky is-in-view is-sticky").css({top:"",width:""}),void o.css("padding-top","");d&&!l?r>=n&&a.addClass("is-sticky").css({top:t.css("top"),width:o.outerWidth()+"px"}):c&&!d&&(a.addClass("is-in-view").css("top",n-s+"px"),o.css("padding-top",s+"px"))}}(),a.previewedDevice=a.state("previewedDevice"),a.bind("ready",function(){_.find(a.settings.previewableDevices,function(e,t){if(!0===e.default)return a.previewedDevice.set(t),!0})}),d.find(".devices button").on("click",function(e){a.previewedDevice.set($(e.currentTarget).data("device"))}),a.previewedDevice.bind(function(e){var t=$(".wp-full-overlay"),n="";d.find(".devices button").removeClass("active").attr("aria-pressed",!1),d.find(".devices .preview-"+e).addClass("active").attr("aria-pressed",!0),$.each(a.settings.previewableDevices,function(e){n+=" preview-"+e}),t.removeClass(n).addClass("preview-"+e)}),o.length&&a("blogname",function(e){var t=function(){o.text($.trim(e())||a.l10n.untitledBlogName)};e.bind(t),t()}),t=new a.Messenger({url:a.settings.url.parent,channel:"loader"}),function(){function e(){var e;return a.state("activated").get()?(e=a.state("changesetStatus").get(),""!==e&&"auto-draft"!==e||(e="publish"),a.state("selectedChangesetStatus").get()===e&&(("future"!==a.state("selectedChangesetStatus").get()||a.state("selectedChangesetDate").get()===a.state("changesetDate").get())&&(a.state("saved").get()&&"auto-draft"!==a.state("changesetStatus").get()))):0===a._latestRevision}function n(){a.unbind("change",n),a.state("selectedChangesetStatus").unbind(n),a.state("selectedChangesetDate").unbind(n),$(window).on("beforeunload.customize-confirm",function(){if(!e()&&!a.state("changesetLocked").get())return setTimeout(function(){i.removeClass("customize-loading")},1),a.l10n.saveAlert})}function o(){var t=$.Deferred(),n=!1,i=!1;return e()?i=!0:confirm(a.l10n.saveAlert)?(i=!0,a.each(function(e){e._dirty=!1}),$(document).off("visibilitychange.wp-customize-changeset-update"),$(window).off("beforeunload.wp-customize-changeset-update"),s.css("cursor","progress"),""!==a.state("changesetStatus").get()&&(n=!0)):t.reject(),(i||n)&&wp.ajax.send("customize_dismiss_autosave_or_lock",{timeout:500,data:{wp_customize:"on",customize_theme:a.settings.theme.stylesheet,customize_changeset_uuid:a.settings.changeset.uuid,nonce:a.settings.nonce.dismiss_autosave_or_lock,dismiss_autosave:n,dismiss_lock:i}}).always(function(){t.resolve()}),t.promise()}var r=!1;t.bind("back",function(){r=!0}),a.bind("change",n),a.state("selectedChangesetStatus").bind(n),a.state("selectedChangesetDate").bind(n),t.bind("confirm-close",function(){o().done(function(){t.send("confirmed-close",!0)}).fail(function(){t.send("confirmed-close",!1)})}),s.on("click.customize-controls-close",function(e){e.preventDefault(),r?t.send("close"):o().done(function(){$(window).off("beforeunload.customize-confirm"),window.location.href=s.prop("href")})})}(),$.each(["saved","change"],function(e,n){a.bind(n,function(){t.send(n)})}),a.bind("title",function(e){t.send("title",e)}),a.settings.changeset.branching&&t.send("changeset-uuid",a.settings.changeset.uuid),t.send("ready"),$.each({background_image:{controls:["background_preset","background_position","background_size","background_repeat","background_attachment"],callback:function(e){return!!e}},show_on_front:{controls:["page_on_front","page_for_posts"],callback:function(e){return"page"===e}},header_textcolor:{controls:["header_textcolor"],callback:function(e){return"blank"!==e}}},function(e,t){a(e,function(e){$.each(t.controls,function(n,i){a.control(i,function(n){var i=function(e){n.container.toggle(t.callback(e))};i(e.get()),e.bind(i)})})})}),a.control("background_preset",function(e){var t,n,i,o,s,r;t={default:[!1,!1,!1,!1],fill:[!0,!1,!1,!1],fit:[!0,!1,!0,!1],repeat:[!0,!1,!1,!0],custom:[!0,!0,!0,!0]},n=[_wpCustomizeBackground.defaults["default-position-x"],_wpCustomizeBackground.defaults["default-position-y"],_wpCustomizeBackground.defaults["default-size"],_wpCustomizeBackground.defaults["default-repeat"],_wpCustomizeBackground.defaults["default-attachment"]],i={default:n,fill:["left","top","cover","no-repeat","fixed"],fit:["left","top","contain","no-repeat","fixed"],repeat:["left","top","auto","repeat","scroll"]},o=function(e){_.each(["background_position","background_size","background_repeat","background_attachment"],function(n,i){var o=a.control(n);o&&o.container.toggle(t[e][i])})},s=function(e){_.each(["background_position_x","background_position_y","background_size","background_repeat","background_attachment"],function(t,n){var o=a(t);o&&o.set(i[e][n])})},r=e.setting.get(),o(r),e.setting.bind("change",function(e){o(e),"custom"!==e&&s(e)})}),a.control("background_repeat",function(e){e.elements[0].unsync(a("background_repeat")),e.element=new a.Element(e.container.find("input")),e.element.set("no-repeat"!==e.setting()),e.element.bind(function(t){e.setting.set(t?"repeat":"no-repeat")}),e.setting.bind(function(t){e.element.set("no-repeat"!==t)})}),a.control("background_attachment",function(e){e.elements[0].unsync(a("background_attachment")),e.element=new a.Element(e.container.find("input")),e.element.set("fixed"!==e.setting()),e.element.bind(function(t){e.setting.set(t?"scroll":"fixed")}),e.setting.bind(function(t){e.element.set("fixed"!==t)})}),a.control("display_header_text",function(e){var t="";e.elements[0].unsync(a("header_textcolor")),e.element=new a.Element(e.container.find("input")),e.element.set("blank"!==e.setting()),e.element.bind(function(n){n||(t=a("header_textcolor").get()),e.setting.set(n?t:"blank")}),e.setting.bind(function(t){e.element.set("blank"!==t)})}),a("show_on_front","page_on_front","page_for_posts",function(e,t,n){var i=function(){var i=this,o,s,r="show_on_front_page_collision";o=parseInt(t(),10),s=parseInt(n(),10),"page"===e()&&(i===t&&o>0&&a.previewer.previewUrl.set(a.settings.url.home),i===n&&s>0&&a.previewer.previewUrl.set(a.settings.url.home+"?page_id="+s)),"page"===e()&&o&&s&&o===s?e.notifications.add(new a.Notification(r,{type:"error",message:a.l10n.pageOnFrontError})):e.notifications.remove(r)};e.bind(i),t.bind(i),n.bind(i),i.call(e,e()),a.control("show_on_front",function(e){e.deferred.embedded.done(function(){e.container.append(e.getNotificationsContainerElement())})})}),function(){var e=$.Deferred();a.section("custom_css",function(t){t.deferred.embedded.done(function(){t.expanded()?e.resolve(t):t.expanded.bind(function(n){n&&e.resolve(t)})})}),e.done(function e(t){var n=a.control("custom_css");n.container.find(".customize-control-title:first").addClass("screen-reader-text"),t.container.find(".section-description-buttons .section-description-close").on("click",function(){t.container.find(".section-meta .customize-section-description:first").removeClass("open").slideUp(),t.container.find(".customize-help-toggle").attr("aria-expanded","false").focus()}),n&&!n.setting.get()&&(t.container.find(".section-meta .customize-section-description:first").addClass("open").show().trigger("toggled"),t.container.find(".customize-help-toggle").attr("aria-expanded","true"))})}(),a.control("header_video",function(e){e.deferred.embedded.done(function(){var t=function(){var t=a.section(e.section()),n="video_header_not_available";t&&(e.active.get()?t.notifications.remove(n):t.notifications.add(new a.Notification(n,{type:"info",message:a.l10n.videoHeaderNotice})))};t(),e.active.bind(t)})}),a.previewer.bind("selective-refresh-setting-validities",function e(t){a._handleSettingValidities({settingValidities:t,focusInvalidControl:!1})}),a.previewer.bind("focus-control-for-setting",function(e){var t=[];a.control.each(function(n){var i=_.pluck(n.settings,"id");-1!==_.indexOf(i,e)&&t.push(n)}),t.length&&(t.sort(function(e,t){return e.priority()-t.priority()}),t[0].focus())}),a.previewer.bind("refresh",function(){a.previewer.refresh()}),a.state("paneVisible").bind(function(e){var t;t=window.matchMedia?window.matchMedia("screen and ( max-width: 640px )").matches:$(window).width()<=640,a.state("editShortcutVisibility").set(e||t?"visible":"hidden")}),window.matchMedia&&window.matchMedia("screen and ( max-width: 640px )").addListener(function(){var e=a.state("paneVisible");e.callbacks.fireWith(e,[e.get(),e.get()])}),a.previewer.bind("edit-shortcut-visibility",function(e){a.state("editShortcutVisibility").set(e)}),a.state("editShortcutVisibility").bind(function(e){a.previewer.send("edit-shortcut-visibility",e)}),a.bind("change",e),$(document).one("wp-before-tinymce-init",function(){(!window.tinymce.ui.FloatPanel.zIndex||window.tinymce.ui.FloatPanel.zIndex<500001)&&(window.tinymce.ui.FloatPanel.zIndex=500001)}),n.addClass("ready"),a.trigger("ready")}})}(wp,jQuery);
//# sourceMappingURL=./customize-controls-min.js.map