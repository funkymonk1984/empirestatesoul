!function(e){function s(){"function"!=typeof zxcvbn?setTimeout(s,50):(d.val(d.data("pw")),d.trigger("pwupdate").trigger("wp-check-valid-field"),1!==parseInt(v.data("start-masked"),10)?l.addClass("show-password"):v.trigger("click"))}function a(){var a=e("#pass-strength-result")[0];m=d.val(),l=d.parent(),p=e('<input type="text"/>').attr({id:"pass1-text",name:"pass1-text",autocomplete:"off"}).addClass(d[0].className).data("pw",d.data("pw")).val(d.val()).on(b,function(){p.val()!==m&&(u.val(p.val()),d.val(p.val()).trigger("pwupdate"),m=p.val())}),d.after(p),1===parseInt(d.data("reveal"),10)&&s(),d.on(b+" pwupdate",function(){d.val()!==m&&(m=d.val(),p.val()!==m&&p.val(m),d.add(p).removeClass("short bad good strong"),a.className&&(d.add(p).addClass(a.className),"short"===a.className||"bad"===a.className?(f.prop("checked")||g.prop("disabled",!0),h.show()):(g.prop("disabled",!1),h.hide())))})}function t(){v.data("toggle",0).attr({"aria-label":userProfileL10n.ariaHide}).find(".text").text(userProfileL10n.hide).end().find(".dashicons").removeClass("dashicons-visibility").addClass("dashicons-hidden"),p.focus(),c.attr("for","pass1-text")}function n(){v=r.find(".wp-hide-pw"),v.show().on("click",function(){1===parseInt(v.data("toggle"),10)?(l.addClass("show-password"),t(),_.isUndefined(p[0].setSelectionRange)||p[0].setSelectionRange(0,100)):(l.removeClass("show-password"),v.data("toggle",1).attr({"aria-label":userProfileL10n.ariaShow}).find(".text").text(userProfileL10n.show).end().find(".dashicons").removeClass("dashicons-hidden").addClass("dashicons-visibility"),d.focus(),c.attr("for","pass1"),_.isUndefined(d[0].setSelectionRange)||d[0].setSelectionRange(0,100))})}function i(){var i,o,v;r=e(".user-pass1-wrap"),c=r.find("th label").attr("for","pass1-text"),e(".user-pass2-wrap").hide(),w=e("#submit").on("click",function(){k=!1}),g=w.add(" #createusersub"),h=e(".pw-weak"),f=h.find(".pw-checkbox"),f.change(function(){g.prop("disabled",!f.prop("checked"))}),d=e("#pass1"),d.length&&a(),u=e("#pass2").on(b,function(){u.val().length>0&&(d.val(u.val()),u.val(""),m="",d.trigger("pwupdate"))}),d.is(":hidden")&&(d.prop("disabled",!0),u.prop("disabled",!0),p.prop("disabled",!0)),i=r.find(".wp-pwd"),o=r.find("button.wp-generate-pw"),n(),o.length&&i.hide(),o.show(),o.on("click",function(){k=!0,o.hide(),i.show(),d.attr("disabled",!1),u.attr("disabled",!1),p.attr("disabled",!1),0===p.val().length&&s(),_.defer(function(){p.focus(),_.isUndefined(p[0].setSelectionRange)||p[0].setSelectionRange(0,100)},0)}),v=r.find("button.wp-cancel-pw"),v.on("click",function(){k=!1,p.val(""),wp.ajax.post("generate-password").done(function(e){d.data("pw",e)}),o.show(),i.hide(),d.prop("disabled",!0),u.prop("disabled",!0),p.prop("disabled",!0),t(),d.val("").trigger("pwupdate"),g.prop("disabled",!1)}),r.closest("form").on("submit",function(){k=!1,d.prop("disabled",!1),u.prop("disabled",!1),u.val(d.val()),l.removeClass("show-password")})}function o(){var s,a=e("#pass1").val();if(e("#pass-strength-result").removeClass("short bad good strong"),!a)return void e("#pass-strength-result").html("&nbsp;");switch(s=wp.passwordStrength.meter(a,wp.passwordStrength.userInputBlacklist(),a)){case 2:e("#pass-strength-result").addClass("bad").html(pwsL10n.bad);break;case 3:e("#pass-strength-result").addClass("good").html(pwsL10n.good);break;case 4:e("#pass-strength-result").addClass("strong").html(pwsL10n.strong);break;case 5:e("#pass-strength-result").addClass("short").html(pwsL10n.mismatch);break;default:e("#pass-strength-result").addClass("short").html(pwsL10n["short"])}}var r,l,d,p,c,u,h,f,v,g,w,m,b,k=!1;b="oninput"in document.createElement("input")?"input":"keyup",e(document).ready(function(){var s,a,t,n,r=e("#display_name");e("#pass1").val("").on(b+" pwupdate",o),e("#pass-strength-result").show(),e(".color-palette").click(function(){e(this).siblings('input[name="admin_color"]').prop("checked",!0)}),r.length&&e("#first_name, #last_name, #nickname").bind("blur.user_profile",function(){var s=[],a={display_nickname:e("#nickname").val()||"",display_username:e("#user_login").val()||"",display_firstname:e("#first_name").val()||"",display_lastname:e("#last_name").val()||""};a.display_firstname&&a.display_lastname&&(a.display_firstlast=a.display_firstname+" "+a.display_lastname,a.display_lastfirst=a.display_lastname+" "+a.display_firstname),e.each(e("option",r),function(e,a){s.push(a.value)}),e.each(a,function(t,n){if(n){var i=n.replace(/<\/?[a-z][^>]*>/gi,"");a[t].length&&-1===e.inArray(i,s)&&(s.push(i),e("<option />",{text:i}).appendTo(r))}})}),s=e("#color-picker"),a=e("#colors-css"),t=e("input#user_id").val(),n=e('input[name="checkuser_id"]').val(),s.on("click.colorpicker",".color-option",function(){var s,i=e(this);if(!i.hasClass("selected")&&(i.siblings(".selected").removeClass("selected"),i.addClass("selected").find('input[type="radio"]').prop("checked",!0),t===n)){if(0===a.length&&(a=e('<link rel="stylesheet" />').appendTo("head")),a.attr("href",i.children(".css_url").val()),"undefined"!=typeof wp&&wp.svgPainter){try{s=e.parseJSON(i.children(".icon_colors").val())}catch(o){}s&&(wp.svgPainter.setColors(s),wp.svgPainter.paint())}e.post(ajaxurl,{action:"save-user-color-scheme",color_scheme:i.children('input[name="admin_color"]').val(),nonce:e("#color-nonce").val()}).done(function(s){s.success&&e("body").removeClass(s.data.previousScheme).addClass(s.data.currentScheme)})}}),i()}),e("#destroy-sessions").on("click",function(s){var a=e(this);wp.ajax.post("destroy-sessions",{nonce:e("#_wpnonce").val(),user_id:e("#user_id").val()}).done(function(e){a.prop("disabled",!0),a.siblings(".notice").remove(),a.before('<div class="notice notice-success inline"><p>'+e.message+"</p></div>")}).fail(function(e){a.siblings(".notice").remove(),a.before('<div class="notice notice-error inline"><p>'+e.message+"</p></div>")}),s.preventDefault()}),window.generatePassword=s,e(window).on("beforeunload",function(){return!0===k?userProfileL10n.warn:void 0})}(jQuery);