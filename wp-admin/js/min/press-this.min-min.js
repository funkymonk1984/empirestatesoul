!function(e,t){var s=function(){function s(e){return e&&t.pressThisL10n?t.pressThisL10n[e]||e:e||""}function n(e){return e=e||"",e.replace(/<!--[\s\S]*?(-->|$)/g,"").replace(/<(script|style)[^>]*>[\s\S]*?(<\/\1>|$)/gi,"").replace(/<\/?[a-z][\s\S]*?(>|$)/gi,"")}function a(e){var t=n(e);try{z.innerHTML=t,t=n(z.value)}catch(s){}return t}function i(t){return t=e.trim(t||""),/^(?:https?:)?\/\//.test(t)?(t=n(t),t.replace(/["\\]+/g,"")):""}function o(){e(".spinner").addClass("is-active"),e(".post-actions button").attr("disabled","disabled")}function r(){e(".spinner").removeClass("is-active"),e(".post-actions button").removeAttr("disabled")}function c(e){var s,n;(!j||j.isHidden())&&(e="reset"===e||ee&&ee>$.value.length,n=$.style.height,e?(s=t.pageYOffset,$.style.height="auto",$.style.height=Math.max($.scrollHeight,Z)+"px",t.scrollTo(t.pageXOffset,s)):parseInt($.style.height,10)<$.scrollHeight&&($.style.height=$.scrollHeight+"px"),ee=$.value.length)}function l(){if(!j)return!1;var e,t,s,n=j.selection.getNode();if(j.wp&&j.wp.getView&&(t=j.wp.getView(n)))s=t.getBoundingClientRect();else{e=j.selection.getRng();try{s=e.getClientRects()[0]}catch(a){}s||(s=n.getBoundingClientRect())}return s.height?s:!1}function d(e){var s=t.tinymce.util.VK,n=e.keyCode;47>=n&&n!==s.SPACEBAR&&n!==s.ENTER&&n!==s.DELETE&&n!==s.BACKSPACE&&n!==s.UP&&n!==s.LEFT&&n!==s.DOWN&&n!==s.UP||n>=91&&93>=n||n>=112&&123>=n||144===n||145===n||p(n)}function p(e){var s,n,a,i=l(),o=50,r=65,c=t.tinymce.util.VK;i&&(s=i.top+j.iframeElement.getBoundingClientRect().top,n=s+i.height,s-=o,n+=r,a=N.height(),a<i.height||(0>s&&(e===c.UP||e===c.LEFT||e===c.BACKSPACE)?t.scrollTo(t.pageXOffset,s+t.pageYOffset):n>a&&t.scrollTo(t.pageXOffset,n+t.pageYOffset-a)))}function u(){var t=e("#title-container");return t.find("img.emoji").each(function(){var t=e(this);t.replaceWith(e("<span>").text(t.attr("alt")))}),a(t.text())}function f(){var s=e("#pressthis-form"),n=e('<input type="hidden" name="post_category[]" value="">');j&&j.save(),e("#post_title").val(u()),t.tagBox&&e("div.tagsdiv").each(function(){t.tagBox.flushTags(this,!1,1)}),e(".categories-select .category").each(function(t,a){var i=e(a);i.hasClass("selected")&&s.append(n.clone().val(i.attr("data-term-id")||""))})}function h(n){var a;q=!1,o(),"publish"===n&&e("#post_status").val("publish"),f(),a=e("#pressthis-form").serialize(),e.ajax({type:"post",url:t.ajaxurl,data:a}).always(function(){r(),x(),e(".publish-button").removeClass("is-saving")}).done(function(e){if(e.success){if(e.data.redirect)if(t.opener&&(K.redirInParent||e.data.force))try{t.opener.location.href=e.data.redirect,t.setTimeout(function(){t.self.close()},200)}catch(s){t.location.href=e.data.redirect}else t.location.href=e.data.redirect}else b(e.data.errorMessage)}).fail(function(){b(s("serverError"))})}function g(e){var s,n,a="";s=i(e.attr("data-wp-src")||""),n=i(M.u),e.hasClass("is-image")?(n||(n=s),a='<a href="'+n+'"><img class="alignnone size-full" src="'+s+'" alt="" /></a>'):a="[embed]"+s+"[/embed]",j&&!j.isHidden()?Y?j.execCommand("mceInsertContent",!1,a):j.setContent("<p>"+a+"</p>"+j.getContent()):t.QTags&&t.QTags.insertContent(a)}function m(){var s,n=e("#new-category").val();n&&(s={action:"press-this-add-category",post_id:e("#post_ID").val()||0,name:n,new_cat_nonce:e("#_ajax_nonce-add-category").val()||"",parent:e("#new-category-parent").val()||0},e.post(t.ajaxurl,s,function(t){if(t.success){var s,n,a=e("ul.categories-select");e.each(t.data,function(t,i){var o=e("<li>").append(e('<div class="category selected" tabindex="0" role="checkbox" aria-checked="true">').attr("data-term-id",i.term_id).text(i.name));i.parent?(n&&n.length||(s=a.find('div[data-term-id="'+i.parent+'"]').parent(),n=s.find("ul.children:first"),n.length||(n=e('<ul class="children">').appendTo(s))),n.prepend(o)):a.prepend(o),o.focus()}),S()}else b(t.data.errorMessage)}))}function v(){M.hasData&&e("#scanbar").hide()}function C(t,s){var n=e(".editor-wrapper div.alerts"),a=s?"is-error":"is-notice";n.append(e('<p class="alert '+a+'">').text(t))}function b(e){C(e,!0)}function x(){e("div.alerts").empty()}function y(){M.errors&&e.each(M.errors,function(e,t){b(t)})}function w(e,t,n){var a=H.clone().addClass("is-image");a.attr("data-wp-src",e).css("background-image","url("+t+")").find("span").text(s("suggestedImgAlt").replace("%d",n+1)),L.append(a)}function k(){var t=0;L=e("ul.media-list"),H=e('<li class="suggested-media-thumbnail" tabindex="0"><span class="screen-reader-text"></span></li>'),M._embeds&&e.each(M._embeds,function(e,n){var a="",o="",r=H.clone().addClass("is-embed");n=i(n),n.indexOf("youtube.com/")>-1?(a="https://i.ytimg.com/vi/"+n.replace(/.+v=([^&]+).*/,"$1")+"/hqdefault.jpg",o+=" is-video"):n.indexOf("youtu.be/")>-1?(a="https://i.ytimg.com/vi/"+n.replace(/\/([^\/])$/,"$1")+"/hqdefault.jpg",o+=" is-video"):n.indexOf("dailymotion.com")>-1?(a=n.replace("/video/","/thumbnail/video/"),o+=" is-video"):o+=n.indexOf("soundcloud.com")>-1?" is-audio":n.indexOf("twitter.com")>-1?" is-tweet":" is-video",r.attr("data-wp-src",n).find("span").text(s("suggestedEmbedAlt").replace("%d",e+1)),a&&r.css("background-image","url("+a+")"),L.append(r),t++}),M._images&&e.each(M._images,function(e,s){var n,a=new Image;s=i(s),n=s.replace(/^(http[^\?]+)(\?.*)?$/,"$1"),n=s.indexOf("files.wordpress.com/")>-1?n.replace(/\?.*$/,"")+"?w="+V:s.indexOf("gravatar.com/")>-1?n.replace(/\?.*$/,"")+"?s="+V:s,a.onload=function(){a.width&&a.width<256||a.height&&a.height<128||w(s,n,e)},a.src=s,t++}),t&&e(".media-list-container").addClass("has-media")}function T(){var t=e(".post-options"),s=e(".post-option"),n=e(".setting-modal"),a=e(".modal-close");s.on("click",function(){var s=e(this).index(),a=n.eq(s);t.addClass(U).one(te,function(){e(this).addClass(W)}),a.removeClass(X).one(te,function(){e(this).find(".modal-close").focus()})}),a.on("click",function(){var n=e(this).parent(),a=n.index();t.removeClass(X),n.addClass(U),te?n.one(te,function(){e(this).addClass(W),s.eq(a-1).focus()}):setTimeout(function(){n.addClass(W),s.eq(a-1).focus()},350)})}function E(){F=!0,e(".options").removeClass("closed").addClass("open"),e(".press-this-actions, #scanbar").addClass(W),e(".options-panel-back").removeClass(W),e(".options-panel").removeClass(X).one(te,function(){e(".post-option:first").focus()})}function O(){F=!1,e(".options").removeClass("open").addClass("closed"),e(".options-panel-back").addClass(W),e(".press-this-actions, #scanbar").removeClass(W),e(".options-panel").addClass(U).one(te,function(){e(this).addClass(W),e(".post-options").removeClass(X),e(".setting-modal").addClass(X)})}function _(){var s=e("#title-container"),n=e(".post-title-placeholder");s.on("focus",function(){n.addClass("is-hidden")}).on("blur",function(){s.text()||s.html()||n.removeClass("is-hidden")}).on("keyup",function(){q=!0}).on("paste",function(n){var a,i,o=n.originalEvent.clipboardData||t.clipboardData;if(o){try{a=o.getData("Text")||o.getData("text/plain"),a&&(a=e.trim(a.replace(/\s+/g," ")),t.getSelection?(i=t.getSelection().getRangeAt(0),i&&(i.collapsed||i.deleteContents(),i.insertNode(document.createTextNode(a)))):document.selection&&(i=document.selection.createRange(),i&&(i.text=a)))}catch(r){}n.preventDefault()}q=!0,setTimeout(function(){s.text(u())},50)}),(s.text()||s.html())&&n.addClass("is-hidden")}function A(e){e.hasClass("selected")?e.removeClass("selected").attr("aria-checked","false"):e.addClass("selected").attr("aria-checked","true")}function D(){e(".categories-select").on("click.press-this keydown.press-this",function(t){var s=e(t.target);if(s.is("div.category")){if("keydown"===t.type&&32!==t.keyCode)return;A(s),t.preventDefault()}})}function P(){e(".split-button").removeClass("is-open"),e(".split-button-toggle").attr("aria-expanded","false")}function B(){v(),k(),y(),t.tagBox&&t.tagBox.init(),G&&e(document.body).css("cursor","pointer")}function R(){var n=e(".split-button");return I.on("tinymce-editor-init",function(e,t){j=t,j.on("nodechange",function(){Y=!0}),j.on("focus",function(){P()}),j.on("show",function(){setTimeout(function(){j.execCommand("wpAutoResize")},300)}),j.on("hide",function(){setTimeout(function(){c("reset")},100)}),j.on("keyup",d),j.on("undo redo",p)}).on("click.press-this keypress.press-this",".suggested-media-thumbnail",function(t){("click"===t.type||13===t.keyCode)&&g(e(this))}).on("click.press-this",function(t){e(t.target).closest("button").hasClass("split-button-toggle")||P()}),e(".post-actions").on("click.press-this",function(s){var a,i=e(s.target),o=i.closest("button");o.length&&(o.hasClass("draft-button")?(e(".publish-button").addClass("is-saving"),h("draft")):o.hasClass("publish-button")?(o.addClass("is-saving"),t.history.replaceState&&(a=t.location.href,a+=-1!==a.indexOf("?")?"&":"?",a+="wp-press-this-reload=true",t.history.replaceState(null,null,a)),h("publish")):o.hasClass("preview-button")?(f(),t.opener&&t.opener.focus(),e("#wp-preview").val("dopreview"),e("#pressthis-form").attr("target","_blank").submit().attr("target",""),e("#wp-preview").val("")):o.hasClass("standard-editor-button")?(e(".publish-button").addClass("is-saving"),e("#pt-force-redirect").val("true"),h("draft")):o.hasClass("split-button-toggle")&&(n.hasClass("is-open")?(n.removeClass("is-open"),o.attr("aria-expanded","false")):(n.addClass("is-open"),o.attr("aria-expanded","true"))))}),T(),_(),D(),e(".options").on("click.press-this",function(){e(this).hasClass("open")?O():E()}),e(".options-panel, .options-panel-back").on("focusout.press-this",function(){setTimeout(function(){var t=document.activeElement,s=e(t);!F||!t||s.hasClass("options-panel-back")||"BODY"!==t.nodeName&&(s.closest(".options-panel").length||s.closest(".options").length)||O()},50)}),e("#post-formats-select input").on("change",function(){var t=e(this);t.is(":checked")&&e("#post-option-post-format").text(e('label[for="'+t.attr("id")+'"]').text()||"")}),N.on("beforeunload.press-this",function(){return q||j&&j.isDirty()?s("saveAlert"):void 0}).on("resize.press-this",function(){(!j||j.isHidden())&&c("reset")}),e("button.add-cat-toggle").on("click.press-this",function(){var t=e(this);t.toggleClass("is-toggled"),t.attr("aria-expanded","false"===t.attr("aria-expanded")?"true":"false"),e(".setting-modal .add-category, .categories-search-wrapper").toggleClass("is-hidden")}),e("button.add-cat-submit").on("click.press-this",m),e(".categories-search").on("keyup.press-this",function(){var t=e(this).val().toLowerCase()||"";/[\x20-\xFF]+/.test(t)&&t.length<2||(e.each(Q,function(e,t){t.node.removeClass("is-hidden searched-parent")}),t&&e.each(Q,function(e,s){-1===s.text.indexOf(t)?s.node.addClass("is-hidden"):s.parents.addClass("searched-parent")}))}),J.on("focus.press-this input.press-this propertychange.press-this",c),!0}function S(){e(".categories-select").find("li").each(function(){var t=e(this);Q.push({node:t,parents:t.parents("li"),text:t.children(".category").text().toLowerCase()})})}var j,L,H,N=e(t),I=e(document),q=!1,z=document.createElement("textarea"),F=!1,K=t.wpPressThisConfig||{},M=t.wpPressThisData||{},V=128,Y=!1,Q=[],U="is-off-screen",W="is-hidden",X=U+" "+W,G=/iPad|iPod|iPhone/.test(t.navigator.userAgent),J=e("#pressthis"),$=J[0],Z=600,ee=0,te=function(){var e=document.documentElement.style;return"undefined"!=typeof e.transition?"transitionend":"undefined"!=typeof e.WebkitTransition?"webkitTransitionEnd":!1}();return I.ready(function(){B(),R(),S()}),{renderNotice:C,renderError:b}};t.wp=t.wp||{},t.wp.pressThis=new s}(jQuery,window);