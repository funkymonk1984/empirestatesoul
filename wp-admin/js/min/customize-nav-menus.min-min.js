!function(e,t,n){"use strict";function i(e){return"nav_menu_item["+e+"]"}function a(t){return t=t||"",t=n("<div>").text(t).html(),(t=n.trim(t))||e.Menus.data.l10n.unnamed}wpNavMenu.originalInit=wpNavMenu.init,wpNavMenu.options.menuItemDepthPerLevel=20,wpNavMenu.options.sortableItems="> .customize-control-nav_menu_item",wpNavMenu.options.targetTolerance=10,wpNavMenu.init=function(){this.jQueryExtensions()},e.Menus=e.Menus||{},e.Menus.data={itemTypes:[],l10n:{},settingTransport:"refresh",phpIntMax:0,defaultSettingValues:{nav_menu:{},nav_menu_item:{}},locationSlugMappedToName:{}},"undefined"!=typeof _wpCustomizeNavMenusSettings&&n.extend(e.Menus.data,_wpCustomizeNavMenusSettings),e.Menus.generatePlaceholderAutoIncrementId=function(){return-Math.ceil(e.Menus.data.phpIntMax*Math.random())},e.Menus.AvailableItemModel=Backbone.Model.extend(n.extend({id:null},e.Menus.data.defaultSettingValues.nav_menu_item)),e.Menus.AvailableItemCollection=Backbone.Collection.extend({model:e.Menus.AvailableItemModel,sort_key:"order",comparator:function(e){return-e.get(this.sort_key)},sortByField:function(e){this.sort_key=e,this.sort()}}),e.Menus.availableMenuItems=new e.Menus.AvailableItemCollection(e.Menus.data.availableMenuItems),e.Menus.insertAutoDraftPost=function(i){var a,o=n.Deferred();return a=t.ajax.post("customize-nav-menus-insert-auto-draft",{"customize-menus-nonce":e.settings.nonce["customize-menus"],wp_customize:"on",customize_changeset_uuid:e.settings.changeset.uuid,params:i}),a.done(function(t){t.post_id&&(e("nav_menus_created_posts").set(e("nav_menus_created_posts").get().concat([t.post_id])),"page"===i.post_type&&(e.section.has("static_front_page")&&e.section("static_front_page").activate(),e.control.each(function(e){var n;"dropdown-pages"===e.params.type&&(n=e.container.find('select[name^="_customize-dropdown-pages-"]'),n.append(new Option(i.post_title,t.post_id)))})),o.resolve(t))}),a.fail(function(e){var t=e||"";void 0!==e.message&&(t=e.message),console.error(t),o.rejectWith(t)}),o.promise()},e.Menus.AvailableMenuItemsPanelView=t.Backbone.View.extend({el:"#available-menu-items",events:{"input #menu-items-search":"debounceSearch","keyup #menu-items-search":"debounceSearch","focus .menu-item-tpl":"focus","click .menu-item-tpl":"_submit","click #custom-menu-item-submit":"_submitLink","keypress #custom-menu-item-name":"_submitLink","click .new-content-item .add-content":"_submitNew","keypress .create-item-input":"_submitNew",keydown:"keyboardAccessible"},selected:null,currentMenuControl:null,debounceSearch:null,$search:null,$clearResults:null,searchTerm:"",rendered:!1,pages:{},sectionContent:"",loading:!1,addingNew:!1,initialize:function(){var t=this;e.panel.has("nav_menus")&&(this.$search=n("#menu-items-search"),this.$clearResults=this.$el.find(".clear-results"),this.sectionContent=this.$el.find(".available-menu-items-list"),this.debounceSearch=_.debounce(t.search,500),_.bindAll(this,"close"),n("#customize-controls, .customize-section-back").on("click keydown",function(e){var i=n(e.target).is(".item-delete, .item-delete *"),a=n(e.target).is(".add-new-menu-item, .add-new-menu-item *");!n("body").hasClass("adding-menu-items")||i||a||t.close()}),this.$clearResults.on("click",function(){t.$search.val("").focus().trigger("keyup")}),this.$el.on("input","#custom-menu-item-name.invalid, #custom-menu-item-url.invalid",function(){n(this).removeClass("invalid")}),e.panel("nav_menus").container.bind("expanded",function(){t.rendered||(t.initList(),t.rendered=!0)}),this.sectionContent.scroll(function(){var e=t.$el.find(".accordion-section.open .available-menu-items-list").prop("scrollHeight"),i=t.$el.find(".accordion-section.open").height();if(!t.loading&&n(this).scrollTop()>.75*e-i){var a=n(this).data("type"),o=n(this).data("object");"search"===a?t.searchTerm&&t.doSearch(t.pages.search):t.loadItems([{type:a,object:o}])}}),e.previewer.bind("url",this.close),t.delegateEvents())},search:function(e){var t=n("#available-menu-items-search"),i=n("#available-menu-items .accordion-section").not(t);e&&this.searchTerm!==e.target.value&&(""===e.target.value||t.hasClass("open")?""===e.target.value&&(t.removeClass("open"),i.show(),this.$clearResults.removeClass("is-visible")):(i.fadeOut(100),t.find(".accordion-section-content").slideDown("fast"),t.addClass("open"),this.$clearResults.addClass("is-visible")),this.searchTerm=e.target.value,this.pages.search=1,this.doSearch(1))},doSearch:function(i){var a,o=this,s=n("#available-menu-items-search"),r=s.find(".accordion-section-content"),u=t.template("available-menu-item");if(o.currentRequest&&o.currentRequest.abort(),!(i<0)){if(i>1)s.addClass("loading-more"),r.attr("aria-busy","true"),t.a11y.speak(e.Menus.data.l10n.itemsLoadingMore);else if(""===o.searchTerm)return r.html(""),void t.a11y.speak("");s.addClass("loading"),o.loading=!0,a=e.previewer.query({excludeCustomizedSaved:!0}),_.extend(a,{"customize-menus-nonce":e.settings.nonce["customize-menus"],wp_customize:"on",search:o.searchTerm,page:i}),o.currentRequest=t.ajax.post("search-available-menu-items-customizer",a),o.currentRequest.done(function(n){var a;1===i&&r.empty(),s.removeClass("loading loading-more"),r.attr("aria-busy","false"),s.addClass("open"),o.loading=!1,a=new e.Menus.AvailableItemCollection(n.items),o.collection.add(a.models),a.each(function(e){r.append(u(e.attributes))}),20>a.length?o.pages.search=-1:o.pages.search=o.pages.search+1,a&&i>1?t.a11y.speak(e.Menus.data.l10n.itemsFoundMore.replace("%d",a.length)):a&&1===i&&t.a11y.speak(e.Menus.data.l10n.itemsFound.replace("%d",a.length))}),o.currentRequest.fail(function(e){e.message&&(r.empty().append(n('<li class="nothing-found"></li>').text(e.message)),t.a11y.speak(e.message)),o.pages.search=-1}),o.currentRequest.always(function(){s.removeClass("loading loading-more"),r.attr("aria-busy","false"),o.loading=!1,o.currentRequest=null})}},initList:function(){var t=this;_.each(e.Menus.data.itemTypes,function(e){t.pages[e.type+":"+e.object]=0}),t.loadItems(e.Menus.data.itemTypes)},loadItems:function(i,a){var o,s,r,u,d=this,c=[],l={};u=t.template("available-menu-item"),o=_.isString(i)&&_.isString(a)?[{type:i,object:a}]:i,_.each(o,function(e){var t,i=e.type+":"+e.object;-1!==d.pages[i]&&(t=n("#available-menu-items-"+e.type+"-"+e.object),t.find(".accordion-section-title").addClass("loading"),l[i]=t,c.push({object:e.object,type:e.type,page:d.pages[i]}))}),0!==c.length&&(d.loading=!0,s=e.previewer.query({excludeCustomizedSaved:!0}),_.extend(s,{"customize-menus-nonce":e.settings.nonce["customize-menus"],wp_customize:"on",item_types:c}),r=t.ajax.post("load-available-menu-items-customizer",s),r.done(function(t){var n;_.each(t.items,function(t,i){return 0===t.length?(0===d.pages[i]&&l[i].find(".accordion-section-title").addClass("cannot-expand").removeClass("loading").find(".accordion-section-title > button").prop("tabIndex",-1),void(d.pages[i]=-1)):("post_type:page"!==i||l[i].hasClass("open")||l[i].find(".accordion-section-title > button").click(),t=new e.Menus.AvailableItemCollection(t),d.collection.add(t.models),n=l[i].find(".available-menu-items-list"),t.each(function(e){n.append(u(e.attributes))}),void(d.pages[i]+=1))})}),r.fail(function(e){"undefined"!=typeof console&&console.error&&console.error(e)}),r.always(function(){_.each(l,function(e){e.find(".accordion-section-title").removeClass("loading")}),d.loading=!1}))},itemSectionHeight:function(){var e,t,n,i,a;n=window.innerHeight,e=this.$el.find(".accordion-section:not( #available-menu-items-search ) .accordion-section-content"),t=this.$el.find('.accordion-section:not( #available-menu-items-search ) .available-menu-items-list:not(":only-child")'),i=46*(1+e.length)+14,120<(a=n-i)&&290>a&&(e.css("max-height",a),t.css("max-height",a-60))},select:function(e){this.selected=n(e),this.selected.siblings(".menu-item-tpl").removeClass("selected"),this.selected.addClass("selected")},focus:function(e){this.select(n(e.currentTarget))},_submit:function(e){"keypress"===e.type&&13!==e.which&&32!==e.which||this.submit(n(e.currentTarget))},submit:function(e){var t,i;e||(e=this.selected),e&&this.currentMenuControl&&(this.select(e),t=n(this.selected).data("menu-item-id"),(i=this.collection.findWhere({id:t}))&&(this.currentMenuControl.addItemToMenu(i.attributes),n(e).find(".menu-item-handle").addClass("item-added")))},_submitLink:function(e){"keypress"===e.type&&13!==e.which||this.submitLink()},submitLink:function(){var t,i,a=n("#custom-menu-item-name"),o=n("#custom-menu-item-url");if(this.currentMenuControl){if(i=/^((\w+:)?\/\/\w.*|\w+:(?!\/\/$)|\/|\?|#)/,""===a.val())return void a.addClass("invalid");if(!i.test(o.val()))return void o.addClass("invalid");t={title:a.val(),url:o.val(),type:"custom",type_label:e.Menus.data.l10n.custom_label,object:"custom"},this.currentMenuControl.addItemToMenu(t),o.val("http://"),a.val("")}},_submitNew:function(e){var t;"keypress"===e.type&&13!==e.which||this.addingNew||(t=n(e.target).closest(".accordion-section"),this.submitNew(t))},submitNew:function(i){var a,o=this,s=i.find(".create-item-input"),r=s.val(),u=i.find(".available-menu-items-list"),d=u.data("type"),c=u.data("object"),l=u.data("type_label");if(this.currentMenuControl&&"post_type"===d){if(""===n.trim(s.val()))return s.addClass("invalid"),void s.focus();s.removeClass("invalid"),i.find(".accordion-section-title").addClass("loading"),o.addingNew=!0,s.attr("disabled","disabled"),a=e.Menus.insertAutoDraftPost({post_title:r,post_type:c}),a.done(function(a){var r,u,m;r=new e.Menus.AvailableItemModel({id:"post-"+a.post_id,title:s.val(),type:d,type_label:l,object:c,object_id:a.post_id,url:a.url}),o.currentMenuControl.addItemToMenu(r.attributes),e.Menus.availableMenuItemsPanel.collection.add(r),u=i.find(".available-menu-items-list"),m=n(t.template("available-menu-item")(r.attributes)),m.find(".menu-item-handle:first").addClass("item-added"),u.prepend(m),u.scrollTop(),s.val("").removeAttr("disabled"),o.addingNew=!1,i.find(".accordion-section-title").removeClass("loading")})}},open:function(t){var i,a=this;this.currentMenuControl=t,this.itemSectionHeight(),e.section.has("publish_settings")&&e.section("publish_settings").collapse(),n("body").addClass("adding-menu-items"),i=function(){a.close(),n(this).off("click",i)},n("#customize-preview").on("click",i),_(this.currentMenuControl.getMenuItemControls()).each(function(e){e.collapseForm()}),this.$el.find(".selected").removeClass("selected"),this.$search.focus()},close:function(e){e=e||{},e.returnFocus&&this.currentMenuControl&&this.currentMenuControl.container.find(".add-new-menu-item").focus(),this.currentMenuControl=null,this.selected=null,n("body").removeClass("adding-menu-items"),n("#available-menu-items .menu-item-handle.item-added").removeClass("item-added"),this.$search.val("").trigger("keyup")},keyboardAccessible:function(e){var t=13===e.which,i=27===e.which,a=9===e.which&&e.shiftKey,o=n(e.target).is(this.$search);t&&!this.$search.val()||(o&&a?(this.currentMenuControl.container.find(".add-new-menu-item").focus(),e.preventDefault()):i&&this.close({returnFocus:!0}))}}),e.Menus.MenusPanel=e.Panel.extend({attachEvents:function(){e.Panel.prototype.attachEvents.call(this);var t=this,i=t.container.find(".panel-meta"),a=i.find(".customize-help-toggle"),o=i.find(".customize-panel-description"),s=n("#screen-options-wrap"),r=i.find(".customize-screen-options-toggle");r.on("click keydown",function(t){if(!e.utils.isKeydownButNotEnterEvent(t))return t.preventDefault(),o.not(":hidden")&&(o.slideUp("fast"),a.attr("aria-expanded","false")),"true"===r.attr("aria-expanded")?(r.attr("aria-expanded","false"),i.removeClass("open"),i.removeClass("active-menu-screen-options"),s.slideUp("fast")):(r.attr("aria-expanded","true"),i.addClass("open"),i.addClass("active-menu-screen-options"),s.slideDown("fast")),!1}),a.on("click keydown",function(t){e.utils.isKeydownButNotEnterEvent(t)||(t.preventDefault(),"true"===r.attr("aria-expanded")&&(r.attr("aria-expanded","false"),a.attr("aria-expanded","true"),i.addClass("open"),i.removeClass("active-menu-screen-options"),s.slideUp("fast"),o.slideDown("fast")))})},ready:function(){var n=this;n.container.find(".hide-column-tog").click(function(){n.saveManageColumnsState()}),e.section("menu_locations",function(n){n.headContainer.prepend(t.template("nav-menu-locations-header")(e.Menus.data))})},saveManageColumnsState:_.debounce(function(){var e=this;e._updateHiddenColumnsRequest&&e._updateHiddenColumnsRequest.abort(),e._updateHiddenColumnsRequest=t.ajax.post("hidden-columns",{hidden:e.hidden(),screenoptionnonce:n("#screenoptionnonce").val(),page:"nav-menus"}),e._updateHiddenColumnsRequest.always(function(){e._updateHiddenColumnsRequest=null})},2e3),checked:function(){},unchecked:function(){},hidden:function(){return n(".hide-column-tog").not(":checked").map(function(){var e=this.id;return e.substring(0,e.length-5)}).get().join(",")}}),e.Menus.MenuSection=e.Section.extend({initialize:function(t,i){var a=this;e.Section.prototype.initialize.call(a,t,i),a.deferred.initSortables=n.Deferred()},ready:function(){var t,i,a=this;if(void 0===a.params.menu_id)throw new Error("params.menu_id was not defined");a.active.validate=function(){return!!e.has(a.id)&&!!e(a.id).get()},a.populateControls(),a.navMenuLocationSettings={},a.assignedLocations=new e.Value([]),e.each(function(e,t){var n=t.match(/^nav_menu_locations\[(.+?)]/);n&&(a.navMenuLocationSettings[n[1]]=e,e.bind(function(){a.refreshAssignedLocations()}))}),a.assignedLocations.bind(function(e){a.updateAssignedLocationsInSectionTitle(e)}),a.refreshAssignedLocations(),e.bind("pane-contents-reflowed",function(){a.contentContainer.parent().length&&(a.container.find(".menu-item .menu-item-reorder-nav button").attr({tabindex:"0","aria-hidden":"false"}),a.container.find(".menu-item.move-up-disabled .menus-move-up").attr({tabindex:"-1","aria-hidden":"true"}),a.container.find(".menu-item.move-down-disabled .menus-move-down").attr({tabindex:"-1","aria-hidden":"true"}),a.container.find(".menu-item.move-left-disabled .menus-move-left").attr({tabindex:"-1","aria-hidden":"true"}),a.container.find(".menu-item.move-right-disabled .menus-move-right").attr({tabindex:"-1","aria-hidden":"true"}))}),i=function(){var e="field-"+n(this).val()+"-active";a.contentContainer.toggleClass(e,n(this).prop("checked"))},t=e.panel("nav_menus").contentContainer.find(".metabox-prefs:first").find(".hide-column-tog"),t.each(i),t.on("click",i)},populateControls:function(){var t,n,i,a,o,s,r,u,d,c=this;t=c.id+"[name]",s=e.control(t),s||(s=new e.controlConstructor.nav_menu_name(t,{type:"nav_menu_name",label:e.Menus.data.l10n.menuNameLabel,section:c.id,priority:0,settings:{default:c.id}}),e.control.add(s),s.active.set(!0)),o=e.control(c.id),o||(o=new e.controlConstructor.nav_menu(c.id,{type:"nav_menu",section:c.id,priority:998,settings:{default:c.id},menu_id:c.params.menu_id}),e.control.add(o),o.active.set(!0)),n=c.id+"[locations]",r=e.control(n),r||(r=new e.controlConstructor.nav_menu_locations(n,{section:c.id,priority:999,settings:{default:c.id},menu_id:c.params.menu_id}),e.control.add(r.id,r),o.active.set(!0)),i=c.id+"[auto_add]",u=e.control(i),u||(u=new e.controlConstructor.nav_menu_auto_add(i,{type:"nav_menu_auto_add",label:"",section:c.id,priority:1e3,settings:{default:c.id}}),e.control.add(u),u.active.set(!0)),a=c.id+"[delete]",(d=e.control(a))||(d=new e.Control(a,{section:c.id,priority:1001,templateId:"nav-menu-delete-button"}),e.control.add(d.id,d),d.active.set(!0),d.deferred.embedded.done(function(){d.container.find("button").on("click",function(){var t=c.params.menu_id;e.Menus.getMenuControl(t).setting.set(!1)})}))},refreshAssignedLocations:function(){var e=this,t=e.params.menu_id,n=[];_.each(e.navMenuLocationSettings,function(e,i){e()===t&&n.push(i)}),e.assignedLocations.set(n)},updateAssignedLocationsInSectionTitle:function(t){var i,a=this;i=a.container.find(".accordion-section-title:first"),i.find(".menu-in-location").remove(),_.each(t,function(t){var a,o;a=n('<span class="menu-in-location"></span>'),o=e.Menus.data.locationSlugMappedToName[t],a.text(e.Menus.data.l10n.menuLocation.replace("%s",o)),i.append(a)}),a.container.toggleClass("assigned-to-menu-location",0!==t.length)},onChangeExpanded:function(t,i){var a,o=this;t&&(wpNavMenu.menuList=o.contentContainer,wpNavMenu.targetList=wpNavMenu.menuList,n("#menu-to-edit").removeAttr("id"),wpNavMenu.menuList.attr("id","menu-to-edit").addClass("menu"),_.each(e.section(o.id).controls(),function(e){"nav_menu_item"===e.params.type&&e.actuallyEmbed()}),i.completeCallback&&(a=i.completeCallback),i.completeCallback=function(){"resolved"!==o.deferred.initSortables.state()&&(wpNavMenu.initSortables(),o.deferred.initSortables.resolve(wpNavMenu.menuList),e.control("nav_menu["+String(o.params.menu_id)+"]").reflowMenuItems()),_.isFunction(a)&&a()}),e.Section.prototype.onChangeExpanded.call(o,t,i)},highlightNewItemButton:function(){e.utils.highlightButton(this.contentContainer.find(".add-new-menu-item"),{delay:2e3})}}),e.Menus.createNavMenu=function(t){var i,o,s;return o=e.Menus.generatePlaceholderAutoIncrementId(),i="nav_menu["+String(o)+"]",s=e.create(i,i,{},{type:"nav_menu",transport:e.Menus.data.settingTransport,previewer:e.previewer}),s.set(n.extend({},e.Menus.data.defaultSettingValues.nav_menu,{name:t||""})),e.section.add(new e.Menus.MenuSection(i,{panel:"nav_menus",title:a(t),customizeAction:e.Menus.data.l10n.customizingMenus,priority:10,menu_id:o}))},e.Menus.NewMenuSection=e.Section.extend({attachEvents:function(){function n(){var t=0;return e.each(function(e){d.test(e.id)&&!1!==e.get()&&(t+=1)}),t}function i(){r.find(".add-new-menu-notice").prop("hidden",n()>0)}function a(e){d.test(e.id)&&(e.bind(i),i())}function o(e){d.test(e.id)&&(e.unbind(i),i())}var s=this,r=s.container,u=s.contentContainer,d=/^nav_menu\[/;s.headContainer.find(".accordion-section-title").replaceWith(t.template("nav-menu-create-menu-section-title")),r.on("click",".customize-add-menu-button",function(){s.expand()}),u.on("keydown",".menu-name-field",function(e){13===e.which&&s.submit()}),u.on("click","#customize-new-menu-submit",function(e){s.submit(),e.stopPropagation(),e.preventDefault()}),e.each(a),e.bind("add",a),e.bind("removed",o),i(),e.Section.prototype.attachEvents.apply(s,arguments)},ready:function(){this.populateControls()},populateControls:function(){var t,n,i,a,o,s,r=this;t=r.id+"[name]",a=e.control(t),a||(a=new e.controlConstructor.nav_menu_name(t,{label:e.Menus.data.l10n.menuNameLabel,description:e.Menus.data.l10n.newMenuNameDescription,section:r.id,priority:0}),e.control.add(a.id,a),a.active.set(!0)),n=r.id+"[locations]",o=e.control(n),o||(o=new e.controlConstructor.nav_menu_locations(n,{section:r.id,priority:1,menu_id:"",isCreating:!0}),e.control.add(n,o),o.active.set(!0)),i=r.id+"[submit]",(s=e.control(i))||(s=new e.Control(i,{section:r.id,priority:1,templateId:"nav-menu-submit-new-button"}),e.control.add(i,s),s.active.set(!0))},submit:function(){var i,a=this,o=a.contentContainer,s=o.find(".menu-name-field").first(),r=s.val();return r?(i=e.Menus.createNavMenu(r),s.val(""),s.removeClass("invalid"),o.find(".assigned-menu-location input[type=checkbox]").each(function(){var t,a=n(this);a.prop("checked")&&(t=e("nav_menu_locations["+a.data("location-id")+"]"),t.set(i.params.menu_id),a.prop("checked",!1))}),t.a11y.speak(e.Menus.data.l10n.menuAdded),void i.focus({completeCallback:function(){i.highlightNewItemButton()}})):(s.addClass("invalid"),void s.focus())},selectDefaultLocation:function(t){var n=e.control(this.id+"[locations]"),i={};null!==t&&(i[t]=!0),n.setSelections(i)}}),e.Menus.MenuLocationControl=e.Control.extend({initialize:function(t,n){var i=this,a=t.match(/^nav_menu_locations\[(.+?)]/);i.themeLocation=a[1],e.Control.prototype.initialize.call(i,t,n)},ready:function(){var t=this,n=/^nav_menu\[(-?\d+)]/;t.setting.validate=function(e){return""===e?0:parseInt(e,10)},t.container.find(".create-menu").on("click",function(){var t=e.section("add_menu");t.selectDefaultLocation(this.dataset.locationId),t.focus()}),t.container.find(".edit-menu").on("click",function(){var n=t.setting();e.section("nav_menu["+n+"]").focus()}),t.setting.bind("change",function(){var e=0!==t.setting();t.container.find(".create-menu").toggleClass("hidden",e),t.container.find(".edit-menu").toggleClass("hidden",!e)}),e.bind("add",function(e){var i,o,s=e.id.match(n);s&&!1!==e()&&(o=s[1],i=new Option(a(e().name),o),t.container.find("select").append(i))}),e.bind("remove",function(e){var i,a=e.id.match(n);a&&(i=parseInt(a[1],10),t.setting()===i&&t.setting.set(""),t.container.find("option[value="+i+"]").remove())}),e.bind("change",function(e){var i,o=e.id.match(n);o&&(i=parseInt(o[1],10),!1===e()?(t.setting()===i&&t.setting.set(""),t.container.find("option[value="+i+"]").remove()):t.container.find("option[value="+i+"]").text(a(e().name)))})}}),e.Menus.MenuItemControl=e.Control.extend({initialize:function(t,i){var a=this;a.expanded=new e.Value(!1),a.expandedArgumentsQueue=[],a.expanded.bind(function(e){var t=a.expandedArgumentsQueue.shift();t=n.extend({},a.defaultExpandedArguments,t),a.onChangeExpanded(e,t)}),e.Control.prototype.initialize.call(a,t,i),a.active.validate=function(){var t,n=e.section(a.section());return t=!!n&&n.active()}},embed:function(){var t,n=this,i=n.section();i&&((t=e.section(i))&&t.expanded()||e.settings.autofocus.control===n.id)&&n.actuallyEmbed()},actuallyEmbed:function(){var e=this;"resolved"!==e.deferred.embedded.state()&&(e.renderContent(),e.deferred.embedded.resolve())},ready:function(){if(void 0===this.params.menu_item_id)throw new Error("params.menu_item_id was not defined");this._setupControlToggle(),this._setupReorderUI(),this._setupUpdateUI(),this._setupRemoveUI(),this._setupLinksUI(),this._setupTitleUI()},_setupControlToggle:function(){var t=this;this.container.find(".menu-item-handle").on("click",function(i){i.preventDefault(),i.stopPropagation();var a=t.getMenuControl(),o=n(i.target).is(".item-delete, .item-delete *"),s=n(i.target).is(".add-new-menu-item, .add-new-menu-item *");!n("body").hasClass("adding-menu-items")||o||s||e.Menus.availableMenuItemsPanel.close(),a.isReordering||a.isSorting||t.toggleForm()})},_setupReorderUI:function(){var e,i,a=this;e=t.template("menu-item-reorder-nav"),a.container.find(".item-controls").after(e),i=a.container.find(".menu-item-reorder-nav"),i.find(".menus-move-up, .menus-move-down, .menus-move-left, .menus-move-right").on("click",function(){var e=n(this);e.focus();var t=e.is(".menus-move-up"),i=e.is(".menus-move-down"),o=e.is(".menus-move-left"),s=e.is(".menus-move-right");t?a.moveUp():i?a.moveDown():o?a.moveLeft():s&&a.moveRight(),e.focus()})},_setupUpdateUI:function(){var t,n=this,i=n.setting();n.elements={},n.elements.url=new e.Element(n.container.find(".edit-menu-item-url")),n.elements.title=new e.Element(n.container.find(".edit-menu-item-title")),n.elements.attr_title=new e.Element(n.container.find(".edit-menu-item-attr-title")),n.elements.target=new e.Element(n.container.find(".edit-menu-item-target")),n.elements.classes=new e.Element(n.container.find(".edit-menu-item-classes")),n.elements.xfn=new e.Element(n.container.find(".edit-menu-item-xfn")),n.elements.description=new e.Element(n.container.find(".edit-menu-item-description")),_.each(n.elements,function(e,t){e.bind(function(i){e.element.is("input[type=checkbox]")&&(i=i?e.element.val():"");var a=n.setting();a&&a[t]!==i&&(a=_.clone(a),a[t]=i,n.setting.set(a))}),i&&("classes"!==t&&"xfn"!==t||!_.isArray(i[t])?e.set(i[t]):e.set(i[t].join(" ")))}),n.setting.bind(function(t,i){var a,o=n.params.menu_item_id,s=[],r=[];!1===t?(a=e.control("nav_menu["+String(i.nav_menu_term_id)+"]"),n.container.remove(),_.each(a.getMenuItemControls(),function(e){i.menu_item_parent===e.setting().menu_item_parent&&e.setting().position>i.position?s.push(e):e.setting().menu_item_parent===o&&r.push(e)}),_.each(s,function(e){var t=_.clone(e.setting());t.position+=r.length,e.setting.set(t)}),_.each(r,function(e,t){var n=_.clone(e.setting());n.position=i.position+t,n.menu_item_parent=i.menu_item_parent,e.setting.set(n)}),a.debouncedReflowMenuItems()):(_.each(t,function(e,i){n.elements[i]&&n.elements[i].set(t[i])}),n.container.find(".menu-item-data-parent-id").val(t.menu_item_parent),t.position===i.position&&t.menu_item_parent===i.menu_item_parent||n.getMenuControl().debouncedReflowMenuItems())}),t=function(){n.elements.url.element.toggleClass("invalid",n.setting.notifications.has("invalid_url"))},n.setting.notifications.bind("add",t),n.setting.notifications.bind("removed",t)},_setupRemoveUI:function(){var i,a=this;i=a.container.find(".item-delete"),i.on("click",function(){var i,o,s,r=!0;n("body").hasClass("adding-menu-items")||(r=!1),o=a.container.nextAll(".customize-control-nav_menu_item:visible").first(),s=a.container.prevAll(".customize-control-nav_menu_item:visible").first(),i=o.length?o.find(!1===r?".item-edit":".item-delete").first():s.length?s.find(!1===r?".item-edit":".item-delete").first():a.container.nextAll(".customize-control-nav_menu").find(".add-new-menu-item").first(),a.container.slideUp(function(){a.setting.set(!1),t.a11y.speak(e.Menus.data.l10n.itemDeleted),i.focus()}),a.setting.set(!1)})},_setupLinksUI:function(){var t;t=this.container.find("a.original-link"),t.on("click",function(t){t.preventDefault(),e.previewer.previewUrl(t.target.toString())})},_setupTitleUI:function(){var t,i=this;i.container.find(".edit-menu-item-title").on("blur",function(){n(this).val(n.trim(n(this).val()))}),t=i.container.find(".menu-item-title"),i.setting.bind(function(i){var a,o;i&&(a=n.trim(i.title),o=a||i.original_title||e.Menus.data.l10n.untitled,i._invalid&&(o=e.Menus.data.l10n.invalidTitleTpl.replace("%s",o)),a||i.original_title?t.text(o).removeClass("no-title"):t.text(o).addClass("no-title"))})},getDepth:function(){var t=this,n=t.setting(),i=0;if(!n)return 0;for(;n&&n.menu_item_parent&&(i+=1,t=e.control("nav_menu_item["+n.menu_item_parent+"]"));)n=t.setting();return i},renderContent:function(){var t,n=this,i=n.setting();n.params.title=i.title||"",n.params.depth=n.getDepth(),n.container.data("item-depth",n.params.depth),t=["menu-item","menu-item-depth-"+String(n.params.depth),"menu-item-"+i.object,"menu-item-edit-inactive"],i._invalid?(t.push("menu-item-invalid"),n.params.title=e.Menus.data.l10n.invalidTitleTpl.replace("%s",n.params.title)):"draft"===i.status&&(t.push("pending"),n.params.title=e.Menus.data.pendingTitleTpl.replace("%s",n.params.title)),n.params.el_classes=t.join(" "),n.params.item_type_label=i.type_label,n.params.item_type=i.type,n.params.url=i.url,n.params.target=i.target,n.params.attr_title=i.attr_title,n.params.classes=_.isArray(i.classes)?i.classes.join(" "):i.classes,n.params.attr_title=i.attr_title,n.params.xfn=i.xfn,n.params.description=i.description,n.params.parent=i.menu_item_parent,n.params.original_title=i.original_title||"",n.container.addClass(n.params.el_classes),e.Control.prototype.renderContent.call(n)},getMenuControl:function(){var t=this,n=t.setting();return n&&n.nav_menu_term_id?e.control("nav_menu["+n.nav_menu_term_id+"]"):null},expandControlSection:function(){var e=this.container.closest(".accordion-section");e.hasClass("open")||e.find(".accordion-section-title:first").trigger("click")},_toggleExpanded:e.Section.prototype._toggleExpanded,expand:e.Section.prototype.expand,expandForm:function(e){this.expand(e)},collapse:e.Section.prototype.collapse,collapseForm:function(e){this.collapse(e)},toggleForm:function(e,t){void 0===e&&(e=!this.expanded()),e?this.expand(t):this.collapse(t)},onChangeExpanded:function(t,n){var i,a,o,s=this;return i=this.container,a=i.find(".menu-item-settings:first"),void 0===t&&(t=!a.is(":visible")),a.is(":visible")===t?void(n&&n.completeCallback&&n.completeCallback()):void(t?(e.control.each(function(e){s.params.type===e.params.type&&s!==e&&e.collapseForm()}),o=function(){i.removeClass("menu-item-edit-inactive").addClass("menu-item-edit-active"),s.container.trigger("expanded"),n&&n.completeCallback&&n.completeCallback()},i.find(".item-edit").attr("aria-expanded","true"),a.slideDown("fast",o),s.container.trigger("expand")):(o=function(){i.addClass("menu-item-edit-inactive").removeClass("menu-item-edit-active"),s.container.trigger("collapsed"),n&&n.completeCallback&&n.completeCallback()},s.container.trigger("collapse"),i.find(".item-edit").attr("aria-expanded","false"),a.slideUp("fast",o)))},focus:function(t){t=t||{};var n,i=this,a=t.completeCallback;n=function(){i.expandControlSection(),t.completeCallback=function(){var e;e=i.container.find(".menu-item-settings").find("input, select, textarea, button, object, a[href], [tabindex]").filter(":visible"),e.first().focus(),a&&a()},i.expandForm(t)},e.section.has(i.section())?e.section(i.section()).expand({completeCallback:n}):n()},moveUp:function(){this._changePosition(-1),t.a11y.speak(e.Menus.data.l10n.movedUp)},moveDown:function(){this._changePosition(1),t.a11y.speak(e.Menus.data.l10n.movedDown)},moveLeft:function(){this._changeDepth(-1),t.a11y.speak(e.Menus.data.l10n.movedLeft)},moveRight:function(){this._changeDepth(1),t.a11y.speak(e.Menus.data.l10n.movedRight)},_changePosition:function(e){var t,i,a=this,o=_.clone(a.setting()),s=[];if(1!==e&&-1!==e)throw new Error("Offset changes by 1 are only supported.");if(a.setting()){if(_(a.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===o.menu_item_parent&&s.push(e.setting)}),s.sort(function(e,t){return e().position-t().position}),-1===(i=_.indexOf(s,a.setting)))throw new Error("Expected setting to be among siblings.");0===i&&e<0||i===s.length-1&&e>0||(t=s[i+e],t&&t.set(n.extend(_.clone(t()),{position:o.position})),o.position+=e,a.setting.set(o))}},_changeDepth:function(t){if(1!==t&&-1!==t)throw new Error("Offset changes by 1 are only supported.");var i,a,o,s=this,r=_.clone(s.setting()),u=[];if(_(s.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===r.menu_item_parent&&u.push(e)}),u.sort(function(e,t){return e.setting().position-t.setting().position}),-1===(i=_.indexOf(u,s)))throw new Error("Expected control to be among siblings.");if(-1===t){if(!r.menu_item_parent)return;o=e.control("nav_menu_item["+r.menu_item_parent+"]"),_(u).chain().slice(i).each(function(e,t){e.setting.set(n.extend({},e.setting(),{menu_item_parent:s.params.menu_item_id,position:t}))}),_(s.getMenuControl().getMenuItemControls()).each(function(e){var t,i;(i=e.setting().menu_item_parent===o.setting().menu_item_parent&&e.setting().position>o.setting().position)&&(t=_.clone(e.setting()),e.setting.set(n.extend(t,{position:t.position+1})))}),r.position=o.setting().position+1,r.menu_item_parent=o.setting().menu_item_parent,s.setting.set(r)}else if(1===t){if(0===i)return;a=u[i-1],r.menu_item_parent=a.params.menu_item_id,r.position=0,_(s.getMenuControl().getMenuItemControls()).each(function(e){e.setting().menu_item_parent===r.menu_item_parent&&(r.position=Math.max(r.position,e.setting().position))}),r.position+=1,s.setting.set(r)}}}),e.Menus.MenuNameControl=e.Control.extend({ready:function(){var t=this;if(t.setting){var n=t.setting();t.nameElement=new e.Element(t.container.find(".menu-name-field")),t.nameElement.bind(function(e){var n=t.setting();n&&n.name!==e&&(n=_.clone(n),n.name=e,t.setting.set(n))}),n&&t.nameElement.set(n.name),t.setting.bind(function(e){e&&t.nameElement.set(e.name)})}}}),e.Menus.MenuLocationsControl=e.Control.extend({ready:function(){var t=this;t.container.find(".assigned-menu-location").each(function(){var i=n(this),o=i.find("input[type=checkbox]"),s=new e.Element(o),r=e("nav_menu_locations["+o.data("location-id")+"]"),u=""===t.params.menu_id,d=u?_.noop:function(e){s.set(e)},c=u?_.noop:function(e){r.set(e?t.params.menu_id:0)},l=function(t){var n=e("nav_menu["+String(t)+"]");t&&n&&n()?i.find(".theme-location-set").show().find("span").text(a(n().name)):i.find(".theme-location-set").hide()};d(r.get()===t.params.menu_id),o.on("change",function(){c(this.checked)}),r.bind(function(e){
d(e===t.params.menu_id),l(e)}),l(r.get())})},setSelections:function(e){this.container.find(".menu-location").each(function(t,n){var i=n.dataset.locationId;n.checked=i in e&&e[i]})}}),e.Menus.MenuAutoAddControl=e.Control.extend({ready:function(){var t=this,n=t.setting();t.active.validate=function(){var n,i=e.section(t.section());return n=!!i&&i.active()},t.autoAddElement=new e.Element(t.container.find("input[type=checkbox].auto_add")),t.autoAddElement.bind(function(e){var n=t.setting();n&&n.name!==e&&(n=_.clone(n),n.auto_add=e,t.setting.set(n))}),n&&t.autoAddElement.set(n.auto_add),t.setting.bind(function(e){e&&t.autoAddElement.set(e.auto_add)})}}),e.Menus.MenuControl=e.Control.extend({ready:function(){var t,i,o,s=this,r=e.section(s.section()),u=s.params.menu_id,d=s.setting();if(void 0===this.params.menu_id)throw new Error("params.menu_id was not defined");s.active.validate=function(){var e;return e=!!r&&r.active()},s.$controlSection=r.headContainer,s.$sectionContent=s.container.closest(".accordion-section-content"),this._setupModel(),e.section(s.section(),function(e){e.deferred.initSortables.done(function(e){s._setupSortable(e)})}),this._setupAddition(),this._setupTitle(),d&&(t=a(d.name),e.control.each(function(n){n.extended(e.controlConstructor.widget_form)&&"nav_menu"===n.params.widget_id_base&&(n.container.find(".nav-menu-widget-form-controls:first").show(),n.container.find(".nav-menu-widget-no-menus-message:first").hide(),o=n.container.find("select"),0===o.find("option[value="+String(u)+"]").length&&o.append(new Option(t,u)))}),i=n("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )"),i.find(".nav-menu-widget-form-controls:first").show(),i.find(".nav-menu-widget-no-menus-message:first").hide(),o=i.find(".widget-inside select:first"),0===o.find("option[value="+String(u)+"]").length&&o.append(new Option(t,u))),_.defer(function(){s.updateInvitationVisibility()})},_setupModel:function(){var t=this,n=t.params.menu_id;t.setting.bind(function(i){var o;!1===i?t._handleDeletion():(o=a(i.name),e.control.each(function(t){if(t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base){t.container.find("select").find("option[value="+String(n)+"]").text(o)}}))})},_setupSortable:function(t){var n=this;if(!t.is(n.$sectionContent))throw new Error("Unexpected menuList.");t.on("sortstart",function(){n.isSorting=!0}),t.on("sortstop",function(){setTimeout(function(){var t=n.$sectionContent.sortable("toArray"),i=[],a=0,o=10;n.isSorting=!1,n.$sectionContent.scrollLeft(0),_.each(t,function(t){var n,a,o;(o=t.match(/^customize-control-nav_menu_item-(-?\d+)$/,""))&&(n=parseInt(o[1],10),(a=e.control("nav_menu_item["+String(n)+"]"))&&i.push(a))}),_.each(i,function(e){if(!1!==e.setting()){var t=_.clone(e.setting());a+=1,o+=1,t.position=a,e.priority(o),t.menu_item_parent=parseInt(e.container.find(".menu-item-data-parent-id").val(),10),t.menu_item_parent||(t.menu_item_parent=0),e.setting.set(t)}})})}),n.isReordering=!1,this.container.find(".reorder-toggle").on("click",function(){n.toggleReordering(!n.isReordering)})},_setupAddition:function(){var t=this;this.container.find(".add-new-menu-item").on("click",function(i){t.$sectionContent.hasClass("reordering")||(n("body").hasClass("adding-menu-items")?(n(this).attr("aria-expanded","false"),e.Menus.availableMenuItemsPanel.close(),i.stopPropagation()):(n(this).attr("aria-expanded","true"),e.Menus.availableMenuItemsPanel.open(t)))})},_handleDeletion:function(){var i,a,o,s=this,r=s.params.menu_id,u=0;i=e.section(s.section()),a=function(){i.container.remove(),e.section.remove(i.id)},i&&i.expanded()?i.collapse({completeCallback:function(){a(),t.a11y.speak(e.Menus.data.l10n.menuDeleted),e.panel("nav_menus").focus()}}):a(),e.each(function(e){/^nav_menu\[/.test(e.id)&&!1!==e()&&(u+=1)}),e.control.each(function(t){if(t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base){var n=t.container.find("select");n.val()===String(r)&&n.prop("selectedIndex",0).trigger("change"),t.container.find(".nav-menu-widget-form-controls:first").toggle(0!==u),t.container.find(".nav-menu-widget-no-menus-message:first").toggle(0===u),t.container.find("option[value="+String(r)+"]").remove()}}),o=n("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )"),o.find(".nav-menu-widget-form-controls:first").toggle(0!==u),o.find(".nav-menu-widget-no-menus-message:first").toggle(0===u),o.find("option[value="+String(r)+"]").remove()},_setupTitle:function(){var t=this;t.setting.bind(function(i){if(i){var o=e.section(t.section()),s=t.params.menu_id,r=o.headContainer.find(".accordion-section-title"),u=o.contentContainer.find(".customize-section-title h3"),d=o.headContainer.find(".menu-in-location"),c=u.find(".customize-action"),l=a(i.name);r.text(l),d.length&&d.appendTo(r),u.text(l),c.length&&c.prependTo(u),e.control.each(function(e){/^nav_menu_locations\[/.test(e.id)&&e.container.find("option[value="+s+"]").text(l)}),o.contentContainer.find(".customize-control-checkbox input").each(function(){n(this).prop("checked")&&n(".current-menu-location-name-"+n(this).data("location-id")).text(l)})}})},toggleReordering:function(n){var i=this.container.find(".add-new-menu-item"),a=this.container.find(".reorder-toggle"),o=this.$sectionContent.find(".item-title");(n=Boolean(n))!==this.$sectionContent.hasClass("reordering")&&(this.isReordering=n,this.$sectionContent.toggleClass("reordering",n),this.$sectionContent.sortable(this.isReordering?"disable":"enable"),this.isReordering?(i.attr({tabindex:"-1","aria-hidden":"true"}),a.attr("aria-label",e.Menus.data.l10n.reorderLabelOff),t.a11y.speak(e.Menus.data.l10n.reorderModeOn),o.attr("aria-hidden","false")):(i.removeAttr("tabindex aria-hidden"),a.attr("aria-label",e.Menus.data.l10n.reorderLabelOn),t.a11y.speak(e.Menus.data.l10n.reorderModeOff),o.attr("aria-hidden","true")),n&&_(this.getMenuItemControls()).each(function(e){e.collapseForm()}))},getMenuItemControls:function(){var t=this,n=[],i=t.params.menu_id;return e.control.each(function(e){"nav_menu_item"===e.params.type&&e.setting()&&i===e.setting().nav_menu_term_id&&n.push(e)}),n},reflowMenuItems:function(){var e,t=this,n=t.getMenuItemControls();e=function(t){var n=[],i=t.currentParent;_.each(t.menuItemControls,function(e){i===e.setting().menu_item_parent&&n.push(e)}),n.sort(function(e,t){return e.setting().position-t.setting().position}),_.each(n,function(n){t.currentAbsolutePosition+=1,n.priority.set(t.currentAbsolutePosition),n.container.hasClass("menu-item-depth-"+String(t.currentDepth))||(_.each(n.container.prop("className").match(/menu-item-depth-\d+/g),function(e){n.container.removeClass(e)}),n.container.addClass("menu-item-depth-"+String(t.currentDepth))),n.container.data("item-depth",t.currentDepth),t.currentDepth+=1,t.currentParent=n.params.menu_item_id,e(t),t.currentDepth-=1,t.currentParent=i}),n.length&&(_(n).each(function(e){e.container.removeClass("move-up-disabled move-down-disabled move-left-disabled move-right-disabled"),0===t.currentDepth?e.container.addClass("move-left-disabled"):10===t.currentDepth&&e.container.addClass("move-right-disabled")}),n[0].container.addClass("move-up-disabled").addClass("move-right-disabled").toggleClass("move-down-disabled",1===n.length),n[n.length-1].container.addClass("move-down-disabled").toggleClass("move-up-disabled",1===n.length))},e({menuItemControls:n,currentParent:0,currentDepth:0,currentAbsolutePosition:0}),t.updateInvitationVisibility(n),t.container.find(".reorder-toggle").toggle(n.length>1)},debouncedReflowMenuItems:_.debounce(function(){this.reflowMenuItems.apply(this,arguments)},0),addItemToMenu:function(i){var a,o,s,r,u,d=this,c=0,l=10;return _.each(d.getMenuItemControls(),function(e){!1!==e.setting()&&(l=Math.max(l,e.priority()),0===e.setting().menu_item_parent&&(c=Math.max(c,e.setting().position)))}),c+=1,l+=1,i=n.extend({},e.Menus.data.defaultSettingValues.nav_menu_item,i,{nav_menu_term_id:d.params.menu_id,original_title:i.title,position:c}),delete i.id,u=e.Menus.generatePlaceholderAutoIncrementId(),a="nav_menu_item["+String(u)+"]",o={type:"nav_menu_item",transport:e.Menus.data.settingTransport,previewer:e.previewer},s=e.create(a,a,{},o),s.set(i),r=new e.controlConstructor.nav_menu_item(a,{type:"nav_menu_item",section:d.id,priority:l,settings:{default:a},menu_item_id:u}),e.control.add(r),s.preview(),d.debouncedReflowMenuItems(),t.a11y.speak(e.Menus.data.l10n.itemAdded),r},updateInvitationVisibility:function(e){var t=e||this.getMenuItemControls();this.container.find(".new-menu-item-invitation").toggle(0===t.length)}}),e.Menus.NewMenuControl=e.Control.extend({initialize:function(){"undefined"!=typeof console&&console.warn&&console.warn("[DEPRECATED] wp.customize.NewMenuControl will be removed. Please use wp.customize.Menus.createNavMenu() instead."),e.Control.prototype.initialize.apply(this,arguments)},ready:function(){this._bindHandlers()},_bindHandlers:function(){var e=this,t=n("#customize-control-new_menu_name input"),i=n("#create-new-menu-submit");t.on("keydown",function(t){13===t.which&&e.submit()}),i.on("click",function(t){e.submit(),t.stopPropagation(),t.preventDefault()})},submit:function(){var n,i=this,a=i.container.closest(".accordion-section-new-menu"),o=a.find(".menu-name-field").first(),s=o.val();return s?(n=e.Menus.createNavMenu(s),o.val(""),o.removeClass("invalid"),t.a11y.speak(e.Menus.data.l10n.menuAdded),void n.focus()):(o.addClass("invalid"),void o.focus())}}),n.extend(e.controlConstructor,{nav_menu_location:e.Menus.MenuLocationControl,nav_menu_item:e.Menus.MenuItemControl,nav_menu:e.Menus.MenuControl,nav_menu_name:e.Menus.MenuNameControl,new_menu:e.Menus.NewMenuControl,nav_menu_locations:e.Menus.MenuLocationsControl,nav_menu_auto_add:e.Menus.MenuAutoAddControl}),n.extend(e.panelConstructor,{nav_menus:e.Menus.MenusPanel}),n.extend(e.sectionConstructor,{nav_menu:e.Menus.MenuSection,new_menu:e.Menus.NewMenuSection}),e.bind("ready",function(){e.Menus.availableMenuItemsPanel=new e.Menus.AvailableMenuItemsPanelView({collection:e.Menus.availableMenuItems}),e.bind("saved",function(t){(t.nav_menu_updates||t.nav_menu_item_updates)&&e.Menus.applySavedData(t)}),e.state("changesetStatus").bind(function(t){"publish"===t&&(e("nav_menus_created_posts")._value=[])}),e.previewer.bind("focus-nav-menu-item-control",e.Menus.focusMenuItemControl)}),e.Menus.applySavedData=function(i){var a={},o={};_(i.nav_menu_updates).each(function(i){var o,s,r,u,d,c,l,m,p,f,v,h,g;if("inserted"===i.status){if(!i.previous_term_id)throw new Error("Expected previous_term_id");if(!i.term_id)throw new Error("Expected term_id");if(o="nav_menu["+String(i.previous_term_id)+"]",!e.has(o))throw new Error("Expected setting to exist: "+o);if(u=e(o),!e.section.has(o))throw new Error("Expected control to exist: "+o);if(m=e.section(o),!(l=u.get()))throw new Error("Did not expect setting to be empty (deleted).");l=n.extend(_.clone(l),i.saved_value),a[i.previous_term_id]=i.term_id,s="nav_menu["+String(i.term_id)+"]",d=e.create(s,s,l,{type:"nav_menu",transport:e.Menus.data.settingTransport,previewer:e.previewer}),g=m.expanded(),g&&m.collapse(),p=new e.Menus.MenuSection(s,{panel:"nav_menus",title:l.name,customizeAction:e.Menus.data.l10n.customizingMenus,type:"nav_menu",priority:m.priority.get(),menu_id:i.term_id}),e.section.add(p),e.control.each(function(t){if(t.extended(e.controlConstructor.widget_form)&&"nav_menu"===t.params.widget_id_base){var n,a,o;n=t.container.find("select"),a=n.find("option[value="+String(i.previous_term_id)+"]"),o=n.find("option[value="+String(i.term_id)+"]"),o.prop("selected",a.prop("selected")),a.remove()}}),u.callbacks.disable(),u.set(!1),u.preview(),d.preview(),u._dirty=!1,m.container.remove(),e.section.remove(o),h=0,e.each(function(e){/^nav_menu\[/.test(e.id)&&!1!==e()&&(h+=1)}),v=n("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )"),v.find(".nav-menu-widget-form-controls:first").toggle(0!==h),v.find(".nav-menu-widget-no-menus-message:first").toggle(0===h),v.find("option[value="+String(i.previous_term_id)+"]").remove(),t.customize.control.each(function(e){/^nav_menu_locations\[/.test(e.id)&&e.container.find("option[value="+String(i.previous_term_id)+"]").remove()}),e.each(function(t){var n=e.state("saved").get();/^nav_menu_locations\[/.test(t.id)&&t.get()===i.previous_term_id&&(t.set(i.term_id),t._dirty=!1,e.state("saved").set(n),t.preview())}),g&&p.expand()}else if("updated"===i.status){if(r="nav_menu["+String(i.term_id)+"]",!e.has(r))throw new Error("Expected setting to exist: "+r);c=e(r),_.isEqual(i.saved_value,c.get())||(f=e.state("saved").get(),c.set(i.saved_value),c._dirty=!1,e.state("saved").set(f))}}),_(i.nav_menu_item_updates).each(function(e){e.previous_post_id&&(o[e.previous_post_id]=e.post_id)}),_(i.nav_menu_item_updates).each(function(t){var n,i,s,r,u,d,c;if("inserted"===t.status){if(!t.previous_post_id)throw new Error("Expected previous_post_id");if(!t.post_id)throw new Error("Expected post_id");if(n="nav_menu_item["+String(t.previous_post_id)+"]",!e.has(n))throw new Error("Expected setting to exist: "+n);if(s=e(n),!e.control.has(n))throw new Error("Expected control to exist: "+n);if(d=e.control(n),!(u=s.get()))throw new Error("Did not expect setting to be empty (deleted).");if(u=_.clone(u),u.menu_item_parent<0){if(!o[u.menu_item_parent])throw new Error("inserted ID for menu_item_parent not available");u.menu_item_parent=o[u.menu_item_parent]}a[u.nav_menu_term_id]&&(u.nav_menu_term_id=a[u.nav_menu_term_id]),i="nav_menu_item["+String(t.post_id)+"]",r=e.create(i,i,u,{type:"nav_menu_item",transport:e.Menus.data.settingTransport,previewer:e.previewer}),c=new e.controlConstructor.nav_menu_item(i,{type:"nav_menu_item",menu_id:t.post_id,section:"nav_menu["+String(u.nav_menu_term_id)+"]",priority:d.priority.get(),settings:{default:i},menu_item_id:t.post_id}),d.container.remove(),e.control.remove(n),e.control.add(c),s.callbacks.disable(),s.set(!1),s.preview(),r.preview(),s._dirty=!1,c.container.toggleClass("menu-item-edit-inactive",d.container.hasClass("menu-item-edit-inactive"))}}),_.each(i.widget_nav_menu_updates,function(t,n){var i=e(n);i&&(i._value=t,i.preview())})},e.Menus.focusMenuItemControl=function(t){var n=e.Menus.getMenuItemControl(t);n&&n.focus()},e.Menus.getMenuControl=function(t){return e.control("nav_menu["+t+"]")},e.Menus.getMenuItemControl=function(t){return e.control(i(t))}}(wp.customize,wp,jQuery);
//# sourceMappingURL=./customize-nav-menus.min-min.js.map