!function($){function e(){return $("<div/>")}var t=Math.abs,o=Math.max,i=Math.min,s=Math.round;$.imgAreaSelect=function(n,r){function c(e){return e+Q.left-U.left}function d(e){return e+Q.top-U.top}function a(e){return e-Q.left+U.left}function u(e){return e-Q.top+U.top}function l(e){return o(e.pageX||0,f(e).x)-U.left}function h(e){return o(e.pageY||0,f(e).y)-U.top}function f(e){var t=e.originalEvent||{};return t.touches&&t.touches.length?{x:t.touches[0].pageX,y:t.touches[0].pageY}:{x:0,y:0}}function m(e){var t=e||te,o=e||oe;return{x1:s(me.x1*t),y1:s(me.y1*o),x2:s(me.x2*t),y2:s(me.y2*o),width:s(me.x2*t)-s(me.x1*t),height:s(me.y2*o)-s(me.y1*o)}}function p(e,t,o,i,n){var r=n||te,c=n||oe;me={x1:s(e/r||0),y1:s(t/c||0),x2:s(o/r||0),y2:s(i/c||0)},me.width=me.x2-me.x1,me.height=me.y2-me.y1}function y(){T&&O.width()&&(Q={left:s(O.offset().left),top:s(O.offset().top)},F=O.innerWidth(),G=O.innerHeight(),Q.top+=O.outerHeight()-G>>1,Q.left+=O.outerWidth()-F>>1,se=s(r.minWidth/te)||0,ne=s(r.minHeight/oe)||0,re=s(i(r.maxWidth/te||1<<24,F)),ce=s(i(r.maxHeight/oe||1<<24,G)),"1.3.2"!=$().jquery||"fixed"!=Z||pe.getBoundingClientRect||(Q.top+=o(document.body.scrollTop,pe.scrollTop),Q.left+=o(document.body.scrollLeft,pe.scrollLeft)),U=/absolute|relative/.test(J.css("position"))?{left:s(J.offset().left)-J.scrollLeft(),top:s(J.offset().top)-J.scrollTop()}:"fixed"==Z?{left:$(document).scrollLeft(),top:$(document).scrollTop()}:{left:0,top:0},q=c(0),B=d(0),(me.x2>F||me.y2>G)&&k())}function g(e){if(ae){switch(L.css({left:c(me.x1),top:d(me.y1)}).add(j).width(we=me.width).height(Se=me.height),j.add(D).add(X).css({left:0,top:0}),D.width(o(we-D.outerWidth()+D.innerWidth(),0)).height(o(Se-D.outerHeight()+D.innerHeight(),0)),$(R[0]).css({left:q,top:B,width:me.x1,height:G}),$(R[1]).css({left:q+me.x1,top:B,width:we,height:me.y1}),$(R[2]).css({left:q+me.x2,top:B,width:F-me.x2,height:G}),$(R[3]).css({left:q+me.x1,top:B+me.y2,width:we,height:G-me.y2}),we-=X.outerWidth(),Se-=X.outerHeight(),X.length){case 8:$(X[4]).css({left:we>>1}),$(X[5]).css({left:we,top:Se>>1}),$(X[6]).css({left:we>>1,top:Se}),$(X[7]).css({top:Se>>1});case 4:X.slice(1,3).css({left:we}),X.slice(2,4).css({top:Se})}!1!==e&&($.imgAreaSelect.onKeyPress!=ke&&$(document).unbind($.imgAreaSelect.keyPress,$.imgAreaSelect.onKeyPress),r.keys&&$(document)[$.imgAreaSelect.keyPress]($.imgAreaSelect.onKeyPress=ke)),Ce&&D.outerWidth()-D.innerWidth()==2&&(D.css("margin",0),setTimeout(function(){D.css("margin","auto")},0))}}function v(e){y(),g(e),ue=c(me.x1),le=d(me.y1),he=c(me.x2),fe=d(me.y2)}function b(e,t){r.fadeSpeed?e.fadeOut(r.fadeSpeed,t):e.hide()}function x(e){var t=a(l(e))-me.x1,o=u(h(e))-me.y1;ze||(y(),ze=!0,L.one("mouseout",function(){ze=!1})),ie="",r.resizable&&(o<=r.resizeMargin?ie="n":o>=me.height-r.resizeMargin&&(ie="s"),t<=r.resizeMargin?ie+="w":t>=me.width-r.resizeMargin&&(ie+="e")),L.css("cursor",ie?ie+"-resize":r.movable?"move":""),Y&&Y.toggle()}function w(e){$("body").css("cursor",""),(r.autoHide||me.width*me.height==0)&&b(L.add(R),function(){$(this).hide()}),$(document).off("mousemove touchmove",C),L.on("mousemove touchmove",x),r.onSelectEnd(n,m())}function S(e){return("mousedown"!=e.type||1==e.which)&&(x(e),y(),ie?($("body").css("cursor",ie+"-resize"),ue=c(me[/w/.test(ie)?"x2":"x1"]),le=d(me[/n/.test(ie)?"y2":"y1"]),$(document).on("mousemove touchmove",C).one("mouseup touchend",w),L.off("mousemove touchmove",x)):r.movable?(_=q+me.x1-l(e),ee=B+me.y1-h(e),L.off("mousemove touchmove",x),$(document).on("mousemove touchmove",W).one("mouseup touchend",function(){r.onSelectEnd(n,m()),$(document).off("mousemove touchmove",W),L.on("mousemove touchmove",x)})):O.mousedown(e),!1)}function z(e){de&&(e?(he=o(q,i(q+F,ue+t(fe-le)*de*(he>ue||-1))),fe=s(o(B,i(B+G,le+t(he-ue)/de*(fe>le||-1)))),he=s(he)):(fe=o(B,i(B+G,le+t(he-ue)/de*(fe>le||-1))),he=s(o(q,i(q+F,ue+t(fe-le)*de*(he>ue||-1)))),fe=s(fe)))}function k(){ue=i(ue,q+F),le=i(le,B+G),t(he-ue)<se&&(he=ue-se*(he<ue||-1),he<q?ue=q+se:he>q+F&&(ue=q+F-se)),t(fe-le)<ne&&(fe=le-ne*(fe<le||-1),fe<B?le=B+ne:fe>B+G&&(le=B+G-ne)),he=o(q,i(he,q+F)),fe=o(B,i(fe,B+G)),z(t(he-ue)<t(fe-le)*de),t(he-ue)>re&&(he=ue-re*(he<ue||-1),z()),t(fe-le)>ce&&(fe=le-ce*(fe<le||-1),z(!0)),me={x1:a(i(ue,he)),x2:a(o(ue,he)),y1:u(i(le,fe)),y2:u(o(le,fe)),width:t(he-ue),height:t(fe-le)},g(),r.onSelectChange(n,m())}function C(e){return he=/w|e|^$/.test(ie)||de?l(e):c(me.x2),fe=/n|s|^$/.test(ie)||de?h(e):d(me.y2),k(),!1}function A(e,t){he=(ue=e)+me.width,fe=(le=t)+me.height,$.extend(me,{x1:a(ue),y1:u(le),x2:a(he),y2:u(fe)}),g(),r.onSelectChange(n,m())}function W(e){return ue=o(q,i(_+l(e),q+F-me.width)),le=o(B,i(ee+h(e),B+G-me.height)),A(ue,le),e.preventDefault(),!1}function I(){$(document).off("mousemove touchmove",I),y(),he=ue,fe=le,k(),ie="",R.is(":visible")||L.add(R).hide().fadeIn(r.fadeSpeed||0),ae=!0,$(document).off("mouseup touchend",K).on("mousemove touchmove",C).one("mouseup touchend",w),L.off("mousemove touchmove",x),r.onSelectStart(n,m())}function K(){$(document).off("mousemove touchmove",I).off("mouseup touchend",K),b(L.add(R)),p(a(ue),u(le),a(ue),u(le)),this instanceof $.imgAreaSelect||(r.onSelectChange(n,m()),r.onSelectEnd(n,m()))}function P(e){return!(e.which>1||R.is(":animated"))&&(y(),_=ue=l(e),ee=le=h(e),$(document).on({"mousemove touchmove":I,"mouseup touchend":K}),!1)}function N(){v(!1)}function H(){T=!0,E(r=$.extend({classPrefix:"imgareaselect",movable:!0,parent:"body",resizable:!0,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},r)),L.add(R).css({visibility:""}),r.show&&(ae=!0,y(),g(),L.add(R).hide().fadeIn(r.fadeSpeed||0)),setTimeout(function(){r.onInit(n,m())},0)}function M(e,t){for(var o in t)void 0!==r[o]&&e.css(t[o],r[o])}function E(t){if(t.parent&&(J=$(t.parent)).append(L.add(R)),$.extend(r,t),y(),null!=t.handles){for(X.remove(),X=$([]),be=t.handles?"corners"==t.handles?4:8:0;be--;)X=X.add(e());X.addClass(r.classPrefix+"-handle").css({position:"absolute",fontSize:0,zIndex:V+1||1}),!parseInt(X.css("width"))>=0&&X.width(5).height(5),(xe=r.borderWidth)&&X.css({borderWidth:xe,borderStyle:"solid"}),M(X,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}for(te=r.imageWidth/F||1,oe=r.imageHeight/G||1,null!=t.x1&&(p(t.x1,t.y1,t.x2,t.y2),t.show=!t.hide),t.keys&&(r.keys=$.extend({shift:1,ctrl:"resize"},t.keys)),R.addClass(r.classPrefix+"-outer"),j.addClass(r.classPrefix+"-selection"),be=0;be++<4;)$(D[be-1]).addClass(r.classPrefix+"-border"+be);M(j,{selectionColor:"background-color",selectionOpacity:"opacity"}),M(D,{borderOpacity:"opacity",borderWidth:"border-width"}),M(R,{outerColor:"background-color",outerOpacity:"opacity"}),(xe=r.borderColor1)&&$(D[0]).css({borderStyle:"solid",borderColor:xe}),(xe=r.borderColor2)&&$(D[1]).css({borderStyle:"dashed",borderColor:xe}),L.append(j.add(D).add(Y)).append(X),Ce&&((xe=(R.css("filter")||"").match(/opacity=(\d+)/))&&R.css("opacity",xe[1]/100),(xe=(D.css("filter")||"").match(/opacity=(\d+)/))&&D.css("opacity",xe[1]/100)),t.hide?b(L.add(R)):t.show&&T&&(ae=!0,L.add(R).fadeIn(r.fadeSpeed||0),v()),de=(ve=(r.aspectRatio||"").split(/:/))[0]/ve[1],O.add(R).unbind("mousedown",P),r.disable||!1===r.enable?(L.off({"mousemove touchmove":x,"mousedown touchstart":S}),$(window).off("resize",N)):((r.enable||!1===r.disable)&&((r.resizable||r.movable)&&L.on({"mousemove touchmove":x,"mousedown touchstart":S}),$(window).resize(N)),r.persistent||O.add(R).on("mousedown touchstart",P)),r.enable=r.disable=void 0}var O=$(n),T,L=e(),j=e(),D=e().add(e()).add(e()).add(e()),R=e().add(e()).add(e()).add(e()),X=$([]),Y,q,B,Q={left:0,top:0},F,G,J,U={left:0,top:0},V=0,Z="absolute",_,ee,te,oe,ie,se,ne,re,ce,de,ae,ue,le,he,fe,me={x1:0,y1:0,x2:0,y2:0,width:0,height:0},pe=document.documentElement,ye=navigator.userAgent,ge,ve,be,xe,we,Se,ze,ke=function(e){var t=r.keys,s,n,c=e.keyCode;if(s=isNaN(t.alt)||!e.altKey&&!e.originalEvent.altKey?!isNaN(t.ctrl)&&e.ctrlKey?t.ctrl:!isNaN(t.shift)&&e.shiftKey?t.shift:isNaN(t.arrows)?10:t.arrows:t.alt,"resize"==t.arrows||"resize"==t.shift&&e.shiftKey||"resize"==t.ctrl&&e.ctrlKey||"resize"==t.alt&&(e.altKey||e.originalEvent.altKey)){switch(c){case 37:s=-s;case 39:n=o(ue,he),ue=i(ue,he),he=o(n+s,ue),z();break;case 38:s=-s;case 40:n=o(le,fe),le=i(le,fe),fe=o(n+s,le),z(!0);break;default:return}k()}else switch(ue=i(ue,he),le=i(le,fe),c){case 37:A(o(ue-s,q),le);break;case 38:A(ue,o(le-s,B));break;case 39:A(ue+i(s,F-a(he)),le);break;case 40:A(ue,le+i(s,G-u(fe)));break;default:return}return!1};this.remove=function(){E({disable:!0}),L.add(R).remove()},this.getOptions=function(){return r},this.setOptions=E,this.getSelection=m,this.setSelection=p,this.cancelSelection=K,this.update=v;var Ce=(/msie ([\w.]+)/i.exec(ye)||[])[1],Ae=/opera/i.test(ye),We=/webkit/i.test(ye)&&!/chrome/i.test(ye);for(ge=O;ge.length;)V=o(V,isNaN(ge.css("z-index"))?V:ge.css("z-index")),"fixed"==ge.css("position")&&(Z="fixed"),ge=ge.parent(":not(body)");V=r.zIndex||V,Ce&&O.attr("unselectable","on"),$.imgAreaSelect.keyPress=Ce||We?"keydown":"keypress",Ae&&(Y=e().css({width:"100%",height:"100%",position:"absolute",zIndex:V+2||2})),L.add(R).css({visibility:"hidden",position:Z,overflow:"hidden",zIndex:V||"0"}),L.css({zIndex:V+2||2}),j.add(D).css({position:"absolute",fontSize:0}),n.complete||"complete"==n.readyState||!O.is("img")?H():O.one("load",H),!T&&Ce&&Ce>=7&&(n.src=n.src)},$.fn.imgAreaSelect=function(e){return e=e||{},this.each(function(){$(this).data("imgAreaSelect")?e.remove?($(this).data("imgAreaSelect").remove(),$(this).removeData("imgAreaSelect")):$(this).data("imgAreaSelect").setOptions(e):e.remove||(void 0===e.enable&&void 0===e.disable&&(e.enable=!0),$(this).data("imgAreaSelect",new $.imgAreaSelect(this,e)))}),e.instance?$(this).data("imgAreaSelect"):this}}(jQuery);
//# sourceMappingURL=./jquery.imgareaselect-min.js.map